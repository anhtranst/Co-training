2026-02-23 16:18:12,656 - lg_cotrain - INFO - === Optuna study: canada_wildfires_2016 budget=10 seed=3 | target=10 trials, 0 replayed, 10 new ===
2026-02-23 16:18:12,656 - lg_cotrain - INFO - --- Trial 1/10 ---
2026-02-23 16:18:13,237 - lg_cotrain - INFO - Starting LG-CoTrain: event=canada_wildfires_2016, budget=10, seed_set=3
2026-02-23 16:18:13,267 - lg_cotrain - INFO - Detected 8 classes for event canada_wildfires_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 16:18:13,273 - lg_cotrain - INFO - D_l1: 40, D_l2: 40, D_LG: 1489
2026-02-23 16:18:13,274 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 16:18:20,239 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1205, mean_prob2=0.1285
2026-02-23 16:18:26,088 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.0951, mean_prob2=0.1297
2026-02-23 16:18:32,182 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1230, mean_prob2=0.0975
2026-02-23 16:18:38,193 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1166, mean_prob2=0.1645
2026-02-23 16:18:44,124 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1223, mean_prob2=0.1246
2026-02-23 16:18:49,959 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1643, mean_prob2=0.1026
2026-02-23 16:18:55,782 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1209, mean_prob2=0.1509
2026-02-23 16:18:55,783 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 16:18:56,833 - lg_cotrain - INFO - LR scheduler: total_steps_1=4053, warmup=780; total_steps_2=4053, warmup=780
2026-02-23 16:18:56,833 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1209, range=[0.1075, 0.1698]
2026-02-23 16:18:56,833 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1509, range=[0.0344, 0.2115]
2026-02-23 16:19:21,244 - lg_cotrain - INFO - Phase 2 epoch 1/19: loss1=0.1720, loss2=0.1445, dev_macro_f1=0.4563, dev_err=30.26%
2026-02-23 16:19:45,581 - lg_cotrain - INFO - Phase 2 epoch 2/19: loss1=0.1850, loss2=0.7360, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:20:09,911 - lg_cotrain - INFO - Phase 2 epoch 3/19: loss1=0.0682, loss2=0.7002, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:20:34,174 - lg_cotrain - INFO - Phase 2 epoch 4/19: loss1=0.0343, loss2=0.6428, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:20:58,691 - lg_cotrain - INFO - Phase 2 epoch 5/19: loss1=0.0199, loss2=0.6006, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:21:23,074 - lg_cotrain - INFO - Phase 2 epoch 6/19: loss1=0.0153, loss2=0.5543, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:21:47,496 - lg_cotrain - INFO - Phase 2 epoch 7/19: loss1=0.0117, loss2=0.5230, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:22:11,983 - lg_cotrain - INFO - Phase 2 epoch 8/19: loss1=0.0086, loss2=0.4936, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:22:36,373 - lg_cotrain - INFO - Phase 2 epoch 9/19: loss1=0.0066, loss2=0.4683, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:23:00,764 - lg_cotrain - INFO - Phase 2 epoch 10/19: loss1=0.0060, loss2=0.4476, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:23:25,231 - lg_cotrain - INFO - Phase 2 epoch 11/19: loss1=0.0058, loss2=0.4303, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:23:49,638 - lg_cotrain - INFO - Phase 2 epoch 12/19: loss1=0.0057, loss2=0.4124, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:24:14,270 - lg_cotrain - INFO - Phase 2 epoch 13/19: loss1=0.0057, loss2=0.3973, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:24:38,995 - lg_cotrain - INFO - Phase 2 epoch 14/19: loss1=0.0050, loss2=0.3836, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:25:03,695 - lg_cotrain - INFO - Phase 2 epoch 15/19: loss1=0.0046, loss2=0.3699, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:25:28,243 - lg_cotrain - INFO - Phase 2 epoch 16/19: loss1=0.0041, loss2=0.3594, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:25:52,829 - lg_cotrain - INFO - Phase 2 epoch 17/19: loss1=0.0037, loss2=0.3493, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:26:17,335 - lg_cotrain - INFO - Phase 2 epoch 18/19: loss1=0.0036, loss2=0.3409, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:26:41,820 - lg_cotrain - INFO - Phase 2 epoch 19/19: loss1=0.0034, loss2=0.3323, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:26:41,820 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 16:26:43,110 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.0735, dev_err=58.33%, es_counter1=0, es_counter2=0
2026-02-23 16:26:44,380 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.0735, dev_err=58.33%, es_counter1=1, es_counter2=1
2026-02-23 16:26:45,653 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.0022, dev_err=99.12%, es_counter1=2, es_counter2=2
2026-02-23 16:26:46,925 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.0115, dev_err=95.18%, es_counter1=3, es_counter2=3
2026-02-23 16:26:48,201 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.0164, dev_err=92.98%, es_counter1=4, es_counter2=4
2026-02-23 16:26:49,483 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.0022, dev_err=99.12%, es_counter1=5, es_counter2=5
2026-02-23 16:26:50,759 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.0735, dev_err=58.33%, es_counter1=6, es_counter2=6
2026-02-23 16:26:50,759 - lg_cotrain - INFO - Early stopping at epoch 7
2026-02-23 16:26:50,774 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 16:26:53,078 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpy_pez8r7\canada_wildfires_2016\10_set3\metrics.json
2026-02-23 16:26:53,078 - lg_cotrain - INFO - Test error rate: 58.20%, Test macro-F1: 0.0737, Test ECE: 0.0034
2026-02-23 16:26:53,090 - lg_cotrain - INFO - --- Trial 1/10 done: dev_macro_f1=0.0735 ---
2026-02-23 16:26:53,090 - lg_cotrain - INFO - --- Trial 2/10 ---
2026-02-23 16:26:53,676 - lg_cotrain - INFO - Starting LG-CoTrain: event=canada_wildfires_2016, budget=10, seed_set=3
2026-02-23 16:26:53,686 - lg_cotrain - INFO - Detected 8 classes for event canada_wildfires_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 16:26:53,692 - lg_cotrain - INFO - D_l1: 40, D_l2: 40, D_LG: 1489
2026-02-23 16:26:53,692 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 16:27:00,625 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1290, mean_prob2=0.1344
2026-02-23 16:27:06,560 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1324, mean_prob2=0.1456
2026-02-23 16:27:12,467 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1293, mean_prob2=0.1494
2026-02-23 16:27:18,360 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1300, mean_prob2=0.1918
2026-02-23 16:27:24,318 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1319, mean_prob2=0.1661
2026-02-23 16:27:30,644 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1507, mean_prob2=0.2413
2026-02-23 16:27:37,115 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1646, mean_prob2=0.2927
2026-02-23 16:27:37,115 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 16:27:38,158 - lg_cotrain - INFO - LR scheduler: total_steps_1=3866, warmup=376; total_steps_2=3866, warmup=376
2026-02-23 16:27:38,159 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1646, range=[0.0381, 0.4730]
2026-02-23 16:27:38,159 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.2927, range=[0.0242, 0.7243]
2026-02-23 16:28:02,967 - lg_cotrain - INFO - Phase 2 epoch 1/18: loss1=0.3639, loss2=0.2245, dev_macro_f1=0.4180, dev_err=28.51%
2026-02-23 16:28:27,459 - lg_cotrain - INFO - Phase 2 epoch 2/18: loss1=0.0897, loss2=0.2105, dev_macro_f1=0.4954, dev_err=23.68%
2026-02-23 16:28:51,934 - lg_cotrain - INFO - Phase 2 epoch 3/18: loss1=0.0619, loss2=0.2674, dev_macro_f1=0.4821, dev_err=24.56%
2026-02-23 16:29:16,359 - lg_cotrain - INFO - Phase 2 epoch 4/18: loss1=0.0387, loss2=0.1875, dev_macro_f1=0.5511, dev_err=25.88%
2026-02-23 16:29:40,824 - lg_cotrain - INFO - Phase 2 epoch 5/18: loss1=0.0512, loss2=0.1795, dev_macro_f1=0.5438, dev_err=23.25%
2026-02-23 16:30:05,231 - lg_cotrain - INFO - Phase 2 epoch 6/18: loss1=0.0279, loss2=0.1094, dev_macro_f1=0.5350, dev_err=24.12%
2026-02-23 16:30:29,645 - lg_cotrain - INFO - Phase 2 epoch 7/18: loss1=0.0120, loss2=0.0691, dev_macro_f1=0.5605, dev_err=21.93%
2026-02-23 16:30:54,073 - lg_cotrain - INFO - Phase 2 epoch 8/18: loss1=0.0098, loss2=0.0654, dev_macro_f1=0.5893, dev_err=20.61%
2026-02-23 16:31:18,488 - lg_cotrain - INFO - Phase 2 epoch 9/18: loss1=0.0246, loss2=0.0743, dev_macro_f1=0.6066, dev_err=19.30%
2026-02-23 16:31:42,855 - lg_cotrain - INFO - Phase 2 epoch 10/18: loss1=0.0059, loss2=0.0266, dev_macro_f1=0.5852, dev_err=21.49%
2026-02-23 16:32:07,241 - lg_cotrain - INFO - Phase 2 epoch 11/18: loss1=0.0192, loss2=0.0097, dev_macro_f1=0.5617, dev_err=22.37%
2026-02-23 16:32:31,612 - lg_cotrain - INFO - Phase 2 epoch 12/18: loss1=0.0065, loss2=0.0058, dev_macro_f1=0.5521, dev_err=22.81%
2026-02-23 16:32:56,006 - lg_cotrain - INFO - Phase 2 epoch 13/18: loss1=0.0134, loss2=0.0041, dev_macro_f1=0.5653, dev_err=21.93%
2026-02-23 16:33:20,394 - lg_cotrain - INFO - Phase 2 epoch 14/18: loss1=0.0172, loss2=0.0042, dev_macro_f1=0.5851, dev_err=20.18%
2026-02-23 16:33:44,735 - lg_cotrain - INFO - Phase 2 epoch 15/18: loss1=0.0080, loss2=0.0134, dev_macro_f1=0.5668, dev_err=21.49%
2026-02-23 16:34:09,091 - lg_cotrain - INFO - Phase 2 epoch 16/18: loss1=0.0042, loss2=0.0142, dev_macro_f1=0.5623, dev_err=21.93%
2026-02-23 16:34:33,511 - lg_cotrain - INFO - Phase 2 epoch 17/18: loss1=0.0058, loss2=0.0037, dev_macro_f1=0.5641, dev_err=21.93%
2026-02-23 16:34:57,886 - lg_cotrain - INFO - Phase 2 epoch 18/18: loss1=0.0050, loss2=0.0027, dev_macro_f1=0.5695, dev_err=21.49%
2026-02-23 16:34:57,886 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 16:34:59,182 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.6632, dev_err=20.61%, es_counter1=0, es_counter2=0
2026-02-23 16:35:00,441 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.6103, dev_err=23.25%, es_counter1=1, es_counter2=1
2026-02-23 16:35:01,715 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.5768, dev_err=26.32%, es_counter1=2, es_counter2=2
2026-02-23 16:35:02,985 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.5698, dev_err=31.14%, es_counter1=3, es_counter2=3
2026-02-23 16:35:04,256 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.5644, dev_err=32.89%, es_counter1=4, es_counter2=4
2026-02-23 16:35:05,530 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.5701, dev_err=30.70%, es_counter1=5, es_counter2=5
2026-02-23 16:35:06,805 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.5692, dev_err=28.07%, es_counter1=6, es_counter2=6
2026-02-23 16:35:06,805 - lg_cotrain - INFO - Early stopping at epoch 7
2026-02-23 16:35:06,814 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 16:35:09,116 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmp7dyzgj69\canada_wildfires_2016\10_set3\metrics.json
2026-02-23 16:35:09,116 - lg_cotrain - INFO - Test error rate: 23.37%, Test macro-F1: 0.5819, Test ECE: 0.1750
2026-02-23 16:35:09,124 - lg_cotrain - INFO - --- Trial 2/10 done: dev_macro_f1=0.6632 ---
2026-02-23 16:35:09,124 - lg_cotrain - INFO - --- Trial 3/10 ---
2026-02-23 16:35:09,715 - lg_cotrain - INFO - Starting LG-CoTrain: event=canada_wildfires_2016, budget=10, seed_set=3
2026-02-23 16:35:09,725 - lg_cotrain - INFO - Detected 8 classes for event canada_wildfires_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 16:35:09,729 - lg_cotrain - INFO - D_l1: 40, D_l2: 40, D_LG: 1489
2026-02-23 16:35:09,730 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 16:35:15,397 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1247, mean_prob2=0.1219
2026-02-23 16:35:20,155 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1240, mean_prob2=0.1208
2026-02-23 16:35:24,904 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1237, mean_prob2=0.1209
2026-02-23 16:35:29,667 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1260, mean_prob2=0.1228
2026-02-23 16:35:34,413 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1301, mean_prob2=0.1254
2026-02-23 16:35:39,170 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1345, mean_prob2=0.1284
2026-02-23 16:35:43,921 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1373, mean_prob2=0.1316
2026-02-23 16:35:43,921 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 16:35:44,935 - lg_cotrain - INFO - LR scheduler: total_steps_1=364, warmup=20; total_steps_2=364, warmup=20
2026-02-23 16:35:44,935 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1373, range=[0.0500, 0.1989]
2026-02-23 16:35:44,936 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1316, range=[0.0720, 0.1901]
2026-02-23 16:36:02,105 - lg_cotrain - INFO - Phase 2 epoch 1/11: loss1=0.2590, loss2=0.2690, dev_macro_f1=0.1179, dev_err=54.39%
2026-02-23 16:36:19,330 - lg_cotrain - INFO - Phase 2 epoch 2/11: loss1=0.1609, loss2=0.2910, dev_macro_f1=0.1689, dev_err=44.30%
2026-02-23 16:36:36,550 - lg_cotrain - INFO - Phase 2 epoch 3/11: loss1=0.1072, loss2=0.2445, dev_macro_f1=0.2471, dev_err=37.72%
2026-02-23 16:36:53,798 - lg_cotrain - INFO - Phase 2 epoch 4/11: loss1=0.0888, loss2=0.2024, dev_macro_f1=0.2926, dev_err=34.65%
2026-02-23 16:37:11,067 - lg_cotrain - INFO - Phase 2 epoch 5/11: loss1=0.0700, loss2=0.1679, dev_macro_f1=0.3814, dev_err=31.14%
2026-02-23 16:37:28,443 - lg_cotrain - INFO - Phase 2 epoch 6/11: loss1=0.0568, loss2=0.1444, dev_macro_f1=0.4212, dev_err=28.95%
2026-02-23 16:37:45,697 - lg_cotrain - INFO - Phase 2 epoch 7/11: loss1=0.0494, loss2=0.1301, dev_macro_f1=0.4564, dev_err=26.75%
2026-02-23 16:38:02,969 - lg_cotrain - INFO - Phase 2 epoch 8/11: loss1=0.0452, loss2=0.1139, dev_macro_f1=0.4772, dev_err=25.00%
2026-02-23 16:38:20,213 - lg_cotrain - INFO - Phase 2 epoch 9/11: loss1=0.0409, loss2=0.0989, dev_macro_f1=0.4695, dev_err=25.88%
2026-02-23 16:38:37,556 - lg_cotrain - INFO - Phase 2 epoch 10/11: loss1=0.0371, loss2=0.0910, dev_macro_f1=0.4922, dev_err=24.12%
2026-02-23 16:38:54,787 - lg_cotrain - INFO - Phase 2 epoch 11/11: loss1=0.0356, loss2=0.0823, dev_macro_f1=0.4701, dev_err=25.88%
2026-02-23 16:38:54,788 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 16:38:55,771 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.4820, dev_err=25.44%, es_counter1=0, es_counter2=0
2026-02-23 16:38:56,766 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.4941, dev_err=25.00%, es_counter1=0, es_counter2=0
2026-02-23 16:38:57,762 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.5009, dev_err=24.56%, es_counter1=0, es_counter2=0
2026-02-23 16:38:58,736 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.4972, dev_err=25.88%, es_counter1=1, es_counter2=1
2026-02-23 16:38:59,739 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.5065, dev_err=25.44%, es_counter1=0, es_counter2=0
2026-02-23 16:39:00,736 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.5137, dev_err=25.00%, es_counter1=0, es_counter2=0
2026-02-23 16:39:01,700 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.5132, dev_err=25.44%, es_counter1=1, es_counter2=1
2026-02-23 16:39:02,687 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.5117, dev_err=25.88%, es_counter1=2, es_counter2=2
2026-02-23 16:39:03,668 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.5079, dev_err=26.32%, es_counter1=3, es_counter2=3
2026-02-23 16:39:04,652 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.5087, dev_err=26.32%, es_counter1=4, es_counter2=4
2026-02-23 16:39:04,652 - lg_cotrain - INFO - Early stopping at epoch 10
2026-02-23 16:39:04,660 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 16:39:06,562 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpa709uey4\canada_wildfires_2016\10_set3\metrics.json
2026-02-23 16:39:06,562 - lg_cotrain - INFO - Test error rate: 23.82%, Test macro-F1: 0.5312, Test ECE: 0.0729
2026-02-23 16:39:06,573 - lg_cotrain - INFO - --- Trial 3/10 done: dev_macro_f1=0.5137 ---
2026-02-23 16:39:06,573 - lg_cotrain - INFO - --- Trial 4/10 ---
2026-02-23 16:39:07,359 - lg_cotrain - INFO - Starting LG-CoTrain: event=canada_wildfires_2016, budget=10, seed_set=3
2026-02-23 16:39:07,371 - lg_cotrain - INFO - Detected 8 classes for event canada_wildfires_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 16:39:07,374 - lg_cotrain - INFO - D_l1: 40, D_l2: 40, D_LG: 1489
2026-02-23 16:39:07,376 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 16:39:13,511 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1248, mean_prob2=0.1239
2026-02-23 16:39:18,480 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1259, mean_prob2=0.1250
2026-02-23 16:39:23,449 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1249, mean_prob2=0.1233
2026-02-23 16:39:28,425 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1243, mean_prob2=0.1230
2026-02-23 16:39:33,437 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1264, mean_prob2=0.1249
2026-02-23 16:39:38,413 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1326, mean_prob2=0.1269
2026-02-23 16:39:43,356 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1380, mean_prob2=0.1299
2026-02-23 16:39:43,357 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 16:39:44,368 - lg_cotrain - INFO - LR scheduler: total_steps_1=435, warmup=46; total_steps_2=435, warmup=46
2026-02-23 16:39:44,369 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1380, range=[0.0533, 0.2094]
2026-02-23 16:39:44,369 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1299, range=[0.0708, 0.1813]
2026-02-23 16:40:02,884 - lg_cotrain - INFO - Phase 2 epoch 1/5: loss1=0.2521, loss2=0.2662, dev_macro_f1=0.1544, dev_err=47.81%
2026-02-23 16:40:21,407 - lg_cotrain - INFO - Phase 2 epoch 2/5: loss1=0.1452, loss2=0.2487, dev_macro_f1=0.1885, dev_err=42.54%
2026-02-23 16:40:39,982 - lg_cotrain - INFO - Phase 2 epoch 3/5: loss1=0.0909, loss2=0.1947, dev_macro_f1=0.3508, dev_err=33.33%
2026-02-23 16:40:58,566 - lg_cotrain - INFO - Phase 2 epoch 4/5: loss1=0.0638, loss2=0.1623, dev_macro_f1=0.3906, dev_err=31.14%
2026-02-23 16:41:17,151 - lg_cotrain - INFO - Phase 2 epoch 5/5: loss1=0.0506, loss2=0.1439, dev_macro_f1=0.4559, dev_err=26.75%
2026-02-23 16:41:17,151 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 16:41:18,238 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.4671, dev_err=26.32%, es_counter1=0, es_counter2=0
2026-02-23 16:41:19,324 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.5029, dev_err=24.56%, es_counter1=0, es_counter2=0
2026-02-23 16:41:20,408 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.5089, dev_err=25.44%, es_counter1=0, es_counter2=0
2026-02-23 16:41:21,496 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.5138, dev_err=26.75%, es_counter1=0, es_counter2=0
2026-02-23 16:41:22,552 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.5074, dev_err=26.75%, es_counter1=1, es_counter2=1
2026-02-23 16:41:23,614 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.5074, dev_err=26.32%, es_counter1=2, es_counter2=2
2026-02-23 16:41:24,663 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.5011, dev_err=25.88%, es_counter1=3, es_counter2=3
2026-02-23 16:41:25,742 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.5840, dev_err=25.44%, es_counter1=0, es_counter2=0
2026-02-23 16:41:26,793 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.5037, dev_err=25.44%, es_counter1=1, es_counter2=1
2026-02-23 16:41:27,846 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.5214, dev_err=23.68%, es_counter1=2, es_counter2=2
2026-02-23 16:41:28,899 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.5296, dev_err=23.25%, es_counter1=3, es_counter2=3
2026-02-23 16:41:29,948 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.5254, dev_err=23.25%, es_counter1=4, es_counter2=4
2026-02-23 16:41:30,998 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.5440, dev_err=23.25%, es_counter1=5, es_counter2=5
2026-02-23 16:41:32,071 - lg_cotrain - INFO - Phase 3 epoch 14: dev_macro_f1=0.6328, dev_err=21.93%, es_counter1=0, es_counter2=0
2026-02-23 16:41:33,146 - lg_cotrain - INFO - Phase 3 epoch 15: dev_macro_f1=0.6981, dev_err=20.61%, es_counter1=0, es_counter2=0
2026-02-23 16:41:34,203 - lg_cotrain - INFO - Phase 3 epoch 16: dev_macro_f1=0.6474, dev_err=21.93%, es_counter1=1, es_counter2=1
2026-02-23 16:41:35,244 - lg_cotrain - INFO - Phase 3 epoch 17: dev_macro_f1=0.6395, dev_err=22.37%, es_counter1=2, es_counter2=2
2026-02-23 16:41:36,294 - lg_cotrain - INFO - Phase 3 epoch 18: dev_macro_f1=0.6481, dev_err=21.49%, es_counter1=3, es_counter2=3
2026-02-23 16:41:37,352 - lg_cotrain - INFO - Phase 3 epoch 19: dev_macro_f1=0.6547, dev_err=21.05%, es_counter1=4, es_counter2=4
2026-02-23 16:41:38,401 - lg_cotrain - INFO - Phase 3 epoch 20: dev_macro_f1=0.6556, dev_err=21.05%, es_counter1=5, es_counter2=5
2026-02-23 16:41:39,449 - lg_cotrain - INFO - Phase 3 epoch 21: dev_macro_f1=0.5936, dev_err=21.49%, es_counter1=6, es_counter2=6
2026-02-23 16:41:39,450 - lg_cotrain - INFO - Early stopping at epoch 21
2026-02-23 16:41:39,463 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 16:41:41,442 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmp0gclfb5s\canada_wildfires_2016\10_set3\metrics.json
2026-02-23 16:41:41,442 - lg_cotrain - INFO - Test error rate: 22.70%, Test macro-F1: 0.5976, Test ECE: 0.1347
2026-02-23 16:41:41,453 - lg_cotrain - INFO - --- Trial 4/10 done: dev_macro_f1=0.6981 ---
2026-02-23 16:41:41,453 - lg_cotrain - INFO - --- Trial 5/10 ---
2026-02-23 16:41:42,035 - lg_cotrain - INFO - Starting LG-CoTrain: event=canada_wildfires_2016, budget=10, seed_set=3
2026-02-23 16:41:42,045 - lg_cotrain - INFO - Detected 8 classes for event canada_wildfires_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 16:41:42,050 - lg_cotrain - INFO - D_l1: 40, D_l2: 40, D_LG: 1489
2026-02-23 16:41:42,052 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 16:41:48,522 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1221, mean_prob2=0.1176
2026-02-23 16:41:54,101 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1287, mean_prob2=0.1233
2026-02-23 16:41:59,578 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1289, mean_prob2=0.1290
2026-02-23 16:42:05,036 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1362, mean_prob2=0.1317
2026-02-23 16:42:10,528 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1368, mean_prob2=0.1407
2026-02-23 16:42:16,034 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1438, mean_prob2=0.1535
2026-02-23 16:42:21,570 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1477, mean_prob2=0.1590
2026-02-23 16:42:21,570 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 16:42:22,663 - lg_cotrain - INFO - LR scheduler: total_steps_1=958, warmup=241; total_steps_2=958, warmup=241
2026-02-23 16:42:22,664 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1477, range=[0.0388, 0.2925]
2026-02-23 16:42:22,665 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1590, range=[0.0478, 0.2794]
2026-02-23 16:42:43,680 - lg_cotrain - INFO - Phase 2 epoch 1/7: loss1=0.2897, loss2=0.2702, dev_macro_f1=0.1436, dev_err=50.44%
2026-02-23 16:43:04,758 - lg_cotrain - INFO - Phase 2 epoch 2/7: loss1=0.1375, loss2=0.2189, dev_macro_f1=0.3193, dev_err=34.65%
2026-02-23 16:43:25,814 - lg_cotrain - INFO - Phase 2 epoch 3/7: loss1=0.0651, loss2=0.1463, dev_macro_f1=0.4454, dev_err=27.19%
2026-02-23 16:43:46,945 - lg_cotrain - INFO - Phase 2 epoch 4/7: loss1=0.0315, loss2=0.1166, dev_macro_f1=0.5057, dev_err=23.25%
2026-02-23 16:44:08,048 - lg_cotrain - INFO - Phase 2 epoch 5/7: loss1=0.0231, loss2=0.0736, dev_macro_f1=0.5132, dev_err=22.81%
2026-02-23 16:44:29,073 - lg_cotrain - INFO - Phase 2 epoch 6/7: loss1=0.0154, loss2=0.0597, dev_macro_f1=0.4651, dev_err=26.75%
2026-02-23 16:44:50,169 - lg_cotrain - INFO - Phase 2 epoch 7/7: loss1=0.0115, loss2=0.0436, dev_macro_f1=0.5184, dev_err=22.81%
2026-02-23 16:44:50,169 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 16:44:51,360 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.5094, dev_err=24.12%, es_counter1=0, es_counter2=0
2026-02-23 16:44:52,554 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.5246, dev_err=23.68%, es_counter1=0, es_counter2=0
2026-02-23 16:44:53,742 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.5491, dev_err=24.12%, es_counter1=0, es_counter2=0
2026-02-23 16:44:54,905 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.5251, dev_err=28.07%, es_counter1=1, es_counter2=1
2026-02-23 16:44:56,071 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.5133, dev_err=28.51%, es_counter1=2, es_counter2=2
2026-02-23 16:44:57,252 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.5759, dev_err=26.32%, es_counter1=0, es_counter2=0
2026-02-23 16:44:58,440 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.5900, dev_err=25.00%, es_counter1=0, es_counter2=0
2026-02-23 16:44:59,632 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.6038, dev_err=23.68%, es_counter1=0, es_counter2=0
2026-02-23 16:45:00,819 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.6050, dev_err=23.68%, es_counter1=0, es_counter2=0
2026-02-23 16:45:01,992 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.6361, dev_err=22.37%, es_counter1=0, es_counter2=0
2026-02-23 16:45:03,184 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.6459, dev_err=21.49%, es_counter1=0, es_counter2=0
2026-02-23 16:45:04,338 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.6459, dev_err=21.49%, es_counter1=1, es_counter2=1
2026-02-23 16:45:05,492 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.6412, dev_err=21.93%, es_counter1=2, es_counter2=2
2026-02-23 16:45:06,677 - lg_cotrain - INFO - Phase 3 epoch 14: dev_macro_f1=0.6477, dev_err=21.49%, es_counter1=0, es_counter2=0
2026-02-23 16:45:07,834 - lg_cotrain - INFO - Phase 3 epoch 15: dev_macro_f1=0.6477, dev_err=21.49%, es_counter1=1, es_counter2=1
2026-02-23 16:45:08,994 - lg_cotrain - INFO - Phase 3 epoch 16: dev_macro_f1=0.6477, dev_err=21.49%, es_counter1=2, es_counter2=2
2026-02-23 16:45:10,160 - lg_cotrain - INFO - Phase 3 epoch 17: dev_macro_f1=0.6376, dev_err=21.93%, es_counter1=3, es_counter2=3
2026-02-23 16:45:11,323 - lg_cotrain - INFO - Phase 3 epoch 18: dev_macro_f1=0.6477, dev_err=21.49%, es_counter1=4, es_counter2=4
2026-02-23 16:45:12,483 - lg_cotrain - INFO - Phase 3 epoch 19: dev_macro_f1=0.6477, dev_err=21.49%, es_counter1=5, es_counter2=5
2026-02-23 16:45:13,636 - lg_cotrain - INFO - Phase 3 epoch 20: dev_macro_f1=0.6477, dev_err=21.49%, es_counter1=6, es_counter2=6
2026-02-23 16:45:13,636 - lg_cotrain - INFO - Early stopping at epoch 20
2026-02-23 16:45:13,646 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 16:45:15,819 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpt8mt340t\canada_wildfires_2016\10_set3\metrics.json
2026-02-23 16:45:15,819 - lg_cotrain - INFO - Test error rate: 23.82%, Test macro-F1: 0.5797, Test ECE: 0.0624
2026-02-23 16:45:15,829 - lg_cotrain - INFO - --- Trial 5/10 done: dev_macro_f1=0.6477 ---
2026-02-23 16:45:15,830 - lg_cotrain - INFO - --- Trial 6/10 ---
2026-02-23 16:45:16,396 - lg_cotrain - INFO - Starting LG-CoTrain: event=canada_wildfires_2016, budget=10, seed_set=3
2026-02-23 16:45:16,410 - lg_cotrain - INFO - Detected 8 classes for event canada_wildfires_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 16:45:16,416 - lg_cotrain - INFO - D_l1: 40, D_l2: 40, D_LG: 1489
2026-02-23 16:45:16,417 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 16:45:22,815 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1184, mean_prob2=0.1132
2026-02-23 16:45:28,280 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1311, mean_prob2=0.1257
2026-02-23 16:45:33,712 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1098, mean_prob2=0.1152
2026-02-23 16:45:39,157 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1198, mean_prob2=0.1165
2026-02-23 16:45:44,561 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1448, mean_prob2=0.1185
2026-02-23 16:45:49,944 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1102, mean_prob2=0.1167
2026-02-23 16:45:55,321 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1251, mean_prob2=0.1242
2026-02-23 16:45:55,321 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 16:45:56,324 - lg_cotrain - INFO - LR scheduler: total_steps_1=1334, warmup=24; total_steps_2=1334, warmup=24
2026-02-23 16:45:56,324 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1251, range=[0.0788, 0.1931]
2026-02-23 16:45:56,325 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1242, range=[0.1092, 0.1412]
2026-02-23 16:46:17,224 - lg_cotrain - INFO - Phase 2 epoch 1/11: loss1=0.2207, loss2=0.2167, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:46:38,122 - lg_cotrain - INFO - Phase 2 epoch 2/11: loss1=0.1376, loss2=0.3138, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:46:59,012 - lg_cotrain - INFO - Phase 2 epoch 3/11: loss1=0.1105, loss2=0.3194, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:47:19,942 - lg_cotrain - INFO - Phase 2 epoch 4/11: loss1=0.1001, loss2=0.3157, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:47:40,821 - lg_cotrain - INFO - Phase 2 epoch 5/11: loss1=0.0829, loss2=0.3105, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:48:01,688 - lg_cotrain - INFO - Phase 2 epoch 6/11: loss1=0.0744, loss2=0.3015, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:48:22,547 - lg_cotrain - INFO - Phase 2 epoch 7/11: loss1=0.0644, loss2=0.2921, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:48:43,469 - lg_cotrain - INFO - Phase 2 epoch 8/11: loss1=0.0578, loss2=0.2833, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:49:04,344 - lg_cotrain - INFO - Phase 2 epoch 9/11: loss1=0.0508, loss2=0.2756, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:49:25,261 - lg_cotrain - INFO - Phase 2 epoch 10/11: loss1=0.0458, loss2=0.2684, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:49:46,138 - lg_cotrain - INFO - Phase 2 epoch 11/11: loss1=0.0444, loss2=0.2591, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:49:46,139 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 16:49:47,308 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.0735, dev_err=58.33%, es_counter1=0, es_counter2=0
2026-02-23 16:49:48,460 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.0085, dev_err=96.49%, es_counter1=1, es_counter2=1
2026-02-23 16:49:49,593 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.0308, dev_err=85.96%, es_counter1=2, es_counter2=2
2026-02-23 16:49:50,741 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.0164, dev_err=92.98%, es_counter1=3, es_counter2=3
2026-02-23 16:49:51,888 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.0164, dev_err=92.98%, es_counter1=4, es_counter2=4
2026-02-23 16:49:53,036 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.0115, dev_err=95.18%, es_counter1=5, es_counter2=5
2026-02-23 16:49:54,183 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.0247, dev_err=89.04%, es_counter1=6, es_counter2=6
2026-02-23 16:49:55,332 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.0247, dev_err=89.04%, es_counter1=7, es_counter2=7
2026-02-23 16:49:56,480 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.0735, dev_err=58.33%, es_counter1=8, es_counter2=8
2026-02-23 16:49:57,629 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.0735, dev_err=58.33%, es_counter1=9, es_counter2=9
2026-02-23 16:49:58,775 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.0735, dev_err=58.33%, es_counter1=10, es_counter2=10
2026-02-23 16:49:58,777 - lg_cotrain - INFO - Early stopping at epoch 11
2026-02-23 16:49:58,786 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 16:50:00,929 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpbyl43ucy\canada_wildfires_2016\10_set3\metrics.json
2026-02-23 16:50:00,929 - lg_cotrain - INFO - Test error rate: 58.20%, Test macro-F1: 0.0737, Test ECE: 0.2958
2026-02-23 16:50:00,939 - lg_cotrain - INFO - --- Trial 6/10 done: dev_macro_f1=0.0735 ---
2026-02-23 16:50:00,939 - lg_cotrain - INFO - --- Trial 7/10 ---
2026-02-23 16:50:01,497 - lg_cotrain - INFO - Starting LG-CoTrain: event=canada_wildfires_2016, budget=10, seed_set=3
2026-02-23 16:50:01,511 - lg_cotrain - INFO - Detected 8 classes for event canada_wildfires_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 16:50:01,515 - lg_cotrain - INFO - D_l1: 40, D_l2: 40, D_LG: 1489
2026-02-23 16:50:01,516 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 16:50:08,505 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1285, mean_prob2=0.1335
2026-02-23 16:50:14,427 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1317, mean_prob2=0.1470
2026-02-23 16:50:20,362 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1293, mean_prob2=0.1656
2026-02-23 16:50:26,254 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1297, mean_prob2=0.1737
2026-02-23 16:50:32,130 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1328, mean_prob2=0.2028
2026-02-23 16:50:38,052 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1527, mean_prob2=0.2258
2026-02-23 16:50:44,008 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1742, mean_prob2=0.2784
2026-02-23 16:50:44,008 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 16:50:45,018 - lg_cotrain - INFO - LR scheduler: total_steps_1=3492, warmup=598; total_steps_2=3492, warmup=598
2026-02-23 16:50:45,018 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1742, range=[0.0358, 0.5146]
2026-02-23 16:50:45,018 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.2784, range=[0.0241, 0.6405]
2026-02-23 16:51:09,419 - lg_cotrain - INFO - Phase 2 epoch 1/16: loss1=0.3852, loss2=0.2595, dev_macro_f1=0.2553, dev_err=40.35%
2026-02-23 16:51:33,935 - lg_cotrain - INFO - Phase 2 epoch 2/16: loss1=0.1065, loss2=0.1858, dev_macro_f1=0.5076, dev_err=24.12%
2026-02-23 16:51:58,365 - lg_cotrain - INFO - Phase 2 epoch 3/16: loss1=0.0428, loss2=0.2006, dev_macro_f1=0.5021, dev_err=25.88%
2026-02-23 16:52:22,842 - lg_cotrain - INFO - Phase 2 epoch 4/16: loss1=0.0613, loss2=0.2368, dev_macro_f1=0.5978, dev_err=20.61%
2026-02-23 16:52:47,298 - lg_cotrain - INFO - Phase 2 epoch 5/16: loss1=0.0207, loss2=0.1782, dev_macro_f1=0.5714, dev_err=22.37%
2026-02-23 16:53:11,695 - lg_cotrain - INFO - Phase 2 epoch 6/16: loss1=0.0600, loss2=0.0997, dev_macro_f1=0.5951, dev_err=21.93%
2026-02-23 16:53:36,115 - lg_cotrain - INFO - Phase 2 epoch 7/16: loss1=0.0435, loss2=0.0812, dev_macro_f1=0.5317, dev_err=24.12%
2026-02-23 16:54:00,641 - lg_cotrain - INFO - Phase 2 epoch 8/16: loss1=0.0265, loss2=0.0397, dev_macro_f1=0.5582, dev_err=24.12%
2026-02-23 16:54:25,148 - lg_cotrain - INFO - Phase 2 epoch 9/16: loss1=0.0294, loss2=0.0346, dev_macro_f1=0.5735, dev_err=21.49%
2026-02-23 16:54:49,604 - lg_cotrain - INFO - Phase 2 epoch 10/16: loss1=0.0179, loss2=0.0680, dev_macro_f1=0.5520, dev_err=23.68%
2026-02-23 16:55:14,048 - lg_cotrain - INFO - Phase 2 epoch 11/16: loss1=0.0110, loss2=0.0188, dev_macro_f1=0.5718, dev_err=23.25%
2026-02-23 16:55:38,485 - lg_cotrain - INFO - Phase 2 epoch 12/16: loss1=0.0106, loss2=0.0162, dev_macro_f1=0.5566, dev_err=23.25%
2026-02-23 16:56:02,902 - lg_cotrain - INFO - Phase 2 epoch 13/16: loss1=0.0036, loss2=0.0136, dev_macro_f1=0.5802, dev_err=21.49%
2026-02-23 16:56:27,382 - lg_cotrain - INFO - Phase 2 epoch 14/16: loss1=0.0070, loss2=0.0076, dev_macro_f1=0.5820, dev_err=21.49%
2026-02-23 16:56:51,828 - lg_cotrain - INFO - Phase 2 epoch 15/16: loss1=0.0135, loss2=0.0055, dev_macro_f1=0.5702, dev_err=23.25%
2026-02-23 16:57:16,261 - lg_cotrain - INFO - Phase 2 epoch 16/16: loss1=0.0079, loss2=0.0041, dev_macro_f1=0.5537, dev_err=25.00%
2026-02-23 16:57:16,261 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 16:57:17,572 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.5688, dev_err=23.25%, es_counter1=0, es_counter2=0
2026-02-23 16:57:18,850 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.5498, dev_err=25.00%, es_counter1=1, es_counter2=1
2026-02-23 16:57:20,163 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.5931, dev_err=25.44%, es_counter1=0, es_counter2=0
2026-02-23 16:57:21,446 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.5646, dev_err=27.19%, es_counter1=1, es_counter2=1
2026-02-23 16:57:22,724 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.5676, dev_err=28.07%, es_counter1=2, es_counter2=2
2026-02-23 16:57:24,003 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.5742, dev_err=28.07%, es_counter1=3, es_counter2=3
2026-02-23 16:57:25,296 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.6004, dev_err=27.19%, es_counter1=0, es_counter2=0
2026-02-23 16:57:26,574 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.5968, dev_err=27.19%, es_counter1=1, es_counter2=1
2026-02-23 16:57:27,878 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.6041, dev_err=25.88%, es_counter1=0, es_counter2=0
2026-02-23 16:57:29,167 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.6087, dev_err=25.00%, es_counter1=0, es_counter2=0
2026-02-23 16:57:30,442 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.6055, dev_err=25.44%, es_counter1=1, es_counter2=1
2026-02-23 16:57:31,718 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.6013, dev_err=25.88%, es_counter1=2, es_counter2=2
2026-02-23 16:57:32,996 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.6039, dev_err=26.32%, es_counter1=3, es_counter2=3
2026-02-23 16:57:34,273 - lg_cotrain - INFO - Phase 3 epoch 14: dev_macro_f1=0.5980, dev_err=26.75%, es_counter1=4, es_counter2=4
2026-02-23 16:57:35,546 - lg_cotrain - INFO - Phase 3 epoch 15: dev_macro_f1=0.5964, dev_err=27.19%, es_counter1=5, es_counter2=5
2026-02-23 16:57:36,821 - lg_cotrain - INFO - Phase 3 epoch 16: dev_macro_f1=0.5897, dev_err=27.63%, es_counter1=6, es_counter2=6
2026-02-23 16:57:38,102 - lg_cotrain - INFO - Phase 3 epoch 17: dev_macro_f1=0.5861, dev_err=28.07%, es_counter1=7, es_counter2=7
2026-02-23 16:57:38,102 - lg_cotrain - INFO - Early stopping at epoch 17
2026-02-23 16:57:38,113 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 16:57:40,435 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpef2zwiqn\canada_wildfires_2016\10_set3\metrics.json
2026-02-23 16:57:40,435 - lg_cotrain - INFO - Test error rate: 25.39%, Test macro-F1: 0.5960, Test ECE: 0.1132
2026-02-23 16:57:40,444 - lg_cotrain - INFO - --- Trial 7/10 done: dev_macro_f1=0.6087 ---
2026-02-23 16:57:40,445 - lg_cotrain - INFO - --- Trial 8/10 ---
2026-02-23 16:57:41,007 - lg_cotrain - INFO - Starting LG-CoTrain: event=canada_wildfires_2016, budget=10, seed_set=3
2026-02-23 16:57:41,019 - lg_cotrain - INFO - Detected 8 classes for event canada_wildfires_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 16:57:41,023 - lg_cotrain - INFO - D_l1: 40, D_l2: 40, D_LG: 1489
2026-02-23 16:57:41,023 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 16:57:46,778 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1249, mean_prob2=0.1218
2026-02-23 16:57:51,545 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1243, mean_prob2=0.1210
2026-02-23 16:57:56,314 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1239, mean_prob2=0.1208
2026-02-23 16:58:01,102 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1252, mean_prob2=0.1213
2026-02-23 16:58:05,832 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1277, mean_prob2=0.1226
2026-02-23 16:58:10,602 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1310, mean_prob2=0.1246
2026-02-23 16:58:15,368 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1333, mean_prob2=0.1266
2026-02-23 16:58:15,368 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 16:58:16,381 - lg_cotrain - INFO - LR scheduler: total_steps_1=508, warmup=3; total_steps_2=508, warmup=3
2026-02-23 16:58:16,382 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1333, range=[0.0523, 0.1895]
2026-02-23 16:58:16,382 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1266, range=[0.0735, 0.1831]
2026-02-23 16:58:33,608 - lg_cotrain - INFO - Phase 2 epoch 1/17: loss1=0.2399, loss2=0.2452, dev_macro_f1=0.1497, dev_err=49.56%
2026-02-23 16:58:50,846 - lg_cotrain - INFO - Phase 2 epoch 2/17: loss1=0.1620, loss2=0.2809, dev_macro_f1=0.1697, dev_err=43.86%
2026-02-23 16:59:08,194 - lg_cotrain - INFO - Phase 2 epoch 3/17: loss1=0.1188, loss2=0.2263, dev_macro_f1=0.2424, dev_err=38.16%
2026-02-23 16:59:25,555 - lg_cotrain - INFO - Phase 2 epoch 4/17: loss1=0.0948, loss2=0.2092, dev_macro_f1=0.2838, dev_err=34.21%
2026-02-23 16:59:43,169 - lg_cotrain - INFO - Phase 2 epoch 5/17: loss1=0.0733, loss2=0.1880, dev_macro_f1=0.3591, dev_err=31.58%
2026-02-23 17:00:00,595 - lg_cotrain - INFO - Phase 2 epoch 6/17: loss1=0.0573, loss2=0.1653, dev_macro_f1=0.3539, dev_err=31.14%
2026-02-23 17:00:17,926 - lg_cotrain - INFO - Phase 2 epoch 7/17: loss1=0.0471, loss2=0.1507, dev_macro_f1=0.4657, dev_err=25.44%
2026-02-23 17:00:35,255 - lg_cotrain - INFO - Phase 2 epoch 8/17: loss1=0.0411, loss2=0.1356, dev_macro_f1=0.4982, dev_err=23.25%
2026-02-23 17:00:52,531 - lg_cotrain - INFO - Phase 2 epoch 9/17: loss1=0.0360, loss2=0.1158, dev_macro_f1=0.4841, dev_err=24.56%
2026-02-23 17:01:09,826 - lg_cotrain - INFO - Phase 2 epoch 10/17: loss1=0.0314, loss2=0.1028, dev_macro_f1=0.4757, dev_err=25.88%
2026-02-23 17:01:27,136 - lg_cotrain - INFO - Phase 2 epoch 11/17: loss1=0.0283, loss2=0.0976, dev_macro_f1=0.4935, dev_err=24.56%
2026-02-23 17:01:44,401 - lg_cotrain - INFO - Phase 2 epoch 12/17: loss1=0.0264, loss2=0.0862, dev_macro_f1=0.4804, dev_err=25.00%
2026-02-23 17:02:01,687 - lg_cotrain - INFO - Phase 2 epoch 13/17: loss1=0.0249, loss2=0.0742, dev_macro_f1=0.5030, dev_err=23.68%
2026-02-23 17:02:19,027 - lg_cotrain - INFO - Phase 2 epoch 14/17: loss1=0.0243, loss2=0.0716, dev_macro_f1=0.4924, dev_err=24.56%
2026-02-23 17:02:36,263 - lg_cotrain - INFO - Phase 2 epoch 15/17: loss1=0.0229, loss2=0.0670, dev_macro_f1=0.4997, dev_err=24.12%
2026-02-23 17:02:53,544 - lg_cotrain - INFO - Phase 2 epoch 16/17: loss1=0.0228, loss2=0.0607, dev_macro_f1=0.4798, dev_err=25.44%
2026-02-23 17:03:10,878 - lg_cotrain - INFO - Phase 2 epoch 17/17: loss1=0.0217, loss2=0.0589, dev_macro_f1=0.4959, dev_err=24.56%
2026-02-23 17:03:10,878 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 17:03:11,882 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.4910, dev_err=25.00%, es_counter1=0, es_counter2=0
2026-02-23 17:03:12,892 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.4950, dev_err=24.56%, es_counter1=0, es_counter2=0
2026-02-23 17:03:13,890 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.5011, dev_err=24.56%, es_counter1=0, es_counter2=0
2026-02-23 17:03:14,889 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.5046, dev_err=24.56%, es_counter1=0, es_counter2=0
2026-02-23 17:03:15,860 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.4992, dev_err=25.44%, es_counter1=1, es_counter2=1
2026-02-23 17:03:16,833 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.5034, dev_err=25.00%, es_counter1=2, es_counter2=2
2026-02-23 17:03:17,807 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.4928, dev_err=25.88%, es_counter1=3, es_counter2=3
2026-02-23 17:03:18,780 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.4993, dev_err=25.44%, es_counter1=4, es_counter2=4
2026-02-23 17:03:19,777 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.5107, dev_err=25.00%, es_counter1=0, es_counter2=0
2026-02-23 17:03:20,779 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.5127, dev_err=25.44%, es_counter1=0, es_counter2=0
2026-02-23 17:03:21,746 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.5111, dev_err=25.88%, es_counter1=1, es_counter2=1
2026-02-23 17:03:22,710 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.5105, dev_err=26.32%, es_counter1=2, es_counter2=2
2026-02-23 17:03:23,685 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.5087, dev_err=26.32%, es_counter1=3, es_counter2=3
2026-02-23 17:03:24,665 - lg_cotrain - INFO - Phase 3 epoch 14: dev_macro_f1=0.5072, dev_err=26.75%, es_counter1=4, es_counter2=4
2026-02-23 17:03:25,643 - lg_cotrain - INFO - Phase 3 epoch 15: dev_macro_f1=0.5051, dev_err=27.19%, es_counter1=5, es_counter2=5
2026-02-23 17:03:26,616 - lg_cotrain - INFO - Phase 3 epoch 16: dev_macro_f1=0.5112, dev_err=26.75%, es_counter1=6, es_counter2=6
2026-02-23 17:03:27,597 - lg_cotrain - INFO - Phase 3 epoch 17: dev_macro_f1=0.5121, dev_err=26.32%, es_counter1=7, es_counter2=7
2026-02-23 17:03:28,587 - lg_cotrain - INFO - Phase 3 epoch 18: dev_macro_f1=0.5142, dev_err=25.88%, es_counter1=0, es_counter2=0
2026-02-23 17:03:29,557 - lg_cotrain - INFO - Phase 3 epoch 19: dev_macro_f1=0.5136, dev_err=25.88%, es_counter1=1, es_counter2=1
2026-02-23 17:03:30,543 - lg_cotrain - INFO - Phase 3 epoch 20: dev_macro_f1=0.5166, dev_err=25.44%, es_counter1=0, es_counter2=0
2026-02-23 17:03:31,506 - lg_cotrain - INFO - Phase 3 epoch 21: dev_macro_f1=0.5166, dev_err=25.44%, es_counter1=1, es_counter2=1
2026-02-23 17:03:32,482 - lg_cotrain - INFO - Phase 3 epoch 22: dev_macro_f1=0.5128, dev_err=25.88%, es_counter1=2, es_counter2=2
2026-02-23 17:03:33,453 - lg_cotrain - INFO - Phase 3 epoch 23: dev_macro_f1=0.5128, dev_err=25.88%, es_counter1=3, es_counter2=3
2026-02-23 17:03:34,462 - lg_cotrain - INFO - Phase 3 epoch 24: dev_macro_f1=0.5201, dev_err=25.44%, es_counter1=0, es_counter2=0
2026-02-23 17:03:35,441 - lg_cotrain - INFO - Phase 3 epoch 25: dev_macro_f1=0.5201, dev_err=25.44%, es_counter1=1, es_counter2=1
2026-02-23 17:03:36,421 - lg_cotrain - INFO - Phase 3 epoch 26: dev_macro_f1=0.5201, dev_err=25.44%, es_counter1=2, es_counter2=2
2026-02-23 17:03:37,391 - lg_cotrain - INFO - Phase 3 epoch 27: dev_macro_f1=0.5162, dev_err=25.88%, es_counter1=3, es_counter2=3
2026-02-23 17:03:38,402 - lg_cotrain - INFO - Phase 3 epoch 28: dev_macro_f1=0.5205, dev_err=25.44%, es_counter1=0, es_counter2=0
2026-02-23 17:03:39,380 - lg_cotrain - INFO - Phase 3 epoch 29: dev_macro_f1=0.5205, dev_err=25.44%, es_counter1=1, es_counter2=1
2026-02-23 17:03:40,359 - lg_cotrain - INFO - Phase 3 epoch 30: dev_macro_f1=0.5108, dev_err=26.32%, es_counter1=2, es_counter2=2
2026-02-23 17:03:41,333 - lg_cotrain - INFO - Phase 3 epoch 31: dev_macro_f1=0.5133, dev_err=25.88%, es_counter1=3, es_counter2=3
2026-02-23 17:03:42,302 - lg_cotrain - INFO - Phase 3 epoch 32: dev_macro_f1=0.5055, dev_err=26.32%, es_counter1=4, es_counter2=4
2026-02-23 17:03:43,277 - lg_cotrain - INFO - Phase 3 epoch 33: dev_macro_f1=0.5061, dev_err=26.32%, es_counter1=5, es_counter2=5
2026-02-23 17:03:44,253 - lg_cotrain - INFO - Phase 3 epoch 34: dev_macro_f1=0.5061, dev_err=26.32%, es_counter1=6, es_counter2=6
2026-02-23 17:03:45,234 - lg_cotrain - INFO - Phase 3 epoch 35: dev_macro_f1=0.5061, dev_err=26.32%, es_counter1=7, es_counter2=7
2026-02-23 17:03:46,209 - lg_cotrain - INFO - Phase 3 epoch 36: dev_macro_f1=0.5033, dev_err=26.75%, es_counter1=8, es_counter2=8
2026-02-23 17:03:47,190 - lg_cotrain - INFO - Phase 3 epoch 37: dev_macro_f1=0.5075, dev_err=26.32%, es_counter1=9, es_counter2=9
2026-02-23 17:03:48,168 - lg_cotrain - INFO - Phase 3 epoch 38: dev_macro_f1=0.5082, dev_err=26.32%, es_counter1=10, es_counter2=10
2026-02-23 17:03:48,169 - lg_cotrain - INFO - Early stopping at epoch 38
2026-02-23 17:03:48,179 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 17:03:50,072 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpeyayz3oj\canada_wildfires_2016\10_set3\metrics.json
2026-02-23 17:03:50,072 - lg_cotrain - INFO - Test error rate: 24.94%, Test macro-F1: 0.5403, Test ECE: 0.0648
2026-02-23 17:03:50,084 - lg_cotrain - INFO - --- Trial 8/10 done: dev_macro_f1=0.5205 ---
2026-02-23 17:03:50,084 - lg_cotrain - INFO - --- Trial 9/10 ---
2026-02-23 17:03:50,701 - lg_cotrain - INFO - Starting LG-CoTrain: event=canada_wildfires_2016, budget=10, seed_set=3
2026-02-23 17:03:50,713 - lg_cotrain - INFO - Detected 8 classes for event canada_wildfires_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 17:03:50,717 - lg_cotrain - INFO - D_l1: 40, D_l2: 40, D_LG: 1489
2026-02-23 17:03:50,718 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 17:03:57,625 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1272, mean_prob2=0.1126
2026-02-23 17:04:03,650 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1222, mean_prob2=0.1279
2026-02-23 17:04:09,628 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1147, mean_prob2=0.1272
2026-02-23 17:04:15,546 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1222, mean_prob2=0.1285
2026-02-23 17:04:21,462 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1321, mean_prob2=0.1366
2026-02-23 17:04:27,415 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1185, mean_prob2=0.1159
2026-02-23 17:04:33,424 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1099, mean_prob2=0.1173
2026-02-23 17:04:33,425 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 17:04:34,465 - lg_cotrain - INFO - LR scheduler: total_steps_1=3118, warmup=275; total_steps_2=3118, warmup=275
2026-02-23 17:04:34,466 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1099, range=[0.0777, 0.1885]
2026-02-23 17:04:34,466 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1173, range=[0.0930, 0.1508]
2026-02-23 17:04:59,149 - lg_cotrain - INFO - Phase 2 epoch 1/14: loss1=0.1720, loss2=0.1440, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 17:05:23,792 - lg_cotrain - INFO - Phase 2 epoch 2/14: loss1=0.1902, loss2=0.3640, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 17:05:48,349 - lg_cotrain - INFO - Phase 2 epoch 3/14: loss1=0.0589, loss2=0.3538, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 17:06:12,891 - lg_cotrain - INFO - Phase 2 epoch 4/14: loss1=0.0286, loss2=0.3254, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 17:06:37,346 - lg_cotrain - INFO - Phase 2 epoch 5/14: loss1=0.0126, loss2=0.3049, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 17:07:01,840 - lg_cotrain - INFO - Phase 2 epoch 6/14: loss1=0.0094, loss2=0.2858, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 17:07:26,386 - lg_cotrain - INFO - Phase 2 epoch 7/14: loss1=0.0065, loss2=0.2654, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 17:07:50,965 - lg_cotrain - INFO - Phase 2 epoch 8/14: loss1=0.0040, loss2=0.2525, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 17:08:15,467 - lg_cotrain - INFO - Phase 2 epoch 9/14: loss1=0.0028, loss2=0.2399, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 17:08:39,937 - lg_cotrain - INFO - Phase 2 epoch 10/14: loss1=0.0019, loss2=0.2293, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 17:09:04,343 - lg_cotrain - INFO - Phase 2 epoch 11/14: loss1=0.0017, loss2=0.2196, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 17:09:28,738 - lg_cotrain - INFO - Phase 2 epoch 12/14: loss1=0.0014, loss2=0.2112, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 17:09:53,178 - lg_cotrain - INFO - Phase 2 epoch 13/14: loss1=0.0013, loss2=0.2032, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 17:10:17,571 - lg_cotrain - INFO - Phase 2 epoch 14/14: loss1=0.0013, loss2=0.1958, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 17:10:17,571 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 17:10:18,865 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.0735, dev_err=58.33%, es_counter1=0, es_counter2=0
2026-02-23 17:10:20,139 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.0735, dev_err=58.33%, es_counter1=1, es_counter2=1
2026-02-23 17:10:21,410 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.0022, dev_err=99.12%, es_counter1=2, es_counter2=2
2026-02-23 17:10:22,687 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.0247, dev_err=89.04%, es_counter1=3, es_counter2=3
2026-02-23 17:10:23,954 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.0247, dev_err=89.04%, es_counter1=4, es_counter2=4
2026-02-23 17:10:23,954 - lg_cotrain - INFO - Early stopping at epoch 5
2026-02-23 17:10:23,964 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 17:10:26,254 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpnhf4pg_m\canada_wildfires_2016\10_set3\metrics.json
2026-02-23 17:10:26,254 - lg_cotrain - INFO - Test error rate: 58.20%, Test macro-F1: 0.0737, Test ECE: 0.4932
2026-02-23 17:10:26,265 - lg_cotrain - INFO - --- Trial 9/10 done: dev_macro_f1=0.0735 ---
2026-02-23 17:10:26,265 - lg_cotrain - INFO - --- Trial 10/10 ---
2026-02-23 17:10:26,859 - lg_cotrain - INFO - Starting LG-CoTrain: event=canada_wildfires_2016, budget=10, seed_set=3
2026-02-23 17:10:26,873 - lg_cotrain - INFO - Detected 8 classes for event canada_wildfires_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 17:10:26,877 - lg_cotrain - INFO - D_l1: 40, D_l2: 40, D_LG: 1489
2026-02-23 17:10:26,878 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 17:10:33,289 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1231, mean_prob2=0.1191
2026-02-23 17:10:38,740 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1275, mean_prob2=0.1205
2026-02-23 17:10:44,213 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1283, mean_prob2=0.1231
2026-02-23 17:10:49,686 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1269, mean_prob2=0.1262
2026-02-23 17:10:55,121 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1302, mean_prob2=0.1312
2026-02-23 17:11:00,582 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1416, mean_prob2=0.1371
2026-02-23 17:11:06,063 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1458, mean_prob2=0.1441
2026-02-23 17:11:06,063 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 17:11:07,276 - lg_cotrain - INFO - LR scheduler: total_steps_1=1804, warmup=210; total_steps_2=1804, warmup=210
2026-02-23 17:11:07,277 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1458, range=[0.0466, 0.2355]
2026-02-23 17:11:07,277 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1441, range=[0.0636, 0.2133]
2026-02-23 17:11:28,235 - lg_cotrain - INFO - Phase 2 epoch 1/16: loss1=0.2729, loss2=0.2754, dev_macro_f1=0.1262, dev_err=53.51%
2026-02-23 17:11:49,239 - lg_cotrain - INFO - Phase 2 epoch 2/16: loss1=0.1505, loss2=0.2397, dev_macro_f1=0.2789, dev_err=35.09%
2026-02-23 17:12:10,237 - lg_cotrain - INFO - Phase 2 epoch 3/16: loss1=0.0774, loss2=0.1712, dev_macro_f1=0.4034, dev_err=29.39%
2026-02-23 17:12:31,231 - lg_cotrain - INFO - Phase 2 epoch 4/16: loss1=0.0420, loss2=0.1309, dev_macro_f1=0.4848, dev_err=24.56%
2026-02-23 17:12:52,172 - lg_cotrain - INFO - Phase 2 epoch 5/16: loss1=0.0300, loss2=0.0934, dev_macro_f1=0.5079, dev_err=22.81%
2026-02-23 17:13:13,212 - lg_cotrain - INFO - Phase 2 epoch 6/16: loss1=0.0222, loss2=0.0706, dev_macro_f1=0.4808, dev_err=25.00%
2026-02-23 17:13:34,268 - lg_cotrain - INFO - Phase 2 epoch 7/16: loss1=0.0178, loss2=0.0515, dev_macro_f1=0.4915, dev_err=24.56%
2026-02-23 17:13:55,287 - lg_cotrain - INFO - Phase 2 epoch 8/16: loss1=0.0147, loss2=0.0383, dev_macro_f1=0.4837, dev_err=25.00%
2026-02-23 17:14:16,290 - lg_cotrain - INFO - Phase 2 epoch 9/16: loss1=0.0129, loss2=0.0293, dev_macro_f1=0.4956, dev_err=24.56%
2026-02-23 17:14:37,328 - lg_cotrain - INFO - Phase 2 epoch 10/16: loss1=0.0118, loss2=0.0217, dev_macro_f1=0.4898, dev_err=25.00%
2026-02-23 17:14:58,413 - lg_cotrain - INFO - Phase 2 epoch 11/16: loss1=0.0085, loss2=0.0190, dev_macro_f1=0.5037, dev_err=23.68%
2026-02-23 17:15:19,412 - lg_cotrain - INFO - Phase 2 epoch 12/16: loss1=0.0089, loss2=0.0286, dev_macro_f1=0.5106, dev_err=23.25%
2026-02-23 17:15:40,407 - lg_cotrain - INFO - Phase 2 epoch 13/16: loss1=0.0081, loss2=0.0146, dev_macro_f1=0.4969, dev_err=24.56%
2026-02-23 17:16:01,414 - lg_cotrain - INFO - Phase 2 epoch 14/16: loss1=0.0068, loss2=0.0121, dev_macro_f1=0.5377, dev_err=23.68%
2026-02-23 17:16:22,465 - lg_cotrain - INFO - Phase 2 epoch 15/16: loss1=0.0093, loss2=0.0100, dev_macro_f1=0.5320, dev_err=24.12%
2026-02-23 17:16:43,431 - lg_cotrain - INFO - Phase 2 epoch 16/16: loss1=0.0078, loss2=0.0097, dev_macro_f1=0.5441, dev_err=22.81%
2026-02-23 17:16:43,431 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 17:16:44,614 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.5379, dev_err=22.81%, es_counter1=0, es_counter2=0
2026-02-23 17:16:45,777 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.5182, dev_err=24.56%, es_counter1=1, es_counter2=1
2026-02-23 17:16:46,957 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.5555, dev_err=23.25%, es_counter1=0, es_counter2=0
2026-02-23 17:16:48,117 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.5545, dev_err=23.68%, es_counter1=1, es_counter2=1
2026-02-23 17:16:49,272 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.5413, dev_err=25.00%, es_counter1=2, es_counter2=2
2026-02-23 17:16:50,436 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.5528, dev_err=24.56%, es_counter1=3, es_counter2=3
2026-02-23 17:16:51,596 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.5408, dev_err=25.44%, es_counter1=4, es_counter2=4
2026-02-23 17:16:52,758 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.5480, dev_err=25.00%, es_counter1=5, es_counter2=5
2026-02-23 17:16:52,758 - lg_cotrain - INFO - Early stopping at epoch 8
2026-02-23 17:16:52,768 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 17:16:54,940 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpyr856j4f\canada_wildfires_2016\10_set3\metrics.json
2026-02-23 17:16:54,940 - lg_cotrain - INFO - Test error rate: 22.47%, Test macro-F1: 0.5792, Test ECE: 0.1298
2026-02-23 17:16:54,952 - lg_cotrain - INFO - --- Trial 10/10 done: dev_macro_f1=0.5555 ---
