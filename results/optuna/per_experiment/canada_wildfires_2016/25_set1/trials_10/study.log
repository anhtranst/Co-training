2026-02-23 16:51:07,794 - lg_cotrain - INFO - === Optuna study: canada_wildfires_2016 budget=25 seed=1 | target=10 trials, 0 replayed, 10 new ===
2026-02-23 16:51:07,794 - lg_cotrain - INFO - --- Trial 1/10 ---
2026-02-23 16:51:08,382 - lg_cotrain - INFO - Starting LG-CoTrain: event=canada_wildfires_2016, budget=25, seed_set=1
2026-02-23 16:51:08,393 - lg_cotrain - INFO - Detected 8 classes for event canada_wildfires_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 16:51:08,397 - lg_cotrain - INFO - D_l1: 98, D_l2: 91, D_LG: 1380
2026-02-23 16:51:08,398 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 16:51:15,687 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1186, mean_prob2=0.1462
2026-02-23 16:51:21,814 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1276, mean_prob2=0.1744
2026-02-23 16:51:28,050 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1236, mean_prob2=0.1851
2026-02-23 16:51:34,239 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1669, mean_prob2=0.2476
2026-02-23 16:51:40,365 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.2127, mean_prob2=0.3087
2026-02-23 16:51:46,636 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.2246, mean_prob2=0.3417
2026-02-23 16:51:53,082 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.2982, mean_prob2=0.3978
2026-02-23 16:51:53,082 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 16:51:54,130 - lg_cotrain - INFO - LR scheduler: total_steps_1=708, warmup=174; total_steps_2=608, warmup=149
2026-02-23 16:51:54,131 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.2982, range=[0.0263, 0.6643]
2026-02-23 16:51:54,131 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.3978, range=[0.0082, 0.8599]
2026-02-23 16:52:15,819 - lg_cotrain - INFO - Phase 2 epoch 1/7: loss1=0.6954, loss2=0.4945, dev_macro_f1=0.0800, dev_err=57.89%
2026-02-23 16:52:37,735 - lg_cotrain - INFO - Phase 2 epoch 2/7: loss1=0.1856, loss2=0.2360, dev_macro_f1=0.3454, dev_err=31.58%
2026-02-23 16:52:58,437 - lg_cotrain - INFO - Phase 2 epoch 3/7: loss1=0.0571, loss2=0.1413, dev_macro_f1=0.4725, dev_err=24.12%
2026-02-23 16:53:19,214 - lg_cotrain - INFO - Phase 2 epoch 4/7: loss1=0.0392, loss2=0.1914, dev_macro_f1=0.4652, dev_err=26.75%
2026-02-23 16:53:39,985 - lg_cotrain - INFO - Phase 2 epoch 5/7: loss1=0.0370, loss2=0.1110, dev_macro_f1=0.4867, dev_err=25.88%
2026-02-23 16:54:00,867 - lg_cotrain - INFO - Phase 2 epoch 6/7: loss1=0.0374, loss2=0.0952, dev_macro_f1=0.4777, dev_err=25.88%
2026-02-23 16:54:21,672 - lg_cotrain - INFO - Phase 2 epoch 7/7: loss1=0.0437, loss2=0.0802, dev_macro_f1=0.5306, dev_err=22.37%
2026-02-23 16:54:21,673 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 16:54:23,548 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.5050, dev_err=26.32%, es_counter1=0, es_counter2=0
2026-02-23 16:54:25,406 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.5458, dev_err=25.88%, es_counter1=0, es_counter2=0
2026-02-23 16:54:27,268 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.5567, dev_err=26.32%, es_counter1=0, es_counter2=0
2026-02-23 16:54:29,130 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.5780, dev_err=27.19%, es_counter1=0, es_counter2=0
2026-02-23 16:54:30,967 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.5518, dev_err=25.88%, es_counter1=1, es_counter2=1
2026-02-23 16:54:32,827 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.6392, dev_err=23.25%, es_counter1=0, es_counter2=0
2026-02-23 16:54:34,664 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.6080, dev_err=23.68%, es_counter1=1, es_counter2=1
2026-02-23 16:54:36,523 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.6306, dev_err=23.25%, es_counter1=2, es_counter2=2
2026-02-23 16:54:38,410 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.6472, dev_err=22.81%, es_counter1=0, es_counter2=0
2026-02-23 16:54:40,216 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.6242, dev_err=22.37%, es_counter1=1, es_counter2=1
2026-02-23 16:54:41,967 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.6145, dev_err=22.81%, es_counter1=2, es_counter2=2
2026-02-23 16:54:44,018 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.6081, dev_err=23.68%, es_counter1=3, es_counter2=3
2026-02-23 16:54:45,914 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.6081, dev_err=23.68%, es_counter1=4, es_counter2=4
2026-02-23 16:54:48,070 - lg_cotrain - INFO - Phase 3 epoch 14: dev_macro_f1=0.6153, dev_err=23.25%, es_counter1=5, es_counter2=5
2026-02-23 16:54:48,070 - lg_cotrain - INFO - Early stopping at epoch 14
2026-02-23 16:54:48,085 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 16:54:50,478 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpc_kywotf\canada_wildfires_2016\25_set1\metrics.json
2026-02-23 16:54:50,478 - lg_cotrain - INFO - Test error rate: 27.87%, Test macro-F1: 0.5614, Test ECE: 0.0727
2026-02-23 16:54:50,490 - lg_cotrain - INFO - --- Trial 1/10 done: dev_macro_f1=0.6472 ---
2026-02-23 16:54:50,490 - lg_cotrain - INFO - --- Trial 2/10 ---
2026-02-23 16:54:51,150 - lg_cotrain - INFO - Starting LG-CoTrain: event=canada_wildfires_2016, budget=25, seed_set=1
2026-02-23 16:54:51,163 - lg_cotrain - INFO - Detected 8 classes for event canada_wildfires_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 16:54:51,169 - lg_cotrain - INFO - D_l1: 98, D_l2: 91, D_LG: 1380
2026-02-23 16:54:51,170 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 16:54:57,848 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1065, mean_prob2=0.1041
2026-02-23 16:55:03,334 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1358, mean_prob2=0.1750
2026-02-23 16:55:08,829 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1381, mean_prob2=0.1318
2026-02-23 16:55:14,370 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1431, mean_prob2=0.1387
2026-02-23 16:55:19,855 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1428, mean_prob2=0.1403
2026-02-23 16:55:25,325 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1320, mean_prob2=0.1322
2026-02-23 16:55:30,798 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1379, mean_prob2=0.1263
2026-02-23 16:55:30,798 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 16:55:31,920 - lg_cotrain - INFO - LR scheduler: total_steps_1=420, warmup=60; total_steps_2=420, warmup=60
2026-02-23 16:55:31,920 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1379, range=[0.0524, 0.1592]
2026-02-23 16:55:31,920 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1263, range=[0.0759, 0.1596]
2026-02-23 16:55:49,809 - lg_cotrain - INFO - Phase 2 epoch 1/10: loss1=0.2126, loss2=0.2212, dev_macro_f1=0.3543, dev_err=32.46%
2026-02-23 16:56:07,806 - lg_cotrain - INFO - Phase 2 epoch 2/10: loss1=0.0699, loss2=0.1952, dev_macro_f1=0.4644, dev_err=24.12%
2026-02-23 16:56:26,931 - lg_cotrain - INFO - Phase 2 epoch 3/10: loss1=0.0534, loss2=0.3799, dev_macro_f1=0.2886, dev_err=45.18%
2026-02-23 16:56:45,611 - lg_cotrain - INFO - Phase 2 epoch 4/10: loss1=0.2445, loss2=0.7214, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:57:03,830 - lg_cotrain - INFO - Phase 2 epoch 5/10: loss1=0.1910, loss2=1.0468, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:57:22,878 - lg_cotrain - INFO - Phase 2 epoch 6/10: loss1=0.1293, loss2=0.9697, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:57:42,529 - lg_cotrain - INFO - Phase 2 epoch 7/10: loss1=0.0997, loss2=0.9047, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:58:02,049 - lg_cotrain - INFO - Phase 2 epoch 8/10: loss1=0.0835, loss2=0.8611, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:58:21,569 - lg_cotrain - INFO - Phase 2 epoch 9/10: loss1=0.0726, loss2=0.8308, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:58:41,033 - lg_cotrain - INFO - Phase 2 epoch 10/10: loss1=0.0674, loss2=0.8013, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:58:41,033 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 16:58:42,801 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.0735, dev_err=58.33%, es_counter1=0, es_counter2=0
2026-02-23 16:58:44,564 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.0247, dev_err=89.04%, es_counter1=1, es_counter2=1
2026-02-23 16:58:46,308 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.0085, dev_err=96.49%, es_counter1=2, es_counter2=2
2026-02-23 16:58:48,029 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.0115, dev_err=95.18%, es_counter1=3, es_counter2=3
2026-02-23 16:58:49,686 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.0115, dev_err=95.18%, es_counter1=4, es_counter2=4
2026-02-23 16:58:49,686 - lg_cotrain - INFO - Early stopping at epoch 5
2026-02-23 16:58:49,701 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 16:58:51,928 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpdimx7ke8\canada_wildfires_2016\25_set1\metrics.json
2026-02-23 16:58:51,928 - lg_cotrain - INFO - Test error rate: 58.20%, Test macro-F1: 0.0737, Test ECE: 0.1444
2026-02-23 16:58:51,938 - lg_cotrain - INFO - --- Trial 2/10 done: dev_macro_f1=0.0735 ---
2026-02-23 16:58:51,939 - lg_cotrain - INFO - --- Trial 3/10 ---
2026-02-23 16:58:52,525 - lg_cotrain - INFO - Starting LG-CoTrain: event=canada_wildfires_2016, budget=25, seed_set=1
2026-02-23 16:58:52,539 - lg_cotrain - INFO - Detected 8 classes for event canada_wildfires_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 16:58:52,544 - lg_cotrain - INFO - D_l1: 98, D_l2: 91, D_LG: 1380
2026-02-23 16:58:52,544 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 16:59:00,383 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1129, mean_prob2=0.1465
2026-02-23 16:59:07,366 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1228, mean_prob2=0.1491
2026-02-23 16:59:14,369 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1429, mean_prob2=0.1465
2026-02-23 16:59:21,426 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1614, mean_prob2=0.1567
2026-02-23 16:59:28,432 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1848, mean_prob2=0.1777
2026-02-23 16:59:35,612 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1858, mean_prob2=0.1920
2026-02-23 16:59:42,646 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.2225, mean_prob2=0.2062
2026-02-23 16:59:42,646 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 16:59:43,618 - lg_cotrain - INFO - LR scheduler: total_steps_1=4414, warmup=675; total_steps_2=4314, warmup=660
2026-02-23 16:59:43,618 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.2225, range=[0.0294, 0.4991]
2026-02-23 16:59:43,619 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.2062, range=[0.0149, 0.4966]
2026-02-23 17:00:09,276 - lg_cotrain - INFO - Phase 2 epoch 1/18: loss1=0.3875, loss2=0.4184, dev_macro_f1=0.1763, dev_err=47.37%
2026-02-23 17:00:35,108 - lg_cotrain - INFO - Phase 2 epoch 2/18: loss1=0.1795, loss2=0.2981, dev_macro_f1=0.2233, dev_err=43.86%
2026-02-23 17:01:01,594 - lg_cotrain - INFO - Phase 2 epoch 3/18: loss1=0.0755, loss2=0.1975, dev_macro_f1=0.3543, dev_err=31.14%
2026-02-23 17:01:27,369 - lg_cotrain - INFO - Phase 2 epoch 4/18: loss1=0.0408, loss2=0.1473, dev_macro_f1=0.4055, dev_err=28.07%
2026-02-23 17:01:54,048 - lg_cotrain - INFO - Phase 2 epoch 5/18: loss1=0.0264, loss2=0.0945, dev_macro_f1=0.4597, dev_err=25.00%
2026-02-23 17:02:20,923 - lg_cotrain - INFO - Phase 2 epoch 6/18: loss1=0.0180, loss2=0.0774, dev_macro_f1=0.5160, dev_err=21.93%
2026-02-23 17:02:47,487 - lg_cotrain - INFO - Phase 2 epoch 7/18: loss1=0.0110, loss2=0.0662, dev_macro_f1=0.5068, dev_err=24.12%
2026-02-23 17:03:13,815 - lg_cotrain - INFO - Phase 2 epoch 8/18: loss1=0.0094, loss2=0.0416, dev_macro_f1=0.5417, dev_err=22.81%
2026-02-23 17:03:40,190 - lg_cotrain - INFO - Phase 2 epoch 9/18: loss1=0.0077, loss2=0.0313, dev_macro_f1=0.5748, dev_err=20.61%
2026-02-23 17:04:06,370 - lg_cotrain - INFO - Phase 2 epoch 10/18: loss1=0.0272, loss2=0.0272, dev_macro_f1=0.5524, dev_err=22.81%
2026-02-23 17:04:33,026 - lg_cotrain - INFO - Phase 2 epoch 11/18: loss1=0.0114, loss2=0.0141, dev_macro_f1=0.5540, dev_err=22.81%
2026-02-23 17:04:59,806 - lg_cotrain - INFO - Phase 2 epoch 12/18: loss1=0.0114, loss2=0.0111, dev_macro_f1=0.5539, dev_err=22.37%
2026-02-23 17:05:26,353 - lg_cotrain - INFO - Phase 2 epoch 13/18: loss1=0.0070, loss2=0.0088, dev_macro_f1=0.5515, dev_err=23.25%
2026-02-23 17:05:53,049 - lg_cotrain - INFO - Phase 2 epoch 14/18: loss1=0.0101, loss2=0.0075, dev_macro_f1=0.5657, dev_err=22.81%
2026-02-23 17:06:19,493 - lg_cotrain - INFO - Phase 2 epoch 15/18: loss1=0.0076, loss2=0.0067, dev_macro_f1=0.5679, dev_err=22.37%
2026-02-23 17:06:46,141 - lg_cotrain - INFO - Phase 2 epoch 16/18: loss1=0.0092, loss2=0.0058, dev_macro_f1=0.5550, dev_err=22.81%
2026-02-23 17:07:11,920 - lg_cotrain - INFO - Phase 2 epoch 17/18: loss1=0.0080, loss2=0.0052, dev_macro_f1=0.5540, dev_err=22.81%
2026-02-23 17:07:38,469 - lg_cotrain - INFO - Phase 2 epoch 18/18: loss1=0.0060, loss2=0.0045, dev_macro_f1=0.5662, dev_err=22.81%
2026-02-23 17:07:38,470 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 17:07:40,859 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.5452, dev_err=24.12%, es_counter1=0, es_counter2=0
2026-02-23 17:07:43,296 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.5615, dev_err=24.12%, es_counter1=0, es_counter2=0
2026-02-23 17:07:45,711 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.6019, dev_err=20.18%, es_counter1=0, es_counter2=0
2026-02-23 17:07:48,086 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.5751, dev_err=21.49%, es_counter1=1, es_counter2=1
2026-02-23 17:07:50,474 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.5561, dev_err=22.81%, es_counter1=2, es_counter2=2
2026-02-23 17:07:52,886 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.5419, dev_err=24.12%, es_counter1=3, es_counter2=3
2026-02-23 17:07:55,393 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.5540, dev_err=23.25%, es_counter1=4, es_counter2=4
2026-02-23 17:07:57,918 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.5745, dev_err=21.93%, es_counter1=5, es_counter2=5
2026-02-23 17:08:00,404 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.5751, dev_err=21.93%, es_counter1=6, es_counter2=6
2026-02-23 17:08:02,916 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.6614, dev_err=21.49%, es_counter1=0, es_counter2=0
2026-02-23 17:08:05,396 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.6614, dev_err=21.49%, es_counter1=1, es_counter2=1
2026-02-23 17:08:07,879 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.6818, dev_err=21.05%, es_counter1=0, es_counter2=0
2026-02-23 17:08:10,377 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.6751, dev_err=21.49%, es_counter1=1, es_counter2=1
2026-02-23 17:08:12,877 - lg_cotrain - INFO - Phase 3 epoch 14: dev_macro_f1=0.6751, dev_err=21.49%, es_counter1=2, es_counter2=2
2026-02-23 17:08:15,363 - lg_cotrain - INFO - Phase 3 epoch 15: dev_macro_f1=0.6691, dev_err=21.93%, es_counter1=3, es_counter2=3
2026-02-23 17:08:17,824 - lg_cotrain - INFO - Phase 3 epoch 16: dev_macro_f1=0.6508, dev_err=21.49%, es_counter1=4, es_counter2=4
2026-02-23 17:08:20,279 - lg_cotrain - INFO - Phase 3 epoch 17: dev_macro_f1=0.6448, dev_err=21.93%, es_counter1=5, es_counter2=5
2026-02-23 17:08:22,802 - lg_cotrain - INFO - Phase 3 epoch 18: dev_macro_f1=0.6448, dev_err=21.93%, es_counter1=6, es_counter2=6
2026-02-23 17:08:25,309 - lg_cotrain - INFO - Phase 3 epoch 19: dev_macro_f1=0.6448, dev_err=21.93%, es_counter1=7, es_counter2=7
2026-02-23 17:08:27,801 - lg_cotrain - INFO - Phase 3 epoch 20: dev_macro_f1=0.6508, dev_err=21.49%, es_counter1=8, es_counter2=8
2026-02-23 17:08:27,802 - lg_cotrain - INFO - Early stopping at epoch 20
2026-02-23 17:08:27,814 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 17:08:30,685 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpgyrk23ln\canada_wildfires_2016\25_set1\metrics.json
2026-02-23 17:08:30,685 - lg_cotrain - INFO - Test error rate: 23.82%, Test macro-F1: 0.5590, Test ECE: 0.1209
2026-02-23 17:08:30,698 - lg_cotrain - INFO - --- Trial 3/10 done: dev_macro_f1=0.6818 ---
2026-02-23 17:08:30,698 - lg_cotrain - INFO - --- Trial 4/10 ---
2026-02-23 17:08:31,309 - lg_cotrain - INFO - Starting LG-CoTrain: event=canada_wildfires_2016, budget=25, seed_set=1
2026-02-23 17:08:31,321 - lg_cotrain - INFO - Detected 8 classes for event canada_wildfires_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 17:08:31,326 - lg_cotrain - INFO - D_l1: 98, D_l2: 91, D_LG: 1380
2026-02-23 17:08:31,326 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 17:08:38,889 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1075, mean_prob2=0.1346
2026-02-23 17:08:45,380 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1132, mean_prob2=0.1413
2026-02-23 17:08:51,789 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1218, mean_prob2=0.1474
2026-02-23 17:08:58,194 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1373, mean_prob2=0.1512
2026-02-23 17:09:04,780 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1658, mean_prob2=0.1540
2026-02-23 17:09:11,174 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1809, mean_prob2=0.1580
2026-02-23 17:09:17,468 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1707, mean_prob2=0.1635
2026-02-23 17:09:17,468 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 17:09:18,488 - lg_cotrain - INFO - LR scheduler: total_steps_1=752, warmup=106; total_steps_2=652, warmup=92
2026-02-23 17:09:18,489 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1707, range=[0.0561, 0.3282]
2026-02-23 17:09:18,489 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1635, range=[0.0252, 0.3939]
2026-02-23 17:09:39,671 - lg_cotrain - INFO - Phase 2 epoch 1/8: loss1=0.3206, loss2=0.3327, dev_macro_f1=0.0917, dev_err=57.46%
2026-02-23 17:10:01,592 - lg_cotrain - INFO - Phase 2 epoch 2/8: loss1=0.1629, loss2=0.2511, dev_macro_f1=0.2832, dev_err=38.16%
2026-02-23 17:10:23,523 - lg_cotrain - INFO - Phase 2 epoch 3/8: loss1=0.0821, loss2=0.1785, dev_macro_f1=0.3588, dev_err=31.14%
2026-02-23 17:10:45,215 - lg_cotrain - INFO - Phase 2 epoch 4/8: loss1=0.0440, loss2=0.1093, dev_macro_f1=0.4436, dev_err=24.56%
2026-02-23 17:11:06,917 - lg_cotrain - INFO - Phase 2 epoch 5/8: loss1=0.0288, loss2=0.0931, dev_macro_f1=0.4163, dev_err=26.75%
2026-02-23 17:11:28,544 - lg_cotrain - INFO - Phase 2 epoch 6/8: loss1=0.0239, loss2=0.0694, dev_macro_f1=0.5061, dev_err=22.37%
2026-02-23 17:11:50,394 - lg_cotrain - INFO - Phase 2 epoch 7/8: loss1=0.0179, loss2=0.0509, dev_macro_f1=0.4988, dev_err=23.68%
2026-02-23 17:12:12,280 - lg_cotrain - INFO - Phase 2 epoch 8/8: loss1=0.0123, loss2=0.0442, dev_macro_f1=0.4991, dev_err=25.44%
2026-02-23 17:12:12,280 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 17:12:14,264 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.4975, dev_err=27.19%, es_counter1=0, es_counter2=0
2026-02-23 17:12:16,241 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.5105, dev_err=29.82%, es_counter1=0, es_counter2=0
2026-02-23 17:12:18,162 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.5413, dev_err=25.44%, es_counter1=0, es_counter2=0
2026-02-23 17:12:20,071 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.5456, dev_err=24.56%, es_counter1=0, es_counter2=0
2026-02-23 17:12:21,916 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.5593, dev_err=22.81%, es_counter1=0, es_counter2=0
2026-02-23 17:12:23,668 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.5489, dev_err=23.25%, es_counter1=1, es_counter2=1
2026-02-23 17:12:25,443 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.6506, dev_err=21.93%, es_counter1=0, es_counter2=0
2026-02-23 17:12:27,239 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.6724, dev_err=20.61%, es_counter1=0, es_counter2=0
2026-02-23 17:12:29,009 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.6766, dev_err=20.61%, es_counter1=0, es_counter2=0
2026-02-23 17:12:30,781 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.7121, dev_err=20.61%, es_counter1=0, es_counter2=0
2026-02-23 17:12:32,522 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.7039, dev_err=21.49%, es_counter1=1, es_counter2=1
2026-02-23 17:12:34,270 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.6953, dev_err=21.05%, es_counter1=2, es_counter2=2
2026-02-23 17:12:36,017 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.6961, dev_err=20.61%, es_counter1=3, es_counter2=3
2026-02-23 17:12:37,768 - lg_cotrain - INFO - Phase 3 epoch 14: dev_macro_f1=0.6938, dev_err=20.18%, es_counter1=4, es_counter2=4
2026-02-23 17:12:39,509 - lg_cotrain - INFO - Phase 3 epoch 15: dev_macro_f1=0.6750, dev_err=21.49%, es_counter1=5, es_counter2=5
2026-02-23 17:12:41,270 - lg_cotrain - INFO - Phase 3 epoch 16: dev_macro_f1=0.6645, dev_err=21.93%, es_counter1=6, es_counter2=6
2026-02-23 17:12:43,017 - lg_cotrain - INFO - Phase 3 epoch 17: dev_macro_f1=0.6521, dev_err=21.49%, es_counter1=7, es_counter2=7
2026-02-23 17:12:44,764 - lg_cotrain - INFO - Phase 3 epoch 18: dev_macro_f1=0.6696, dev_err=20.61%, es_counter1=8, es_counter2=8
2026-02-23 17:12:46,521 - lg_cotrain - INFO - Phase 3 epoch 19: dev_macro_f1=0.6715, dev_err=20.18%, es_counter1=9, es_counter2=9
2026-02-23 17:12:48,283 - lg_cotrain - INFO - Phase 3 epoch 20: dev_macro_f1=0.6634, dev_err=20.61%, es_counter1=10, es_counter2=10
2026-02-23 17:12:48,283 - lg_cotrain - INFO - Early stopping at epoch 20
2026-02-23 17:12:48,295 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 17:12:50,578 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmp_w6ji96e\canada_wildfires_2016\25_set1\metrics.json
2026-02-23 17:12:50,578 - lg_cotrain - INFO - Test error rate: 22.70%, Test macro-F1: 0.6182, Test ECE: 0.0529
2026-02-23 17:12:50,590 - lg_cotrain - INFO - --- Trial 4/10 done: dev_macro_f1=0.7121 ---
2026-02-23 17:12:50,590 - lg_cotrain - INFO - --- Trial 5/10 ---
2026-02-23 17:12:51,191 - lg_cotrain - INFO - Starting LG-CoTrain: event=canada_wildfires_2016, budget=25, seed_set=1
2026-02-23 17:12:51,203 - lg_cotrain - INFO - Detected 8 classes for event canada_wildfires_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 17:12:51,207 - lg_cotrain - INFO - D_l1: 98, D_l2: 91, D_LG: 1380
2026-02-23 17:12:51,208 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 17:12:59,216 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1180, mean_prob2=0.1472
2026-02-23 17:13:06,173 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1263, mean_prob2=0.1508
2026-02-23 17:13:13,158 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1363, mean_prob2=0.1482
2026-02-23 17:13:20,118 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1360, mean_prob2=0.1593
2026-02-23 17:13:27,079 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1859, mean_prob2=0.1873
2026-02-23 17:13:34,087 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1830, mean_prob2=0.2019
2026-02-23 17:13:41,044 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.2080, mean_prob2=0.2192
2026-02-23 17:13:41,044 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 17:13:42,055 - lg_cotrain - INFO - LR scheduler: total_steps_1=2165, warmup=508; total_steps_2=2065, warmup=484
2026-02-23 17:13:42,056 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.2080, range=[0.0261, 0.4686]
2026-02-23 17:13:42,056 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.2192, range=[0.0151, 0.5510]
2026-02-23 17:14:07,900 - lg_cotrain - INFO - Phase 2 epoch 1/5: loss1=0.3911, loss2=0.3708, dev_macro_f1=0.1522, dev_err=47.37%
2026-02-23 17:14:33,692 - lg_cotrain - INFO - Phase 2 epoch 2/5: loss1=0.1602, loss2=0.2643, dev_macro_f1=0.3263, dev_err=35.09%
2026-02-23 17:14:59,505 - lg_cotrain - INFO - Phase 2 epoch 3/5: loss1=0.0650, loss2=0.1776, dev_macro_f1=0.3564, dev_err=30.26%
2026-02-23 17:15:25,212 - lg_cotrain - INFO - Phase 2 epoch 4/5: loss1=0.0363, loss2=0.1105, dev_macro_f1=0.4876, dev_err=26.32%
2026-02-23 17:15:50,991 - lg_cotrain - INFO - Phase 2 epoch 5/5: loss1=0.0232, loss2=0.0714, dev_macro_f1=0.4983, dev_err=23.68%
2026-02-23 17:15:50,991 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 17:15:53,244 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.5429, dev_err=26.32%, es_counter1=0, es_counter2=0
2026-02-23 17:15:55,528 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.5449, dev_err=25.44%, es_counter1=0, es_counter2=0
2026-02-23 17:15:57,791 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.5788, dev_err=21.93%, es_counter1=0, es_counter2=0
2026-02-23 17:16:00,050 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.5873, dev_err=21.93%, es_counter1=0, es_counter2=0
2026-02-23 17:16:02,303 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.5771, dev_err=22.81%, es_counter1=1, es_counter2=1
2026-02-23 17:16:04,551 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.6913, dev_err=21.49%, es_counter1=0, es_counter2=0
2026-02-23 17:16:06,787 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.6845, dev_err=21.93%, es_counter1=1, es_counter2=1
2026-02-23 17:16:09,045 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.6959, dev_err=21.05%, es_counter1=0, es_counter2=0
2026-02-23 17:16:11,312 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.6785, dev_err=21.49%, es_counter1=1, es_counter2=1
2026-02-23 17:16:13,555 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.6647, dev_err=21.93%, es_counter1=2, es_counter2=2
2026-02-23 17:16:15,797 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.6771, dev_err=21.49%, es_counter1=3, es_counter2=3
2026-02-23 17:16:18,043 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.6898, dev_err=21.49%, es_counter1=4, es_counter2=4
2026-02-23 17:16:20,291 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.6898, dev_err=21.49%, es_counter1=5, es_counter2=5
2026-02-23 17:16:20,291 - lg_cotrain - INFO - Early stopping at epoch 13
2026-02-23 17:16:20,304 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 17:16:22,914 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpa_z1r2ph\canada_wildfires_2016\25_set1\metrics.json
2026-02-23 17:16:22,914 - lg_cotrain - INFO - Test error rate: 22.47%, Test macro-F1: 0.6061, Test ECE: 0.0678
2026-02-23 17:16:22,922 - lg_cotrain - INFO - --- Trial 5/10 done: dev_macro_f1=0.6959 ---
2026-02-23 17:16:22,923 - lg_cotrain - INFO - --- Trial 6/10 ---
2026-02-23 17:16:23,520 - lg_cotrain - INFO - Starting LG-CoTrain: event=canada_wildfires_2016, budget=25, seed_set=1
2026-02-23 17:16:23,534 - lg_cotrain - INFO - Detected 8 classes for event canada_wildfires_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 17:16:23,540 - lg_cotrain - INFO - D_l1: 98, D_l2: 91, D_LG: 1380
2026-02-23 17:16:23,541 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 17:16:30,654 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1090, mean_prob2=0.1414
2026-02-23 17:16:36,473 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1163, mean_prob2=0.1471
2026-02-23 17:16:42,303 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1238, mean_prob2=0.1528
2026-02-23 17:16:48,161 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1471, mean_prob2=0.1572
2026-02-23 17:16:54,250 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1781, mean_prob2=0.1699
2026-02-23 17:17:00,267 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1604, mean_prob2=0.1906
2026-02-23 17:17:06,378 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1848, mean_prob2=0.2039
2026-02-23 17:17:06,378 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 17:17:07,443 - lg_cotrain - INFO - LR scheduler: total_steps_1=1060, warmup=95; total_steps_2=960, warmup=86
2026-02-23 17:17:07,444 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1848, range=[0.0523, 0.4364]
2026-02-23 17:17:07,444 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.2039, range=[0.0186, 0.4594]
2026-02-23 17:17:28,173 - lg_cotrain - INFO - Phase 2 epoch 1/15: loss1=0.3752, loss2=0.3500, dev_macro_f1=0.1575, dev_err=46.49%
2026-02-23 17:17:50,000 - lg_cotrain - INFO - Phase 2 epoch 2/15: loss1=0.1512, loss2=0.2633, dev_macro_f1=0.3502, dev_err=32.89%
2026-02-23 17:18:11,906 - lg_cotrain - INFO - Phase 2 epoch 3/15: loss1=0.0559, loss2=0.1520, dev_macro_f1=0.4269, dev_err=25.88%
2026-02-23 17:18:33,599 - lg_cotrain - INFO - Phase 2 epoch 4/15: loss1=0.0286, loss2=0.1150, dev_macro_f1=0.5020, dev_err=22.37%
2026-02-23 17:18:55,437 - lg_cotrain - INFO - Phase 2 epoch 5/15: loss1=0.0227, loss2=0.0857, dev_macro_f1=0.4807, dev_err=24.12%
2026-02-23 17:19:16,890 - lg_cotrain - INFO - Phase 2 epoch 6/15: loss1=0.0259, loss2=0.0726, dev_macro_f1=0.5145, dev_err=24.12%
2026-02-23 17:19:37,678 - lg_cotrain - INFO - Phase 2 epoch 7/15: loss1=0.0212, loss2=0.0481, dev_macro_f1=0.4957, dev_err=25.44%
2026-02-23 17:19:58,840 - lg_cotrain - INFO - Phase 2 epoch 8/15: loss1=0.0112, loss2=0.0304, dev_macro_f1=0.5540, dev_err=22.81%
2026-02-23 17:20:19,216 - lg_cotrain - INFO - Phase 2 epoch 9/15: loss1=0.0072, loss2=0.0166, dev_macro_f1=0.5583, dev_err=21.49%
2026-02-23 17:20:40,062 - lg_cotrain - INFO - Phase 2 epoch 10/15: loss1=0.0115, loss2=0.0107, dev_macro_f1=0.5364, dev_err=24.12%
2026-02-23 17:21:01,936 - lg_cotrain - INFO - Phase 2 epoch 11/15: loss1=0.0277, loss2=0.0083, dev_macro_f1=0.5387, dev_err=22.81%
2026-02-23 17:21:23,145 - lg_cotrain - INFO - Phase 2 epoch 12/15: loss1=0.0140, loss2=0.0070, dev_macro_f1=0.5566, dev_err=22.37%
2026-02-23 17:21:44,189 - lg_cotrain - INFO - Phase 2 epoch 13/15: loss1=0.0086, loss2=0.0058, dev_macro_f1=0.5881, dev_err=20.61%
2026-02-23 17:22:05,643 - lg_cotrain - INFO - Phase 2 epoch 14/15: loss1=0.0051, loss2=0.0052, dev_macro_f1=0.5568, dev_err=23.25%
2026-02-23 17:22:27,090 - lg_cotrain - INFO - Phase 2 epoch 15/15: loss1=0.0045, loss2=0.0051, dev_macro_f1=0.5644, dev_err=22.81%
2026-02-23 17:22:27,091 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 17:22:29,071 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.5442, dev_err=25.00%, es_counter1=0, es_counter2=0
2026-02-23 17:22:31,008 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.5319, dev_err=27.19%, es_counter1=1, es_counter2=1
2026-02-23 17:22:32,982 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.5570, dev_err=25.00%, es_counter1=0, es_counter2=0
2026-02-23 17:22:34,906 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.5504, dev_err=25.44%, es_counter1=1, es_counter2=1
2026-02-23 17:22:36,762 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.5777, dev_err=23.25%, es_counter1=0, es_counter2=0
2026-02-23 17:22:38,585 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.5703, dev_err=24.12%, es_counter1=1, es_counter2=1
2026-02-23 17:22:40,414 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.5618, dev_err=24.56%, es_counter1=2, es_counter2=2
2026-02-23 17:22:42,239 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.5623, dev_err=24.56%, es_counter1=3, es_counter2=3
2026-02-23 17:22:44,174 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.6438, dev_err=24.12%, es_counter1=0, es_counter2=0
2026-02-23 17:22:46,132 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.6573, dev_err=22.81%, es_counter1=0, es_counter2=0
2026-02-23 17:22:47,957 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.6449, dev_err=23.25%, es_counter1=1, es_counter2=1
2026-02-23 17:22:49,823 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.6514, dev_err=22.81%, es_counter1=2, es_counter2=2
2026-02-23 17:22:51,763 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.6434, dev_err=23.25%, es_counter1=3, es_counter2=3
2026-02-23 17:22:53,748 - lg_cotrain - INFO - Phase 3 epoch 14: dev_macro_f1=0.6453, dev_err=22.81%, es_counter1=4, es_counter2=4
2026-02-23 17:22:55,645 - lg_cotrain - INFO - Phase 3 epoch 15: dev_macro_f1=0.6530, dev_err=22.37%, es_counter1=5, es_counter2=5
2026-02-23 17:22:55,645 - lg_cotrain - INFO - Early stopping at epoch 15
2026-02-23 17:22:55,653 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 17:22:58,164 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpwtwpvm7o\canada_wildfires_2016\25_set1\metrics.json
2026-02-23 17:22:58,165 - lg_cotrain - INFO - Test error rate: 24.72%, Test macro-F1: 0.5839, Test ECE: 0.0851
2026-02-23 17:22:58,178 - lg_cotrain - INFO - --- Trial 6/10 done: dev_macro_f1=0.6573 ---
2026-02-23 17:22:58,178 - lg_cotrain - INFO - --- Trial 7/10 ---
2026-02-23 17:22:58,746 - lg_cotrain - INFO - Starting LG-CoTrain: event=canada_wildfires_2016, budget=25, seed_set=1
2026-02-23 17:22:58,759 - lg_cotrain - INFO - Detected 8 classes for event canada_wildfires_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 17:22:58,765 - lg_cotrain - INFO - D_l1: 98, D_l2: 91, D_LG: 1380
2026-02-23 17:22:58,766 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 17:23:05,589 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1124, mean_prob2=0.1265
2026-02-23 17:23:11,553 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1379, mean_prob2=0.1318
2026-02-23 17:23:17,593 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1651, mean_prob2=0.1433
2026-02-23 17:23:23,660 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1713, mean_prob2=0.1517
2026-02-23 17:23:29,699 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1733, mean_prob2=0.1583
2026-02-23 17:23:35,740 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1815, mean_prob2=0.1546
2026-02-23 17:23:41,821 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1987, mean_prob2=0.1592
2026-02-23 17:23:41,821 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 17:23:42,862 - lg_cotrain - INFO - LR scheduler: total_steps_1=530, warmup=3; total_steps_2=530, warmup=3
2026-02-23 17:23:42,862 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1987, range=[0.0410, 0.3915]
2026-02-23 17:23:42,862 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1592, range=[0.0385, 0.4344]
2026-02-23 17:24:02,561 - lg_cotrain - INFO - Phase 2 epoch 1/15: loss1=0.2773, loss2=0.3162, dev_macro_f1=0.1608, dev_err=45.61%
2026-02-23 17:24:21,574 - lg_cotrain - INFO - Phase 2 epoch 2/15: loss1=0.1091, loss2=0.2337, dev_macro_f1=0.3376, dev_err=33.33%
2026-02-23 17:24:40,557 - lg_cotrain - INFO - Phase 2 epoch 3/15: loss1=0.0624, loss2=0.1589, dev_macro_f1=0.3851, dev_err=28.51%
2026-02-23 17:24:59,215 - lg_cotrain - INFO - Phase 2 epoch 4/15: loss1=0.0417, loss2=0.1142, dev_macro_f1=0.4748, dev_err=23.25%
2026-02-23 17:25:18,148 - lg_cotrain - INFO - Phase 2 epoch 5/15: loss1=0.0255, loss2=0.0779, dev_macro_f1=0.4649, dev_err=24.56%
2026-02-23 17:25:37,036 - lg_cotrain - INFO - Phase 2 epoch 6/15: loss1=0.0187, loss2=0.0663, dev_macro_f1=0.4829, dev_err=24.56%
2026-02-23 17:25:55,153 - lg_cotrain - INFO - Phase 2 epoch 7/15: loss1=0.0144, loss2=0.0682, dev_macro_f1=0.4857, dev_err=23.68%
2026-02-23 17:26:13,880 - lg_cotrain - INFO - Phase 2 epoch 8/15: loss1=0.0194, loss2=0.0646, dev_macro_f1=0.4718, dev_err=25.00%
2026-02-23 17:26:32,689 - lg_cotrain - INFO - Phase 2 epoch 9/15: loss1=0.0177, loss2=0.0451, dev_macro_f1=0.5085, dev_err=22.81%
2026-02-23 17:26:51,319 - lg_cotrain - INFO - Phase 2 epoch 10/15: loss1=0.0147, loss2=0.0284, dev_macro_f1=0.5102, dev_err=22.37%
2026-02-23 17:27:09,788 - lg_cotrain - INFO - Phase 2 epoch 11/15: loss1=0.0271, loss2=0.0215, dev_macro_f1=0.5249, dev_err=22.37%
2026-02-23 17:27:28,107 - lg_cotrain - INFO - Phase 2 epoch 12/15: loss1=0.0153, loss2=0.0162, dev_macro_f1=0.5193, dev_err=22.37%
2026-02-23 17:27:46,320 - lg_cotrain - INFO - Phase 2 epoch 13/15: loss1=0.0104, loss2=0.0141, dev_macro_f1=0.5238, dev_err=23.68%
2026-02-23 17:28:04,728 - lg_cotrain - INFO - Phase 2 epoch 14/15: loss1=0.0091, loss2=0.0122, dev_macro_f1=0.5478, dev_err=22.37%
2026-02-23 17:28:22,741 - lg_cotrain - INFO - Phase 2 epoch 15/15: loss1=0.0093, loss2=0.0101, dev_macro_f1=0.5401, dev_err=23.25%
2026-02-23 17:28:22,741 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 17:28:24,384 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.5329, dev_err=25.00%, es_counter1=0, es_counter2=0
2026-02-23 17:28:26,016 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.5308, dev_err=26.75%, es_counter1=1, es_counter2=1
2026-02-23 17:28:27,661 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.5241, dev_err=27.19%, es_counter1=2, es_counter2=2
2026-02-23 17:28:29,293 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.5391, dev_err=26.32%, es_counter1=0, es_counter2=0
2026-02-23 17:28:30,918 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.5497, dev_err=24.56%, es_counter1=0, es_counter2=0
2026-02-23 17:28:32,517 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.5378, dev_err=25.44%, es_counter1=1, es_counter2=1
2026-02-23 17:28:34,122 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.5412, dev_err=25.00%, es_counter1=2, es_counter2=2
2026-02-23 17:28:35,762 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.5510, dev_err=23.68%, es_counter1=0, es_counter2=0
2026-02-23 17:28:37,397 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.5734, dev_err=21.93%, es_counter1=0, es_counter2=0
2026-02-23 17:28:39,026 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.5741, dev_err=21.93%, es_counter1=0, es_counter2=0
2026-02-23 17:28:40,669 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.5803, dev_err=21.49%, es_counter1=0, es_counter2=0
2026-02-23 17:28:42,275 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.5803, dev_err=21.49%, es_counter1=1, es_counter2=1
2026-02-23 17:28:43,909 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.6660, dev_err=21.93%, es_counter1=0, es_counter2=0
2026-02-23 17:28:45,526 - lg_cotrain - INFO - Phase 3 epoch 14: dev_macro_f1=0.6506, dev_err=21.93%, es_counter1=1, es_counter2=1
2026-02-23 17:28:47,170 - lg_cotrain - INFO - Phase 3 epoch 15: dev_macro_f1=0.7014, dev_err=21.05%, es_counter1=0, es_counter2=0
2026-02-23 17:28:48,793 - lg_cotrain - INFO - Phase 3 epoch 16: dev_macro_f1=0.6889, dev_err=21.05%, es_counter1=1, es_counter2=1
2026-02-23 17:28:50,414 - lg_cotrain - INFO - Phase 3 epoch 17: dev_macro_f1=0.6879, dev_err=21.93%, es_counter1=2, es_counter2=2
2026-02-23 17:28:52,031 - lg_cotrain - INFO - Phase 3 epoch 18: dev_macro_f1=0.6840, dev_err=22.37%, es_counter1=3, es_counter2=3
2026-02-23 17:28:53,652 - lg_cotrain - INFO - Phase 3 epoch 19: dev_macro_f1=0.6821, dev_err=21.49%, es_counter1=4, es_counter2=4
2026-02-23 17:28:55,270 - lg_cotrain - INFO - Phase 3 epoch 20: dev_macro_f1=0.6877, dev_err=21.05%, es_counter1=5, es_counter2=5
2026-02-23 17:28:56,886 - lg_cotrain - INFO - Phase 3 epoch 21: dev_macro_f1=0.6948, dev_err=21.05%, es_counter1=6, es_counter2=6
2026-02-23 17:28:58,500 - lg_cotrain - INFO - Phase 3 epoch 22: dev_macro_f1=0.6795, dev_err=20.61%, es_counter1=7, es_counter2=7
2026-02-23 17:29:00,113 - lg_cotrain - INFO - Phase 3 epoch 23: dev_macro_f1=0.6864, dev_err=19.74%, es_counter1=8, es_counter2=8
2026-02-23 17:29:01,742 - lg_cotrain - INFO - Phase 3 epoch 24: dev_macro_f1=0.6773, dev_err=20.61%, es_counter1=9, es_counter2=9
2026-02-23 17:29:01,743 - lg_cotrain - INFO - Early stopping at epoch 24
2026-02-23 17:29:01,757 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 17:29:03,928 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpbufdygdd\canada_wildfires_2016\25_set1\metrics.json
2026-02-23 17:29:03,928 - lg_cotrain - INFO - Test error rate: 23.37%, Test macro-F1: 0.6056, Test ECE: 0.0840
2026-02-23 17:29:03,938 - lg_cotrain - INFO - --- Trial 7/10 done: dev_macro_f1=0.7014 ---
2026-02-23 17:29:03,938 - lg_cotrain - INFO - --- Trial 8/10 ---
2026-02-23 17:29:04,528 - lg_cotrain - INFO - Starting LG-CoTrain: event=canada_wildfires_2016, budget=25, seed_set=1
2026-02-23 17:29:04,540 - lg_cotrain - INFO - Detected 8 classes for event canada_wildfires_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 17:29:04,544 - lg_cotrain - INFO - D_l1: 98, D_l2: 91, D_LG: 1380
2026-02-23 17:29:04,544 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 17:29:11,029 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1213, mean_prob2=0.1211
2026-02-23 17:29:16,535 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1205, mean_prob2=0.1315
2026-02-23 17:29:22,064 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1386, mean_prob2=0.1387
2026-02-23 17:29:27,642 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1346, mean_prob2=0.1989
2026-02-23 17:29:33,244 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1495, mean_prob2=0.1230
2026-02-23 17:29:38,817 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1726, mean_prob2=0.1389
2026-02-23 17:29:44,352 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.2075, mean_prob2=0.1837
2026-02-23 17:29:44,352 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 17:29:45,379 - lg_cotrain - INFO - LR scheduler: total_steps_1=464, warmup=13; total_steps_2=464, warmup=13
2026-02-23 17:29:45,380 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.2075, range=[0.0272, 0.5567]
2026-02-23 17:29:45,380 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1837, range=[0.0215, 0.3968]
2026-02-23 17:30:03,342 - lg_cotrain - INFO - Phase 2 epoch 1/12: loss1=0.2571, loss2=0.2868, dev_macro_f1=0.3493, dev_err=33.77%
2026-02-23 17:30:21,429 - lg_cotrain - INFO - Phase 2 epoch 2/12: loss1=0.0864, loss2=0.1868, dev_macro_f1=0.4891, dev_err=24.56%
2026-02-23 17:30:39,600 - lg_cotrain - INFO - Phase 2 epoch 3/12: loss1=0.0461, loss2=0.2266, dev_macro_f1=0.5003, dev_err=23.25%
2026-02-23 17:30:57,649 - lg_cotrain - INFO - Phase 2 epoch 4/12: loss1=0.0423, loss2=0.1810, dev_macro_f1=0.4925, dev_err=24.56%
2026-02-23 17:31:15,955 - lg_cotrain - INFO - Phase 2 epoch 5/12: loss1=0.0579, loss2=0.1606, dev_macro_f1=0.4551, dev_err=26.75%
2026-02-23 17:31:34,035 - lg_cotrain - INFO - Phase 2 epoch 6/12: loss1=0.0277, loss2=0.2101, dev_macro_f1=0.4779, dev_err=25.88%
2026-02-23 17:31:52,229 - lg_cotrain - INFO - Phase 2 epoch 7/12: loss1=0.0227, loss2=0.1163, dev_macro_f1=0.4794, dev_err=25.88%
2026-02-23 17:32:10,482 - lg_cotrain - INFO - Phase 2 epoch 8/12: loss1=0.0264, loss2=0.1638, dev_macro_f1=0.5178, dev_err=23.68%
2026-02-23 17:32:28,568 - lg_cotrain - INFO - Phase 2 epoch 9/12: loss1=0.0457, loss2=0.0943, dev_macro_f1=0.5181, dev_err=23.68%
2026-02-23 17:32:46,566 - lg_cotrain - INFO - Phase 2 epoch 10/12: loss1=0.0492, loss2=0.0892, dev_macro_f1=0.5001, dev_err=25.00%
2026-02-23 17:33:04,567 - lg_cotrain - INFO - Phase 2 epoch 11/12: loss1=0.0801, loss2=0.0752, dev_macro_f1=0.5118, dev_err=23.25%
2026-02-23 17:33:22,590 - lg_cotrain - INFO - Phase 2 epoch 12/12: loss1=0.0671, loss2=0.0392, dev_macro_f1=0.5786, dev_err=20.61%
2026-02-23 17:33:22,590 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 17:33:24,224 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.5465, dev_err=22.81%, es_counter1=0, es_counter2=0
2026-02-23 17:33:25,836 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.5100, dev_err=27.19%, es_counter1=1, es_counter2=1
2026-02-23 17:33:27,540 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.5119, dev_err=26.75%, es_counter1=2, es_counter2=2
2026-02-23 17:33:29,184 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.5528, dev_err=24.12%, es_counter1=0, es_counter2=0
2026-02-23 17:33:30,839 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.5705, dev_err=23.68%, es_counter1=0, es_counter2=0
2026-02-23 17:33:32,497 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.5732, dev_err=23.25%, es_counter1=0, es_counter2=0
2026-02-23 17:33:34,142 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.5888, dev_err=22.81%, es_counter1=0, es_counter2=0
2026-02-23 17:33:35,745 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.5872, dev_err=22.37%, es_counter1=1, es_counter2=1
2026-02-23 17:33:37,380 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.6497, dev_err=21.93%, es_counter1=0, es_counter2=0
2026-02-23 17:33:38,985 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.5970, dev_err=21.05%, es_counter1=1, es_counter2=1
2026-02-23 17:33:40,597 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.6005, dev_err=20.61%, es_counter1=2, es_counter2=2
2026-02-23 17:33:42,206 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.6267, dev_err=21.05%, es_counter1=3, es_counter2=3
2026-02-23 17:33:43,813 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.6015, dev_err=21.49%, es_counter1=4, es_counter2=4
2026-02-23 17:33:45,414 - lg_cotrain - INFO - Phase 3 epoch 14: dev_macro_f1=0.5678, dev_err=26.32%, es_counter1=5, es_counter2=5
2026-02-23 17:33:45,414 - lg_cotrain - INFO - Early stopping at epoch 14
2026-02-23 17:33:45,425 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 17:33:47,587 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpx_t66fpc\canada_wildfires_2016\25_set1\metrics.json
2026-02-23 17:33:47,588 - lg_cotrain - INFO - Test error rate: 28.54%, Test macro-F1: 0.5320, Test ECE: 0.0527
2026-02-23 17:33:47,599 - lg_cotrain - INFO - --- Trial 8/10 done: dev_macro_f1=0.6497 ---
2026-02-23 17:33:47,599 - lg_cotrain - INFO - --- Trial 9/10 ---
2026-02-23 17:33:48,170 - lg_cotrain - INFO - Starting LG-CoTrain: event=canada_wildfires_2016, budget=25, seed_set=1
2026-02-23 17:33:48,185 - lg_cotrain - INFO - Detected 8 classes for event canada_wildfires_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 17:33:48,189 - lg_cotrain - INFO - D_l1: 98, D_l2: 91, D_LG: 1380
2026-02-23 17:33:48,190 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 17:33:54,697 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1081, mean_prob2=0.1400
2026-02-23 17:34:00,202 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1179, mean_prob2=0.1404
2026-02-23 17:34:05,723 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1367, mean_prob2=0.1438
2026-02-23 17:34:11,226 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1545, mean_prob2=0.1468
2026-02-23 17:34:16,743 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1667, mean_prob2=0.1478
2026-02-23 17:34:22,259 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1730, mean_prob2=0.1476
2026-02-23 17:34:27,804 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1764, mean_prob2=0.1493
2026-02-23 17:34:27,804 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 17:34:28,962 - lg_cotrain - INFO - LR scheduler: total_steps_1=640, warmup=163; total_steps_2=640, warmup=163
2026-02-23 17:34:28,962 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1764, range=[0.0488, 0.3299]
2026-02-23 17:34:28,963 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1493, range=[0.0352, 0.3709]
2026-02-23 17:34:47,060 - lg_cotrain - INFO - Phase 2 epoch 1/20: loss1=0.3178, loss2=0.3924, dev_macro_f1=0.0967, dev_err=82.46%
2026-02-23 17:35:05,127 - lg_cotrain - INFO - Phase 2 epoch 2/20: loss1=0.2195, loss2=0.3369, dev_macro_f1=0.1047, dev_err=57.02%
2026-02-23 17:35:23,125 - lg_cotrain - INFO - Phase 2 epoch 3/20: loss1=0.1839, loss2=0.2925, dev_macro_f1=0.1514, dev_err=47.81%
2026-02-23 17:35:41,148 - lg_cotrain - INFO - Phase 2 epoch 4/20: loss1=0.1458, loss2=0.2616, dev_macro_f1=0.1654, dev_err=44.30%
2026-02-23 17:35:59,198 - lg_cotrain - INFO - Phase 2 epoch 5/20: loss1=0.1106, loss2=0.2235, dev_macro_f1=0.2227, dev_err=42.54%
2026-02-23 17:36:17,213 - lg_cotrain - INFO - Phase 2 epoch 6/20: loss1=0.0789, loss2=0.1763, dev_macro_f1=0.3435, dev_err=31.14%
2026-02-23 17:36:35,227 - lg_cotrain - INFO - Phase 2 epoch 7/20: loss1=0.0515, loss2=0.1401, dev_macro_f1=0.3577, dev_err=29.82%
2026-02-23 17:36:53,409 - lg_cotrain - INFO - Phase 2 epoch 8/20: loss1=0.0335, loss2=0.1114, dev_macro_f1=0.4233, dev_err=26.32%
2026-02-23 17:37:11,475 - lg_cotrain - INFO - Phase 2 epoch 9/20: loss1=0.0219, loss2=0.1013, dev_macro_f1=0.4644, dev_err=24.12%
2026-02-23 17:37:29,616 - lg_cotrain - INFO - Phase 2 epoch 10/20: loss1=0.0166, loss2=0.0782, dev_macro_f1=0.4704, dev_err=23.68%
2026-02-23 17:37:47,608 - lg_cotrain - INFO - Phase 2 epoch 11/20: loss1=0.0130, loss2=0.0754, dev_macro_f1=0.4922, dev_err=25.00%
2026-02-23 17:38:05,585 - lg_cotrain - INFO - Phase 2 epoch 12/20: loss1=0.0100, loss2=0.0581, dev_macro_f1=0.5057, dev_err=24.56%
2026-02-23 17:38:23,590 - lg_cotrain - INFO - Phase 2 epoch 13/20: loss1=0.0107, loss2=0.0474, dev_macro_f1=0.5147, dev_err=24.56%
2026-02-23 17:38:41,612 - lg_cotrain - INFO - Phase 2 epoch 14/20: loss1=0.0107, loss2=0.0401, dev_macro_f1=0.5185, dev_err=24.12%
2026-02-23 17:38:59,940 - lg_cotrain - INFO - Phase 2 epoch 15/20: loss1=0.0077, loss2=0.0382, dev_macro_f1=0.4959, dev_err=25.88%
2026-02-23 17:39:19,152 - lg_cotrain - INFO - Phase 2 epoch 16/20: loss1=0.0062, loss2=0.0294, dev_macro_f1=0.5125, dev_err=25.00%
2026-02-23 17:39:38,335 - lg_cotrain - INFO - Phase 2 epoch 17/20: loss1=0.0085, loss2=0.0225, dev_macro_f1=0.5067, dev_err=25.88%
2026-02-23 17:39:57,605 - lg_cotrain - INFO - Phase 2 epoch 18/20: loss1=0.0090, loss2=0.0180, dev_macro_f1=0.5392, dev_err=22.37%
2026-02-23 17:40:16,751 - lg_cotrain - INFO - Phase 2 epoch 19/20: loss1=0.0125, loss2=0.0152, dev_macro_f1=0.5253, dev_err=24.56%
2026-02-23 17:40:35,909 - lg_cotrain - INFO - Phase 2 epoch 20/20: loss1=0.0101, loss2=0.0141, dev_macro_f1=0.5333, dev_err=22.81%
2026-02-23 17:40:35,916 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 17:40:37,655 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.5630, dev_err=23.25%, es_counter1=0, es_counter2=0
2026-02-23 17:40:39,358 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.5151, dev_err=26.32%, es_counter1=1, es_counter2=1
2026-02-23 17:40:41,055 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.5276, dev_err=25.88%, es_counter1=2, es_counter2=2
2026-02-23 17:40:42,747 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.5554, dev_err=22.81%, es_counter1=3, es_counter2=3
2026-02-23 17:40:44,478 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.5887, dev_err=20.61%, es_counter1=0, es_counter2=0
2026-02-23 17:40:46,167 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.5687, dev_err=22.37%, es_counter1=1, es_counter2=1
2026-02-23 17:40:47,860 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.5692, dev_err=22.37%, es_counter1=2, es_counter2=2
2026-02-23 17:40:49,558 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.5756, dev_err=22.37%, es_counter1=3, es_counter2=3
2026-02-23 17:40:51,270 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.5706, dev_err=22.37%, es_counter1=4, es_counter2=4
2026-02-23 17:40:52,976 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.5919, dev_err=21.05%, es_counter1=0, es_counter2=0
2026-02-23 17:40:54,688 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.5933, dev_err=20.61%, es_counter1=0, es_counter2=0
2026-02-23 17:40:56,398 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.5881, dev_err=20.61%, es_counter1=1, es_counter2=1
2026-02-23 17:40:58,083 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.5673, dev_err=21.93%, es_counter1=2, es_counter2=2
2026-02-23 17:40:59,778 - lg_cotrain - INFO - Phase 3 epoch 14: dev_macro_f1=0.5860, dev_err=21.05%, es_counter1=3, es_counter2=3
2026-02-23 17:41:01,474 - lg_cotrain - INFO - Phase 3 epoch 15: dev_macro_f1=0.5886, dev_err=20.61%, es_counter1=4, es_counter2=4
2026-02-23 17:41:03,191 - lg_cotrain - INFO - Phase 3 epoch 16: dev_macro_f1=0.6890, dev_err=19.74%, es_counter1=0, es_counter2=0
2026-02-23 17:41:04,882 - lg_cotrain - INFO - Phase 3 epoch 17: dev_macro_f1=0.6691, dev_err=20.18%, es_counter1=1, es_counter2=1
2026-02-23 17:41:06,582 - lg_cotrain - INFO - Phase 3 epoch 18: dev_macro_f1=0.6746, dev_err=19.74%, es_counter1=2, es_counter2=2
2026-02-23 17:41:08,292 - lg_cotrain - INFO - Phase 3 epoch 19: dev_macro_f1=0.6560, dev_err=19.74%, es_counter1=3, es_counter2=3
2026-02-23 17:41:09,992 - lg_cotrain - INFO - Phase 3 epoch 20: dev_macro_f1=0.6622, dev_err=19.30%, es_counter1=4, es_counter2=4
2026-02-23 17:41:11,683 - lg_cotrain - INFO - Phase 3 epoch 21: dev_macro_f1=0.6603, dev_err=19.30%, es_counter1=5, es_counter2=5
2026-02-23 17:41:13,395 - lg_cotrain - INFO - Phase 3 epoch 22: dev_macro_f1=0.6581, dev_err=19.30%, es_counter1=6, es_counter2=6
2026-02-23 17:41:15,101 - lg_cotrain - INFO - Phase 3 epoch 23: dev_macro_f1=0.6561, dev_err=19.74%, es_counter1=7, es_counter2=7
2026-02-23 17:41:15,101 - lg_cotrain - INFO - Early stopping at epoch 23
2026-02-23 17:41:15,110 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 17:41:17,391 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpjmditnuu\canada_wildfires_2016\25_set1\metrics.json
2026-02-23 17:41:17,392 - lg_cotrain - INFO - Test error rate: 24.04%, Test macro-F1: 0.5957, Test ECE: 0.0920
2026-02-23 17:41:17,399 - lg_cotrain - INFO - --- Trial 9/10 done: dev_macro_f1=0.6890 ---
2026-02-23 17:41:17,399 - lg_cotrain - INFO - --- Trial 10/10 ---
2026-02-23 17:41:17,974 - lg_cotrain - INFO - Starting LG-CoTrain: event=canada_wildfires_2016, budget=25, seed_set=1
2026-02-23 17:41:17,987 - lg_cotrain - INFO - Detected 8 classes for event canada_wildfires_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 17:41:17,992 - lg_cotrain - INFO - D_l1: 98, D_l2: 91, D_LG: 1380
2026-02-23 17:41:17,993 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 17:41:25,113 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1191, mean_prob2=0.1269
2026-02-23 17:41:31,317 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1264, mean_prob2=0.1126
2026-02-23 17:41:37,482 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1249, mean_prob2=0.1346
2026-02-23 17:41:43,633 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1274, mean_prob2=0.1455
2026-02-23 17:41:49,826 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1288, mean_prob2=0.1440
2026-02-23 17:41:56,001 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1351, mean_prob2=0.1313
2026-02-23 17:42:02,168 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1294, mean_prob2=0.1205
2026-02-23 17:42:02,168 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 17:42:03,197 - lg_cotrain - INFO - LR scheduler: total_steps_1=1280, warmup=130; total_steps_2=1180, warmup=119
2026-02-23 17:42:03,197 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1294, range=[0.0626, 0.2219]
2026-02-23 17:42:03,199 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1205, range=[0.0828, 0.1556]
2026-02-23 17:42:24,082 - lg_cotrain - INFO - Phase 2 epoch 1/20: loss1=0.1710, loss2=0.1877, dev_macro_f1=0.4664, dev_err=24.12%
2026-02-23 17:42:45,045 - lg_cotrain - INFO - Phase 2 epoch 2/20: loss1=0.0688, loss2=0.5363, dev_macro_f1=0.3819, dev_err=30.26%
2026-02-23 17:43:05,919 - lg_cotrain - INFO - Phase 2 epoch 3/20: loss1=0.0892, loss2=1.1860, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 17:43:27,004 - lg_cotrain - INFO - Phase 2 epoch 4/20: loss1=0.1071, loss2=1.1021, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 17:43:48,113 - lg_cotrain - INFO - Phase 2 epoch 5/20: loss1=0.0774, loss2=1.0215, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 17:44:09,005 - lg_cotrain - INFO - Phase 2 epoch 6/20: loss1=0.0755, loss2=0.9516, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 17:44:29,876 - lg_cotrain - INFO - Phase 2 epoch 7/20: loss1=0.0694, loss2=0.9022, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 17:44:50,730 - lg_cotrain - INFO - Phase 2 epoch 8/20: loss1=0.0680, loss2=0.8361, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 17:45:11,647 - lg_cotrain - INFO - Phase 2 epoch 9/20: loss1=0.0582, loss2=0.8094, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 17:45:32,525 - lg_cotrain - INFO - Phase 2 epoch 10/20: loss1=0.0630, loss2=0.7742, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 17:45:53,355 - lg_cotrain - INFO - Phase 2 epoch 11/20: loss1=0.0643, loss2=0.7443, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 17:46:14,219 - lg_cotrain - INFO - Phase 2 epoch 12/20: loss1=0.0613, loss2=0.7119, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 17:46:35,032 - lg_cotrain - INFO - Phase 2 epoch 13/20: loss1=0.0561, loss2=0.7079, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 17:46:55,861 - lg_cotrain - INFO - Phase 2 epoch 14/20: loss1=0.0527, loss2=0.6804, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 17:47:16,701 - lg_cotrain - INFO - Phase 2 epoch 15/20: loss1=0.0503, loss2=0.6499, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 17:47:37,627 - lg_cotrain - INFO - Phase 2 epoch 16/20: loss1=0.0498, loss2=0.6392, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 17:47:58,529 - lg_cotrain - INFO - Phase 2 epoch 17/20: loss1=0.0478, loss2=0.6233, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 17:48:19,436 - lg_cotrain - INFO - Phase 2 epoch 18/20: loss1=0.0469, loss2=0.6096, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 17:48:40,776 - lg_cotrain - INFO - Phase 2 epoch 19/20: loss1=0.0477, loss2=0.5965, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 17:49:01,590 - lg_cotrain - INFO - Phase 2 epoch 20/20: loss1=0.0438, loss2=0.5841, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 17:49:01,590 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 17:49:03,444 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.0735, dev_err=58.33%, es_counter1=0, es_counter2=0
2026-02-23 17:49:05,291 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.0247, dev_err=89.04%, es_counter1=1, es_counter2=1
2026-02-23 17:49:07,098 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.0085, dev_err=96.49%, es_counter1=2, es_counter2=2
2026-02-23 17:49:08,912 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.0085, dev_err=96.49%, es_counter1=3, es_counter2=3
2026-02-23 17:49:10,728 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.0164, dev_err=92.98%, es_counter1=4, es_counter2=4
2026-02-23 17:49:12,560 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.0164, dev_err=92.98%, es_counter1=5, es_counter2=5
2026-02-23 17:49:14,317 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.0365, dev_err=82.89%, es_counter1=6, es_counter2=6
2026-02-23 17:49:16,076 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.0365, dev_err=82.89%, es_counter1=7, es_counter2=7
2026-02-23 17:49:17,805 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.0308, dev_err=85.96%, es_counter1=8, es_counter2=8
2026-02-23 17:49:17,807 - lg_cotrain - INFO - Early stopping at epoch 9
2026-02-23 17:49:17,817 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 17:49:20,047 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpimbqipnk\canada_wildfires_2016\25_set1\metrics.json
2026-02-23 17:49:20,047 - lg_cotrain - INFO - Test error rate: 58.20%, Test macro-F1: 0.0737, Test ECE: 0.1301
2026-02-23 17:49:20,058 - lg_cotrain - INFO - --- Trial 10/10 done: dev_macro_f1=0.0735 ---
