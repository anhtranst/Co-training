2026-02-23 15:13:25,172 - lg_cotrain - INFO - === Optuna study: canada_wildfires_2016 budget=10 seed=1 | target=10 trials, 0 replayed, 10 new ===
2026-02-23 15:13:25,172 - lg_cotrain - INFO - --- Trial 1/10 ---
2026-02-23 15:13:25,826 - lg_cotrain - INFO - Starting LG-CoTrain: event=canada_wildfires_2016, budget=10, seed_set=1
2026-02-23 15:13:25,858 - lg_cotrain - INFO - Detected 8 classes for event canada_wildfires_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 15:13:25,862 - lg_cotrain - INFO - D_l1: 40, D_l2: 40, D_LG: 1489
2026-02-23 15:13:25,863 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 15:13:32,336 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1059, mean_prob2=0.1373
2026-02-23 15:13:37,685 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1109, mean_prob2=0.1372
2026-02-23 15:13:43,019 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1144, mean_prob2=0.1354
2026-02-23 15:13:48,346 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1177, mean_prob2=0.1345
2026-02-23 15:13:53,676 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1213, mean_prob2=0.1324
2026-02-23 15:13:59,046 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1258, mean_prob2=0.1296
2026-02-23 15:14:04,410 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1305, mean_prob2=0.1273
2026-02-23 15:14:04,410 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 15:14:05,443 - lg_cotrain - INFO - LR scheduler: total_steps_1=460, warmup=44; total_steps_2=460, warmup=44
2026-02-23 15:14:05,443 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1305, range=[0.0520, 0.2527]
2026-02-23 15:14:05,444 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1273, range=[0.0347, 0.3158]
2026-02-23 15:14:24,822 - lg_cotrain - INFO - Phase 2 epoch 1/15: loss1=0.2564, loss2=0.2735, dev_macro_f1=0.0824, dev_err=58.33%
2026-02-23 15:14:44,184 - lg_cotrain - INFO - Phase 2 epoch 2/15: loss1=0.1769, loss2=0.2613, dev_macro_f1=0.1510, dev_err=47.81%
2026-02-23 15:15:03,503 - lg_cotrain - INFO - Phase 2 epoch 3/15: loss1=0.1103, loss2=0.2201, dev_macro_f1=0.2546, dev_err=41.23%
2026-02-23 15:15:22,879 - lg_cotrain - INFO - Phase 2 epoch 4/15: loss1=0.0734, loss2=0.1732, dev_macro_f1=0.3577, dev_err=29.82%
2026-02-23 15:15:42,187 - lg_cotrain - INFO - Phase 2 epoch 5/15: loss1=0.0488, loss2=0.1408, dev_macro_f1=0.4235, dev_err=26.32%
2026-02-23 15:16:01,538 - lg_cotrain - INFO - Phase 2 epoch 6/15: loss1=0.0327, loss2=0.1134, dev_macro_f1=0.4803, dev_err=24.56%
2026-02-23 15:16:20,873 - lg_cotrain - INFO - Phase 2 epoch 7/15: loss1=0.0228, loss2=0.0950, dev_macro_f1=0.5042, dev_err=23.25%
2026-02-23 15:16:40,185 - lg_cotrain - INFO - Phase 2 epoch 8/15: loss1=0.0167, loss2=0.0783, dev_macro_f1=0.4944, dev_err=23.68%
2026-02-23 15:16:59,482 - lg_cotrain - INFO - Phase 2 epoch 9/15: loss1=0.0141, loss2=0.0658, dev_macro_f1=0.5155, dev_err=23.25%
2026-02-23 15:17:18,804 - lg_cotrain - INFO - Phase 2 epoch 10/15: loss1=0.0119, loss2=0.0572, dev_macro_f1=0.5196, dev_err=22.37%
2026-02-23 15:17:37,300 - lg_cotrain - INFO - Phase 2 epoch 11/15: loss1=0.0120, loss2=0.0462, dev_macro_f1=0.5234, dev_err=23.68%
2026-02-23 15:17:56,661 - lg_cotrain - INFO - Phase 2 epoch 12/15: loss1=0.0098, loss2=0.0372, dev_macro_f1=0.5100, dev_err=24.56%
2026-02-23 15:18:15,955 - lg_cotrain - INFO - Phase 2 epoch 13/15: loss1=0.0136, loss2=0.0322, dev_macro_f1=0.5175, dev_err=24.12%
2026-02-23 15:18:35,310 - lg_cotrain - INFO - Phase 2 epoch 14/15: loss1=0.0105, loss2=0.0284, dev_macro_f1=0.5212, dev_err=23.68%
2026-02-23 15:18:54,683 - lg_cotrain - INFO - Phase 2 epoch 15/15: loss1=0.0091, loss2=0.0252, dev_macro_f1=0.5221, dev_err=24.56%
2026-02-23 15:18:54,684 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 15:18:55,794 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.5255, dev_err=24.56%, es_counter1=0, es_counter2=0
2026-02-23 15:18:56,907 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.5277, dev_err=24.56%, es_counter1=0, es_counter2=0
2026-02-23 15:18:58,017 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.5472, dev_err=24.12%, es_counter1=0, es_counter2=0
2026-02-23 15:18:59,113 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.5475, dev_err=24.12%, es_counter1=0, es_counter2=0
2026-02-23 15:19:00,203 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.5470, dev_err=24.12%, es_counter1=1, es_counter2=1
2026-02-23 15:19:01,291 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.5429, dev_err=24.12%, es_counter1=2, es_counter2=2
2026-02-23 15:19:02,384 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.5379, dev_err=24.56%, es_counter1=3, es_counter2=3
2026-02-23 15:19:03,474 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.5331, dev_err=25.44%, es_counter1=4, es_counter2=4
2026-02-23 15:19:04,570 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.5215, dev_err=25.88%, es_counter1=5, es_counter2=5
2026-02-23 15:19:05,667 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.5191, dev_err=26.32%, es_counter1=6, es_counter2=6
2026-02-23 15:19:06,756 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.5190, dev_err=26.32%, es_counter1=7, es_counter2=7
2026-02-23 15:19:07,848 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.5286, dev_err=25.88%, es_counter1=8, es_counter2=8
2026-02-23 15:19:07,849 - lg_cotrain - INFO - Early stopping at epoch 12
2026-02-23 15:19:07,860 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 15:19:09,980 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpav3m6jj5\canada_wildfires_2016\10_set1\metrics.json
2026-02-23 15:19:09,980 - lg_cotrain - INFO - Test error rate: 22.70%, Test macro-F1: 0.5790, Test ECE: 0.1245
2026-02-23 15:19:09,992 - lg_cotrain - INFO - --- Trial 1/10 done: dev_macro_f1=0.5475 ---
2026-02-23 15:19:09,992 - lg_cotrain - INFO - --- Trial 2/10 ---
2026-02-23 15:19:10,579 - lg_cotrain - INFO - Starting LG-CoTrain: event=canada_wildfires_2016, budget=10, seed_set=1
2026-02-23 15:19:10,593 - lg_cotrain - INFO - Detected 8 classes for event canada_wildfires_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 15:19:10,597 - lg_cotrain - INFO - D_l1: 40, D_l2: 40, D_LG: 1489
2026-02-23 15:19:10,598 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 15:19:17,551 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1110, mean_prob2=0.1136
2026-02-23 15:19:23,453 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1195, mean_prob2=0.1187
2026-02-23 15:19:29,432 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1280, mean_prob2=0.1319
2026-02-23 15:19:35,393 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1266, mean_prob2=0.1252
2026-02-23 15:19:41,289 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1248, mean_prob2=0.1205
2026-02-23 15:19:47,499 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1316, mean_prob2=0.1246
2026-02-23 15:19:54,172 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1292, mean_prob2=0.1266
2026-02-23 15:19:54,172 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 15:19:55,205 - lg_cotrain - INFO - LR scheduler: total_steps_1=3118, warmup=794; total_steps_2=3118, warmup=794
2026-02-23 15:19:55,205 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1292, range=[0.0962, 0.1408]
2026-02-23 15:19:55,206 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1266, range=[0.1048, 0.1423]
2026-02-23 15:20:22,891 - lg_cotrain - INFO - Phase 2 epoch 1/14: loss1=0.1690, loss2=0.1809, dev_macro_f1=0.4435, dev_err=26.75%
2026-02-23 15:20:50,547 - lg_cotrain - INFO - Phase 2 epoch 2/14: loss1=0.0707, loss2=0.3599, dev_macro_f1=0.4624, dev_err=27.19%
2026-02-23 15:21:18,128 - lg_cotrain - INFO - Phase 2 epoch 3/14: loss1=0.1631, loss2=0.6456, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 15:21:45,704 - lg_cotrain - INFO - Phase 2 epoch 4/14: loss1=0.2688, loss2=1.1729, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 15:22:13,279 - lg_cotrain - INFO - Phase 2 epoch 5/14: loss1=0.1640, loss2=1.0705, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 15:22:40,897 - lg_cotrain - INFO - Phase 2 epoch 6/14: loss1=0.1059, loss2=0.9740, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 15:23:08,460 - lg_cotrain - INFO - Phase 2 epoch 7/14: loss1=0.0635, loss2=0.9259, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 15:23:36,049 - lg_cotrain - INFO - Phase 2 epoch 8/14: loss1=0.0453, loss2=0.8781, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 15:24:03,652 - lg_cotrain - INFO - Phase 2 epoch 9/14: loss1=0.0352, loss2=0.8384, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 15:24:31,311 - lg_cotrain - INFO - Phase 2 epoch 10/14: loss1=0.0284, loss2=0.8030, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 15:24:58,920 - lg_cotrain - INFO - Phase 2 epoch 11/14: loss1=0.0193, loss2=0.7689, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 15:25:26,574 - lg_cotrain - INFO - Phase 2 epoch 12/14: loss1=0.0175, loss2=0.7506, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 15:25:54,136 - lg_cotrain - INFO - Phase 2 epoch 13/14: loss1=0.0111, loss2=0.7160, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 15:26:21,711 - lg_cotrain - INFO - Phase 2 epoch 14/14: loss1=0.0087, loss2=0.6969, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 15:26:21,712 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 15:26:23,170 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.0735, dev_err=58.33%, es_counter1=0, es_counter2=0
2026-02-23 15:26:24,593 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.0735, dev_err=58.33%, es_counter1=1, es_counter2=1
2026-02-23 15:26:26,026 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.0022, dev_err=99.12%, es_counter1=2, es_counter2=2
2026-02-23 15:26:27,470 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.0115, dev_err=95.18%, es_counter1=3, es_counter2=3
2026-02-23 15:26:28,902 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.0022, dev_err=99.12%, es_counter1=4, es_counter2=4
2026-02-23 15:26:30,345 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.0022, dev_err=99.12%, es_counter1=5, es_counter2=5
2026-02-23 15:26:31,781 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.0308, dev_err=85.96%, es_counter1=6, es_counter2=6
2026-02-23 15:26:31,781 - lg_cotrain - INFO - Early stopping at epoch 7
2026-02-23 15:26:31,796 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 15:26:34,385 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmp2fgljzo0\canada_wildfires_2016\10_set1\metrics.json
2026-02-23 15:26:34,385 - lg_cotrain - INFO - Test error rate: 58.20%, Test macro-F1: 0.0737, Test ECE: 0.3977
2026-02-23 15:26:34,396 - lg_cotrain - INFO - --- Trial 2/10 done: dev_macro_f1=0.0735 ---
2026-02-23 15:26:34,397 - lg_cotrain - INFO - --- Trial 3/10 ---
2026-02-23 15:26:34,966 - lg_cotrain - INFO - Starting LG-CoTrain: event=canada_wildfires_2016, budget=10, seed_set=1
2026-02-23 15:26:34,980 - lg_cotrain - INFO - Detected 8 classes for event canada_wildfires_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 15:26:34,983 - lg_cotrain - INFO - D_l1: 40, D_l2: 40, D_LG: 1489
2026-02-23 15:26:34,985 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 15:26:42,335 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1076, mean_prob2=0.0942
2026-02-23 15:26:48,433 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1209, mean_prob2=0.1440
2026-02-23 15:26:54,538 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1286, mean_prob2=0.1243
2026-02-23 15:27:00,716 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1150, mean_prob2=0.1167
2026-02-23 15:27:06,789 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1296, mean_prob2=0.1217
2026-02-23 15:27:12,870 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1490, mean_prob2=0.1257
2026-02-23 15:27:18,960 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1556, mean_prob2=0.1297
2026-02-23 15:27:18,961 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 15:27:20,017 - lg_cotrain - INFO - LR scheduler: total_steps_1=1052, warmup=179; total_steps_2=1052, warmup=179
2026-02-23 15:27:20,017 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1556, range=[0.0380, 0.3167]
2026-02-23 15:27:20,018 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1297, range=[0.1055, 0.1482]
2026-02-23 15:27:43,644 - lg_cotrain - INFO - Phase 2 epoch 1/8: loss1=0.1728, loss2=0.1824, dev_macro_f1=0.3691, dev_err=31.58%
2026-02-23 15:28:09,115 - lg_cotrain - INFO - Phase 2 epoch 2/8: loss1=0.1458, loss2=0.7371, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 15:28:34,860 - lg_cotrain - INFO - Phase 2 epoch 3/8: loss1=0.1112, loss2=0.6805, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 15:29:00,465 - lg_cotrain - INFO - Phase 2 epoch 4/8: loss1=0.0714, loss2=0.6568, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 15:29:26,145 - lg_cotrain - INFO - Phase 2 epoch 5/8: loss1=0.0523, loss2=0.6041, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 15:29:51,878 - lg_cotrain - INFO - Phase 2 epoch 6/8: loss1=0.0484, loss2=0.5671, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 15:30:17,533 - lg_cotrain - INFO - Phase 2 epoch 7/8: loss1=0.0398, loss2=0.5307, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 15:30:43,178 - lg_cotrain - INFO - Phase 2 epoch 8/8: loss1=0.0394, loss2=0.3871, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 15:30:43,178 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 15:30:44,585 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.0735, dev_err=58.33%, es_counter1=0, es_counter2=0
2026-02-23 15:30:46,006 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.1223, dev_err=56.14%, es_counter1=0, es_counter2=0
2026-02-23 15:30:47,394 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.0149, dev_err=96.93%, es_counter1=1, es_counter2=1
2026-02-23 15:30:48,783 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.0125, dev_err=97.37%, es_counter1=2, es_counter2=2
2026-02-23 15:30:50,187 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.1197, dev_err=56.58%, es_counter1=3, es_counter2=3
2026-02-23 15:30:51,590 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.0184, dev_err=96.05%, es_counter1=4, es_counter2=4
2026-02-23 15:30:53,017 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.1226, dev_err=55.70%, es_counter1=0, es_counter2=0
2026-02-23 15:30:54,433 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.1556, dev_err=47.37%, es_counter1=0, es_counter2=0
2026-02-23 15:30:55,831 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.1197, dev_err=56.58%, es_counter1=1, es_counter2=1
2026-02-23 15:30:57,223 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.0596, dev_err=85.09%, es_counter1=2, es_counter2=2
2026-02-23 15:30:58,619 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.0596, dev_err=85.09%, es_counter1=3, es_counter2=3
2026-02-23 15:31:00,020 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.0599, dev_err=85.09%, es_counter1=4, es_counter2=4
2026-02-23 15:31:01,423 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.0599, dev_err=85.09%, es_counter1=5, es_counter2=5
2026-02-23 15:31:02,825 - lg_cotrain - INFO - Phase 3 epoch 14: dev_macro_f1=0.0153, dev_err=96.93%, es_counter1=6, es_counter2=6
2026-02-23 15:31:04,215 - lg_cotrain - INFO - Phase 3 epoch 15: dev_macro_f1=0.0153, dev_err=96.93%, es_counter1=7, es_counter2=7
2026-02-23 15:31:05,610 - lg_cotrain - INFO - Phase 3 epoch 16: dev_macro_f1=0.0153, dev_err=96.93%, es_counter1=8, es_counter2=8
2026-02-23 15:31:07,002 - lg_cotrain - INFO - Phase 3 epoch 17: dev_macro_f1=0.0265, dev_err=94.74%, es_counter1=9, es_counter2=9
2026-02-23 15:31:07,002 - lg_cotrain - INFO - Early stopping at epoch 17
2026-02-23 15:31:07,014 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 15:31:09,588 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpuc_pjrzs\canada_wildfires_2016\10_set1\metrics.json
2026-02-23 15:31:09,588 - lg_cotrain - INFO - Test error rate: 53.26%, Test macro-F1: 0.1351, Test ECE: 0.2710
2026-02-23 15:31:09,601 - lg_cotrain - INFO - --- Trial 3/10 done: dev_macro_f1=0.1556 ---
2026-02-23 15:31:09,601 - lg_cotrain - INFO - --- Trial 4/10 ---
2026-02-23 15:31:10,170 - lg_cotrain - INFO - Starting LG-CoTrain: event=canada_wildfires_2016, budget=10, seed_set=1
2026-02-23 15:31:10,184 - lg_cotrain - INFO - Detected 8 classes for event canada_wildfires_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 15:31:10,189 - lg_cotrain - INFO - D_l1: 40, D_l2: 40, D_LG: 1489
2026-02-23 15:31:10,189 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 15:31:18,081 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1216, mean_prob2=0.1294
2026-02-23 15:31:25,200 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1333, mean_prob2=0.1401
2026-02-23 15:31:32,180 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1285, mean_prob2=0.1518
2026-02-23 15:31:39,074 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1454, mean_prob2=0.1705
2026-02-23 15:31:45,966 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1505, mean_prob2=0.1720
2026-02-23 15:31:52,908 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1630, mean_prob2=0.1872
2026-02-23 15:32:00,051 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1564, mean_prob2=0.2001
2026-02-23 15:32:00,051 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 15:32:01,188 - lg_cotrain - INFO - LR scheduler: total_steps_1=4053, warmup=232; total_steps_2=4053, warmup=232
2026-02-23 15:32:01,189 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1564, range=[0.0224, 0.5969]
2026-02-23 15:32:01,189 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.2001, range=[0.0205, 0.6833]
2026-02-23 15:32:31,177 - lg_cotrain - INFO - Phase 2 epoch 1/19: loss1=0.2426, loss2=0.2102, dev_macro_f1=0.4651, dev_err=25.00%
2026-02-23 15:33:01,093 - lg_cotrain - INFO - Phase 2 epoch 2/19: loss1=0.0621, loss2=0.3134, dev_macro_f1=0.4637, dev_err=25.88%
2026-02-23 15:33:30,958 - lg_cotrain - INFO - Phase 2 epoch 3/19: loss1=0.0646, loss2=0.2562, dev_macro_f1=0.4946, dev_err=23.68%
2026-02-23 15:34:00,643 - lg_cotrain - INFO - Phase 2 epoch 4/19: loss1=0.0384, loss2=0.2184, dev_macro_f1=0.5457, dev_err=22.81%
2026-02-23 15:34:30,299 - lg_cotrain - INFO - Phase 2 epoch 5/19: loss1=0.0345, loss2=0.1472, dev_macro_f1=0.5378, dev_err=21.49%
2026-02-23 15:35:00,028 - lg_cotrain - INFO - Phase 2 epoch 6/19: loss1=0.0437, loss2=0.1495, dev_macro_f1=0.4828, dev_err=25.44%
2026-02-23 15:35:29,831 - lg_cotrain - INFO - Phase 2 epoch 7/19: loss1=0.0327, loss2=0.0764, dev_macro_f1=0.5815, dev_err=21.05%
2026-02-23 15:35:57,880 - lg_cotrain - INFO - Phase 2 epoch 8/19: loss1=0.0303, loss2=0.0584, dev_macro_f1=0.5750, dev_err=21.05%
2026-02-23 15:36:22,158 - lg_cotrain - INFO - Phase 2 epoch 9/19: loss1=0.0284, loss2=0.0179, dev_macro_f1=0.5633, dev_err=21.93%
2026-02-23 15:36:46,397 - lg_cotrain - INFO - Phase 2 epoch 10/19: loss1=0.0141, loss2=0.0142, dev_macro_f1=0.5670, dev_err=21.05%
2026-02-23 15:37:10,677 - lg_cotrain - INFO - Phase 2 epoch 11/19: loss1=0.0060, loss2=0.0086, dev_macro_f1=0.5907, dev_err=20.18%
2026-02-23 15:37:34,982 - lg_cotrain - INFO - Phase 2 epoch 12/19: loss1=0.0050, loss2=0.0069, dev_macro_f1=0.5716, dev_err=20.18%
2026-02-23 15:37:59,230 - lg_cotrain - INFO - Phase 2 epoch 13/19: loss1=0.0074, loss2=0.0053, dev_macro_f1=0.5859, dev_err=19.74%
2026-02-23 15:38:23,485 - lg_cotrain - INFO - Phase 2 epoch 14/19: loss1=0.0067, loss2=0.0047, dev_macro_f1=0.5726, dev_err=20.61%
2026-02-23 15:38:47,722 - lg_cotrain - INFO - Phase 2 epoch 15/19: loss1=0.0042, loss2=0.0041, dev_macro_f1=0.5528, dev_err=21.49%
2026-02-23 15:39:11,964 - lg_cotrain - INFO - Phase 2 epoch 16/19: loss1=0.0051, loss2=0.0039, dev_macro_f1=0.5742, dev_err=20.61%
2026-02-23 15:39:36,329 - lg_cotrain - INFO - Phase 2 epoch 17/19: loss1=0.0040, loss2=0.0036, dev_macro_f1=0.5743, dev_err=21.05%
2026-02-23 15:40:00,582 - lg_cotrain - INFO - Phase 2 epoch 18/19: loss1=0.0034, loss2=0.0035, dev_macro_f1=0.5786, dev_err=21.05%
2026-02-23 15:40:24,808 - lg_cotrain - INFO - Phase 2 epoch 19/19: loss1=0.0038, loss2=0.0029, dev_macro_f1=0.5704, dev_err=21.05%
2026-02-23 15:40:24,808 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 15:40:26,093 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.5584, dev_err=22.37%, es_counter1=0, es_counter2=0
2026-02-23 15:40:27,360 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.5376, dev_err=25.00%, es_counter1=1, es_counter2=1
2026-02-23 15:40:28,643 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.5701, dev_err=25.00%, es_counter1=0, es_counter2=0
2026-02-23 15:40:29,929 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.5957, dev_err=24.12%, es_counter1=0, es_counter2=0
2026-02-23 15:40:31,211 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.6544, dev_err=21.49%, es_counter1=0, es_counter2=0
2026-02-23 15:40:32,473 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.6539, dev_err=21.05%, es_counter1=1, es_counter2=1
2026-02-23 15:40:33,740 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.6285, dev_err=22.37%, es_counter1=2, es_counter2=2
2026-02-23 15:40:35,006 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.6308, dev_err=21.93%, es_counter1=3, es_counter2=3
2026-02-23 15:40:36,270 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.6308, dev_err=21.93%, es_counter1=4, es_counter2=4
2026-02-23 15:40:37,539 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.6278, dev_err=22.37%, es_counter1=5, es_counter2=5
2026-02-23 15:40:38,809 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.6285, dev_err=22.37%, es_counter1=6, es_counter2=6
2026-02-23 15:40:40,079 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.6239, dev_err=22.37%, es_counter1=7, es_counter2=7
2026-02-23 15:40:41,350 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.6050, dev_err=23.68%, es_counter1=8, es_counter2=8
2026-02-23 15:40:42,615 - lg_cotrain - INFO - Phase 3 epoch 14: dev_macro_f1=0.6028, dev_err=24.12%, es_counter1=9, es_counter2=9
2026-02-23 15:40:43,885 - lg_cotrain - INFO - Phase 3 epoch 15: dev_macro_f1=0.5884, dev_err=24.56%, es_counter1=10, es_counter2=10
2026-02-23 15:40:43,885 - lg_cotrain - INFO - Early stopping at epoch 15
2026-02-23 15:40:43,899 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 15:40:46,196 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpx202r_ou\canada_wildfires_2016\10_set1\metrics.json
2026-02-23 15:40:46,196 - lg_cotrain - INFO - Test error rate: 24.27%, Test macro-F1: 0.6003, Test ECE: 0.1047
2026-02-23 15:40:46,206 - lg_cotrain - INFO - --- Trial 4/10 done: dev_macro_f1=0.6544 ---
2026-02-23 15:40:46,207 - lg_cotrain - INFO - --- Trial 5/10 ---
2026-02-23 15:40:46,785 - lg_cotrain - INFO - Starting LG-CoTrain: event=canada_wildfires_2016, budget=10, seed_set=1
2026-02-23 15:40:46,796 - lg_cotrain - INFO - Detected 8 classes for event canada_wildfires_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 15:40:46,800 - lg_cotrain - INFO - D_l1: 40, D_l2: 40, D_LG: 1489
2026-02-23 15:40:46,800 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 15:40:53,145 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1248, mean_prob2=0.1018
2026-02-23 15:40:58,543 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1220, mean_prob2=0.1530
2026-02-23 15:41:03,921 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1113, mean_prob2=0.1196
2026-02-23 15:41:09,305 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1566, mean_prob2=0.1157
2026-02-23 15:41:14,671 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1373, mean_prob2=0.1201
2026-02-23 15:41:20,031 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1245, mean_prob2=0.1314
2026-02-23 15:41:25,430 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1126, mean_prob2=0.1316
2026-02-23 15:41:25,430 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 15:41:26,415 - lg_cotrain - INFO - LR scheduler: total_steps_1=1616, warmup=87; total_steps_2=1616, warmup=87
2026-02-23 15:41:26,415 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1126, range=[0.0922, 0.2158]
2026-02-23 15:41:26,416 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1316, range=[0.0905, 0.1423]
2026-02-23 15:41:47,198 - lg_cotrain - INFO - Phase 2 epoch 1/14: loss1=0.1637, loss2=0.1654, dev_macro_f1=0.3710, dev_err=33.33%
2026-02-23 15:42:07,895 - lg_cotrain - INFO - Phase 2 epoch 2/14: loss1=0.1443, loss2=0.8621, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 15:42:28,642 - lg_cotrain - INFO - Phase 2 epoch 3/14: loss1=0.1538, loss2=0.7434, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 15:42:49,373 - lg_cotrain - INFO - Phase 2 epoch 4/14: loss1=0.1348, loss2=0.7012, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 15:43:10,084 - lg_cotrain - INFO - Phase 2 epoch 5/14: loss1=0.1323, loss2=0.6438, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 15:43:30,814 - lg_cotrain - INFO - Phase 2 epoch 6/14: loss1=0.1299, loss2=0.5983, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 15:43:51,531 - lg_cotrain - INFO - Phase 2 epoch 7/14: loss1=0.1218, loss2=0.5668, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 15:44:12,282 - lg_cotrain - INFO - Phase 2 epoch 8/14: loss1=0.1248, loss2=0.5491, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 15:44:33,010 - lg_cotrain - INFO - Phase 2 epoch 9/14: loss1=0.1212, loss2=0.5187, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 15:44:53,752 - lg_cotrain - INFO - Phase 2 epoch 10/14: loss1=0.1208, loss2=0.5115, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 15:45:18,831 - lg_cotrain - INFO - Phase 2 epoch 11/14: loss1=0.1132, loss2=0.4847, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 15:45:44,361 - lg_cotrain - INFO - Phase 2 epoch 12/14: loss1=0.1123, loss2=0.4815, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 15:46:09,879 - lg_cotrain - INFO - Phase 2 epoch 13/14: loss1=0.1109, loss2=0.4643, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 15:46:35,459 - lg_cotrain - INFO - Phase 2 epoch 14/14: loss1=0.1070, loss2=0.4527, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 15:46:35,459 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 15:46:36,878 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.0735, dev_err=58.33%, es_counter1=0, es_counter2=0
2026-02-23 15:46:38,261 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.0735, dev_err=58.33%, es_counter1=1, es_counter2=1
2026-02-23 15:46:39,647 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.0735, dev_err=58.33%, es_counter1=2, es_counter2=2
2026-02-23 15:46:41,029 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.0115, dev_err=95.18%, es_counter1=3, es_counter2=3
2026-02-23 15:46:42,414 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.0022, dev_err=99.12%, es_counter1=4, es_counter2=4
2026-02-23 15:46:43,811 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.0085, dev_err=96.49%, es_counter1=5, es_counter2=5
2026-02-23 15:46:45,195 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.0085, dev_err=96.49%, es_counter1=6, es_counter2=6
2026-02-23 15:46:46,580 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.0085, dev_err=96.49%, es_counter1=7, es_counter2=7
2026-02-23 15:46:47,961 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.0365, dev_err=82.89%, es_counter1=8, es_counter2=8
2026-02-23 15:46:47,961 - lg_cotrain - INFO - Early stopping at epoch 9
2026-02-23 15:46:47,970 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 15:46:50,521 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmp_h1j10gb\canada_wildfires_2016\10_set1\metrics.json
2026-02-23 15:46:50,521 - lg_cotrain - INFO - Test error rate: 58.20%, Test macro-F1: 0.0737, Test ECE: 0.3489
2026-02-23 15:46:50,528 - lg_cotrain - INFO - --- Trial 5/10 done: dev_macro_f1=0.0735 ---
2026-02-23 15:46:50,529 - lg_cotrain - INFO - --- Trial 6/10 ---
2026-02-23 15:46:51,189 - lg_cotrain - INFO - Starting LG-CoTrain: event=canada_wildfires_2016, budget=10, seed_set=1
2026-02-23 15:46:51,204 - lg_cotrain - INFO - Detected 8 classes for event canada_wildfires_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 15:46:51,208 - lg_cotrain - INFO - D_l1: 40, D_l2: 40, D_LG: 1489
2026-02-23 15:46:51,209 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 15:46:58,817 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1149, mean_prob2=0.1205
2026-02-23 15:47:05,394 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1175, mean_prob2=0.1510
2026-02-23 15:47:11,975 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1236, mean_prob2=0.1167
2026-02-23 15:47:18,562 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1745, mean_prob2=0.1847
2026-02-23 15:47:25,209 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.2017, mean_prob2=0.2311
2026-02-23 15:47:31,816 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.2522, mean_prob2=0.3223
2026-02-23 15:47:38,443 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.2933, mean_prob2=0.3726
2026-02-23 15:47:38,444 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 15:47:39,621 - lg_cotrain - INFO - LR scheduler: total_steps_1=770, warmup=128; total_steps_2=770, warmup=128
2026-02-23 15:47:39,621 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.2933, range=[0.0121, 0.7862]
2026-02-23 15:47:39,621 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.3726, range=[0.0059, 0.8714]
2026-02-23 15:48:03,489 - lg_cotrain - INFO - Phase 2 epoch 1/5: loss1=0.3841, loss2=0.3489, dev_macro_f1=0.4991, dev_err=23.68%
2026-02-23 15:48:25,367 - lg_cotrain - INFO - Phase 2 epoch 2/5: loss1=0.0959, loss2=0.7161, dev_macro_f1=0.3950, dev_err=30.70%
2026-02-23 15:48:47,766 - lg_cotrain - INFO - Phase 2 epoch 3/5: loss1=0.0413, loss2=1.1606, dev_macro_f1=0.3734, dev_err=32.02%
2026-02-23 15:49:09,846 - lg_cotrain - INFO - Phase 2 epoch 4/5: loss1=0.0212, loss2=1.2356, dev_macro_f1=0.4424, dev_err=26.75%
2026-02-23 15:49:34,066 - lg_cotrain - INFO - Phase 2 epoch 5/5: loss1=0.0105, loss2=1.2928, dev_macro_f1=0.4329, dev_err=26.75%
2026-02-23 15:49:34,066 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 15:49:35,241 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.3988, dev_err=34.65%, es_counter1=0, es_counter2=0
2026-02-23 15:49:36,428 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.4083, dev_err=33.33%, es_counter1=0, es_counter2=0
2026-02-23 15:49:37,602 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.4578, dev_err=29.39%, es_counter1=0, es_counter2=0
2026-02-23 15:49:38,807 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.4817, dev_err=28.07%, es_counter1=0, es_counter2=0
2026-02-23 15:49:39,978 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.4748, dev_err=30.26%, es_counter1=1, es_counter2=1
2026-02-23 15:49:41,143 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.4515, dev_err=37.72%, es_counter1=2, es_counter2=2
2026-02-23 15:49:42,423 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.4913, dev_err=33.77%, es_counter1=0, es_counter2=0
2026-02-23 15:49:43,695 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.4998, dev_err=35.96%, es_counter1=0, es_counter2=0
2026-02-23 15:49:44,893 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.4751, dev_err=40.35%, es_counter1=1, es_counter2=1
2026-02-23 15:49:46,074 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.4771, dev_err=41.23%, es_counter1=2, es_counter2=2
2026-02-23 15:49:47,407 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.5004, dev_err=40.79%, es_counter1=0, es_counter2=0
2026-02-23 15:49:48,674 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.4930, dev_err=41.23%, es_counter1=1, es_counter2=1
2026-02-23 15:49:50,004 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.4955, dev_err=39.47%, es_counter1=2, es_counter2=2
2026-02-23 15:49:51,401 - lg_cotrain - INFO - Phase 3 epoch 14: dev_macro_f1=0.5020, dev_err=39.47%, es_counter1=0, es_counter2=0
2026-02-23 15:49:52,797 - lg_cotrain - INFO - Phase 3 epoch 15: dev_macro_f1=0.4791, dev_err=39.91%, es_counter1=1, es_counter2=1
2026-02-23 15:49:53,999 - lg_cotrain - INFO - Phase 3 epoch 16: dev_macro_f1=0.4845, dev_err=40.35%, es_counter1=2, es_counter2=2
2026-02-23 15:49:55,170 - lg_cotrain - INFO - Phase 3 epoch 17: dev_macro_f1=0.5014, dev_err=39.47%, es_counter1=3, es_counter2=3
2026-02-23 15:49:56,337 - lg_cotrain - INFO - Phase 3 epoch 18: dev_macro_f1=0.4892, dev_err=40.35%, es_counter1=4, es_counter2=4
2026-02-23 15:49:57,505 - lg_cotrain - INFO - Phase 3 epoch 19: dev_macro_f1=0.4966, dev_err=39.91%, es_counter1=5, es_counter2=5
2026-02-23 15:49:57,506 - lg_cotrain - INFO - Early stopping at epoch 19
2026-02-23 15:49:57,516 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 15:49:59,717 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpoaurlhrq\canada_wildfires_2016\10_set1\metrics.json
2026-02-23 15:49:59,717 - lg_cotrain - INFO - Test error rate: 41.12%, Test macro-F1: 0.4786, Test ECE: 0.1909
2026-02-23 15:49:59,725 - lg_cotrain - INFO - --- Trial 6/10 done: dev_macro_f1=0.5020 ---
2026-02-23 15:49:59,725 - lg_cotrain - INFO - --- Trial 7/10 ---
2026-02-23 15:50:00,319 - lg_cotrain - INFO - Starting LG-CoTrain: event=canada_wildfires_2016, budget=10, seed_set=1
2026-02-23 15:50:00,331 - lg_cotrain - INFO - Detected 8 classes for event canada_wildfires_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 15:50:00,337 - lg_cotrain - INFO - D_l1: 40, D_l2: 40, D_LG: 1489
2026-02-23 15:50:00,338 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 15:50:07,420 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1211, mean_prob2=0.1329
2026-02-23 15:50:13,763 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1322, mean_prob2=0.1210
2026-02-23 15:50:20,376 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1167, mean_prob2=0.1431
2026-02-23 15:50:26,713 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1302, mean_prob2=0.1694
2026-02-23 15:50:32,768 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1899, mean_prob2=0.2001
2026-02-23 15:50:38,803 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1945, mean_prob2=0.2801
2026-02-23 15:50:45,450 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.3265, mean_prob2=0.3126
2026-02-23 15:50:45,450 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 15:50:46,535 - lg_cotrain - INFO - LR scheduler: total_steps_1=4053, warmup=871; total_steps_2=4053, warmup=871
2026-02-23 15:50:46,535 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.3265, range=[0.0154, 0.6889]
2026-02-23 15:50:46,536 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.3126, range=[0.0083, 0.8755]
2026-02-23 15:51:16,222 - lg_cotrain - INFO - Phase 2 epoch 1/19: loss1=0.4041, loss2=0.4096, dev_macro_f1=0.3359, dev_err=31.58%
2026-02-23 15:51:45,961 - lg_cotrain - INFO - Phase 2 epoch 2/19: loss1=0.0646, loss2=0.2047, dev_macro_f1=0.4276, dev_err=26.75%
2026-02-23 15:52:15,668 - lg_cotrain - INFO - Phase 2 epoch 3/19: loss1=0.1125, loss2=0.1985, dev_macro_f1=0.3971, dev_err=28.95%
2026-02-23 15:52:45,396 - lg_cotrain - INFO - Phase 2 epoch 4/19: loss1=0.0884, loss2=0.1455, dev_macro_f1=0.3943, dev_err=29.39%
2026-02-23 15:53:15,090 - lg_cotrain - INFO - Phase 2 epoch 5/19: loss1=0.1449, loss2=0.3010, dev_macro_f1=0.3634, dev_err=36.40%
2026-02-23 15:53:40,024 - lg_cotrain - INFO - Phase 2 epoch 6/19: loss1=0.2269, loss2=1.0210, dev_macro_f1=0.2194, dev_err=44.74%
2026-02-23 15:54:07,665 - lg_cotrain - INFO - Phase 2 epoch 7/19: loss1=0.0698, loss2=1.1069, dev_macro_f1=0.3788, dev_err=31.58%
2026-02-23 15:54:32,166 - lg_cotrain - INFO - Phase 2 epoch 8/19: loss1=0.0551, loss2=1.1282, dev_macro_f1=0.3450, dev_err=37.28%
2026-02-23 15:54:59,956 - lg_cotrain - INFO - Phase 2 epoch 9/19: loss1=0.0238, loss2=0.6415, dev_macro_f1=0.3728, dev_err=29.82%
2026-02-23 15:55:25,471 - lg_cotrain - INFO - Phase 2 epoch 10/19: loss1=0.0099, loss2=0.5713, dev_macro_f1=0.3574, dev_err=31.14%
2026-02-23 15:55:54,015 - lg_cotrain - INFO - Phase 2 epoch 11/19: loss1=0.0068, loss2=1.0604, dev_macro_f1=0.3592, dev_err=30.70%
2026-02-23 15:56:23,471 - lg_cotrain - INFO - Phase 2 epoch 12/19: loss1=0.0032, loss2=1.0130, dev_macro_f1=0.3602, dev_err=30.70%
2026-02-23 15:56:49,940 - lg_cotrain - INFO - Phase 2 epoch 13/19: loss1=0.0035, loss2=1.1189, dev_macro_f1=0.3677, dev_err=30.26%
2026-02-23 15:57:16,152 - lg_cotrain - INFO - Phase 2 epoch 14/19: loss1=0.0027, loss2=1.1382, dev_macro_f1=0.3602, dev_err=30.70%
2026-02-23 15:57:44,175 - lg_cotrain - INFO - Phase 2 epoch 15/19: loss1=0.0051, loss2=1.1781, dev_macro_f1=0.3411, dev_err=33.77%
2026-02-23 15:58:12,248 - lg_cotrain - INFO - Phase 2 epoch 16/19: loss1=0.0068, loss2=1.1768, dev_macro_f1=0.3469, dev_err=30.70%
2026-02-23 15:58:39,550 - lg_cotrain - INFO - Phase 2 epoch 17/19: loss1=0.0078, loss2=1.1746, dev_macro_f1=0.3454, dev_err=31.58%
2026-02-23 15:59:06,845 - lg_cotrain - INFO - Phase 2 epoch 18/19: loss1=0.0079, loss2=1.1666, dev_macro_f1=0.3456, dev_err=31.14%
2026-02-23 15:59:31,386 - lg_cotrain - INFO - Phase 2 epoch 19/19: loss1=0.0077, loss2=1.1609, dev_macro_f1=0.3483, dev_err=31.14%
2026-02-23 15:59:31,386 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 15:59:32,725 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.2590, dev_err=41.23%, es_counter1=0, es_counter2=0
2026-02-23 15:59:33,995 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.2378, dev_err=44.74%, es_counter1=1, es_counter2=1
2026-02-23 15:59:35,274 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.1492, dev_err=53.51%, es_counter1=2, es_counter2=2
2026-02-23 15:59:36,557 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.2059, dev_err=50.44%, es_counter1=3, es_counter2=3
2026-02-23 15:59:37,837 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.2060, dev_err=50.00%, es_counter1=4, es_counter2=4
2026-02-23 15:59:39,122 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.2214, dev_err=48.25%, es_counter1=5, es_counter2=5
2026-02-23 15:59:39,123 - lg_cotrain - INFO - Early stopping at epoch 6
2026-02-23 15:59:39,131 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 15:59:41,479 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpd2s1b9dw\canada_wildfires_2016\10_set1\metrics.json
2026-02-23 15:59:41,479 - lg_cotrain - INFO - Test error rate: 41.80%, Test macro-F1: 0.2755, Test ECE: 0.1019
2026-02-23 15:59:41,492 - lg_cotrain - INFO - --- Trial 7/10 done: dev_macro_f1=0.2590 ---
2026-02-23 15:59:41,492 - lg_cotrain - INFO - --- Trial 8/10 ---
2026-02-23 15:59:42,076 - lg_cotrain - INFO - Starting LG-CoTrain: event=canada_wildfires_2016, budget=10, seed_set=1
2026-02-23 15:59:42,092 - lg_cotrain - INFO - Detected 8 classes for event canada_wildfires_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 15:59:42,098 - lg_cotrain - INFO - D_l1: 40, D_l2: 40, D_LG: 1489
2026-02-23 15:59:42,099 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 15:59:48,162 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1114, mean_prob2=0.1354
2026-02-23 15:59:53,144 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1126, mean_prob2=0.1322
2026-02-23 15:59:58,108 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1168, mean_prob2=0.1245
2026-02-23 16:00:03,084 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1296, mean_prob2=0.1224
2026-02-23 16:00:08,079 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1558, mean_prob2=0.1307
2026-02-23 16:00:13,140 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1669, mean_prob2=0.1362
2026-02-23 16:00:18,148 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1676, mean_prob2=0.1439
2026-02-23 16:00:18,148 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 16:00:19,178 - lg_cotrain - INFO - LR scheduler: total_steps_1=623, warmup=185; total_steps_2=623, warmup=185
2026-02-23 16:00:19,178 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1676, range=[0.0425, 0.4262]
2026-02-23 16:00:19,178 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1439, range=[0.0187, 0.2799]
2026-02-23 16:00:37,743 - lg_cotrain - INFO - Phase 2 epoch 1/9: loss1=0.2694, loss2=0.3244, dev_macro_f1=0.1907, dev_err=48.68%
2026-02-23 16:00:56,332 - lg_cotrain - INFO - Phase 2 epoch 2/9: loss1=0.1385, loss2=0.2719, dev_macro_f1=0.3197, dev_err=35.96%
2026-02-23 16:01:14,993 - lg_cotrain - INFO - Phase 2 epoch 3/9: loss1=0.0659, loss2=0.1625, dev_macro_f1=0.4136, dev_err=28.07%
2026-02-23 16:01:33,547 - lg_cotrain - INFO - Phase 2 epoch 4/9: loss1=0.0304, loss2=0.1081, dev_macro_f1=0.4781, dev_err=25.88%
2026-02-23 16:01:52,146 - lg_cotrain - INFO - Phase 2 epoch 5/9: loss1=0.0245, loss2=0.0894, dev_macro_f1=0.4859, dev_err=25.44%
2026-02-23 16:02:10,712 - lg_cotrain - INFO - Phase 2 epoch 6/9: loss1=0.0134, loss2=0.0875, dev_macro_f1=0.5519, dev_err=21.49%
2026-02-23 16:02:29,747 - lg_cotrain - INFO - Phase 2 epoch 7/9: loss1=0.0089, loss2=0.0488, dev_macro_f1=0.5506, dev_err=22.81%
2026-02-23 16:02:51,176 - lg_cotrain - INFO - Phase 2 epoch 8/9: loss1=0.0102, loss2=0.0273, dev_macro_f1=0.5517, dev_err=21.49%
2026-02-23 16:03:13,629 - lg_cotrain - INFO - Phase 2 epoch 9/9: loss1=0.0093, loss2=0.0202, dev_macro_f1=0.5414, dev_err=23.25%
2026-02-23 16:03:13,629 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 16:03:14,922 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.5572, dev_err=23.25%, es_counter1=0, es_counter2=0
2026-02-23 16:03:16,179 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.5356, dev_err=25.00%, es_counter1=1, es_counter2=1
2026-02-23 16:03:17,452 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.5254, dev_err=26.75%, es_counter1=2, es_counter2=2
2026-02-23 16:03:18,739 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.5644, dev_err=25.44%, es_counter1=0, es_counter2=0
2026-02-23 16:03:20,015 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.5755, dev_err=25.00%, es_counter1=0, es_counter2=0
2026-02-23 16:03:21,249 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.5583, dev_err=26.32%, es_counter1=1, es_counter2=1
2026-02-23 16:03:22,518 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.5618, dev_err=26.32%, es_counter1=2, es_counter2=2
2026-02-23 16:03:23,796 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.6361, dev_err=24.56%, es_counter1=0, es_counter2=0
2026-02-23 16:03:25,087 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.6457, dev_err=22.81%, es_counter1=0, es_counter2=0
2026-02-23 16:03:26,352 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.6221, dev_err=23.25%, es_counter1=1, es_counter2=1
2026-02-23 16:03:27,616 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.6230, dev_err=22.81%, es_counter1=2, es_counter2=2
2026-02-23 16:03:28,883 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.6087, dev_err=23.68%, es_counter1=3, es_counter2=3
2026-02-23 16:03:30,146 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.5893, dev_err=24.12%, es_counter1=4, es_counter2=4
2026-02-23 16:03:31,422 - lg_cotrain - INFO - Phase 3 epoch 14: dev_macro_f1=0.5860, dev_err=25.44%, es_counter1=5, es_counter2=5
2026-02-23 16:03:32,640 - lg_cotrain - INFO - Phase 3 epoch 15: dev_macro_f1=0.5961, dev_err=24.56%, es_counter1=6, es_counter2=6
2026-02-23 16:03:33,908 - lg_cotrain - INFO - Phase 3 epoch 16: dev_macro_f1=0.5926, dev_err=24.56%, es_counter1=7, es_counter2=7
2026-02-23 16:03:35,145 - lg_cotrain - INFO - Phase 3 epoch 17: dev_macro_f1=0.5950, dev_err=24.56%, es_counter1=8, es_counter2=8
2026-02-23 16:03:35,145 - lg_cotrain - INFO - Early stopping at epoch 17
2026-02-23 16:03:35,154 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 16:03:37,505 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmptwszlajy\canada_wildfires_2016\10_set1\metrics.json
2026-02-23 16:03:37,505 - lg_cotrain - INFO - Test error rate: 28.31%, Test macro-F1: 0.5654, Test ECE: 0.0809
2026-02-23 16:03:37,516 - lg_cotrain - INFO - --- Trial 8/10 done: dev_macro_f1=0.6457 ---
2026-02-23 16:03:37,517 - lg_cotrain - INFO - --- Trial 9/10 ---
2026-02-23 16:03:38,097 - lg_cotrain - INFO - Starting LG-CoTrain: event=canada_wildfires_2016, budget=10, seed_set=1
2026-02-23 16:03:38,109 - lg_cotrain - INFO - Detected 8 classes for event canada_wildfires_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 16:03:38,113 - lg_cotrain - INFO - D_l1: 40, D_l2: 40, D_LG: 1489
2026-02-23 16:03:38,113 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 16:03:46,006 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.0936, mean_prob2=0.1259
2026-02-23 16:03:52,889 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1104, mean_prob2=0.1180
2026-02-23 16:03:59,772 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1243, mean_prob2=0.1356
2026-02-23 16:04:06,663 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1377, mean_prob2=0.1190
2026-02-23 16:04:13,502 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1300, mean_prob2=0.1172
2026-02-23 16:04:20,347 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1376, mean_prob2=0.1277
2026-02-23 16:04:27,202 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1213, mean_prob2=0.1212
2026-02-23 16:04:27,203 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 16:04:28,234 - lg_cotrain - INFO - LR scheduler: total_steps_1=3679, warmup=329; total_steps_2=3679, warmup=329
2026-02-23 16:04:28,235 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1213, range=[0.0669, 0.1581]
2026-02-23 16:04:28,235 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1212, range=[0.0944, 0.1597]
2026-02-23 16:04:57,882 - lg_cotrain - INFO - Phase 2 epoch 1/17: loss1=0.1456, loss2=0.1800, dev_macro_f1=0.0302, dev_err=88.16%
2026-02-23 16:05:26,389 - lg_cotrain - INFO - Phase 2 epoch 2/17: loss1=0.1627, loss2=0.2962, dev_macro_f1=0.0247, dev_err=89.04%
2026-02-23 16:05:55,100 - lg_cotrain - INFO - Phase 2 epoch 3/17: loss1=0.1122, loss2=0.3954, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:06:21,782 - lg_cotrain - INFO - Phase 2 epoch 4/17: loss1=0.1106, loss2=0.4218, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:06:49,214 - lg_cotrain - INFO - Phase 2 epoch 5/17: loss1=0.1045, loss2=0.4230, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:07:14,421 - lg_cotrain - INFO - Phase 2 epoch 6/17: loss1=0.1010, loss2=0.4046, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:07:40,940 - lg_cotrain - INFO - Phase 2 epoch 7/17: loss1=0.0904, loss2=0.3973, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:08:08,350 - lg_cotrain - INFO - Phase 2 epoch 8/17: loss1=0.0852, loss2=0.3889, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:08:34,263 - lg_cotrain - INFO - Phase 2 epoch 9/17: loss1=0.0771, loss2=0.3760, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:09:00,122 - lg_cotrain - INFO - Phase 2 epoch 10/17: loss1=0.0735, loss2=0.3663, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:09:25,750 - lg_cotrain - INFO - Phase 2 epoch 11/17: loss1=0.0684, loss2=0.3565, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:09:51,037 - lg_cotrain - INFO - Phase 2 epoch 12/17: loss1=0.0667, loss2=0.3494, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:10:16,114 - lg_cotrain - INFO - Phase 2 epoch 13/17: loss1=0.0639, loss2=0.3411, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:10:41,071 - lg_cotrain - INFO - Phase 2 epoch 14/17: loss1=0.0602, loss2=0.3346, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:11:06,166 - lg_cotrain - INFO - Phase 2 epoch 15/17: loss1=0.0555, loss2=0.3241, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:11:31,121 - lg_cotrain - INFO - Phase 2 epoch 16/17: loss1=0.0541, loss2=0.3169, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:11:56,076 - lg_cotrain - INFO - Phase 2 epoch 17/17: loss1=0.0507, loss2=0.3091, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 16:11:56,076 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 16:11:57,398 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.0735, dev_err=58.33%, es_counter1=0, es_counter2=0
2026-02-23 16:11:58,689 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.0735, dev_err=58.33%, es_counter1=1, es_counter2=1
2026-02-23 16:11:59,965 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.0022, dev_err=99.12%, es_counter1=2, es_counter2=2
2026-02-23 16:12:01,275 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.0085, dev_err=96.49%, es_counter1=3, es_counter2=3
2026-02-23 16:12:02,571 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.0085, dev_err=96.49%, es_counter1=4, es_counter2=4
2026-02-23 16:12:03,860 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.0365, dev_err=82.89%, es_counter1=5, es_counter2=5
2026-02-23 16:12:05,192 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.0115, dev_err=95.18%, es_counter1=6, es_counter2=6
2026-02-23 16:12:05,193 - lg_cotrain - INFO - Early stopping at epoch 7
2026-02-23 16:12:05,205 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 16:12:07,551 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpu5yhxqql\canada_wildfires_2016\10_set1\metrics.json
2026-02-23 16:12:07,551 - lg_cotrain - INFO - Test error rate: 58.20%, Test macro-F1: 0.0737, Test ECE: 0.3818
2026-02-23 16:12:07,562 - lg_cotrain - INFO - --- Trial 9/10 done: dev_macro_f1=0.0735 ---
2026-02-23 16:12:07,563 - lg_cotrain - INFO - --- Trial 10/10 ---
2026-02-23 16:12:08,134 - lg_cotrain - INFO - Starting LG-CoTrain: event=canada_wildfires_2016, budget=10, seed_set=1
2026-02-23 16:12:08,143 - lg_cotrain - INFO - Detected 8 classes for event canada_wildfires_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 16:12:08,151 - lg_cotrain - INFO - D_l1: 40, D_l2: 40, D_LG: 1489
2026-02-23 16:12:08,151 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 16:12:14,076 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1148, mean_prob2=0.1306
2026-02-23 16:12:18,933 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1249, mean_prob2=0.1348
2026-02-23 16:12:23,847 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1303, mean_prob2=0.1333
2026-02-23 16:12:28,797 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1327, mean_prob2=0.1325
2026-02-23 16:12:33,660 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1396, mean_prob2=0.1324
2026-02-23 16:12:38,524 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1499, mean_prob2=0.1408
2026-02-23 16:12:43,395 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1580, mean_prob2=0.1534
2026-02-23 16:12:43,396 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 16:12:44,391 - lg_cotrain - INFO - LR scheduler: total_steps_1=532, warmup=89; total_steps_2=532, warmup=89
2026-02-23 16:12:44,393 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1580, range=[0.0470, 0.3628]
2026-02-23 16:12:44,393 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1534, range=[0.0198, 0.4189]
2026-02-23 16:13:02,121 - lg_cotrain - INFO - Phase 2 epoch 1/18: loss1=0.2999, loss2=0.3147, dev_macro_f1=0.1590, dev_err=49.56%
2026-02-23 16:13:19,765 - lg_cotrain - INFO - Phase 2 epoch 2/18: loss1=0.1562, loss2=0.2848, dev_macro_f1=0.1673, dev_err=44.30%
2026-02-23 16:13:37,420 - lg_cotrain - INFO - Phase 2 epoch 3/18: loss1=0.0819, loss2=0.1939, dev_macro_f1=0.3650, dev_err=29.82%
2026-02-23 16:13:55,099 - lg_cotrain - INFO - Phase 2 epoch 4/18: loss1=0.0363, loss2=0.1320, dev_macro_f1=0.4955, dev_err=22.81%
2026-02-23 16:14:12,689 - lg_cotrain - INFO - Phase 2 epoch 5/18: loss1=0.0173, loss2=0.0955, dev_macro_f1=0.4884, dev_err=24.12%
2026-02-23 16:14:30,350 - lg_cotrain - INFO - Phase 2 epoch 6/18: loss1=0.0103, loss2=0.0809, dev_macro_f1=0.5298, dev_err=22.81%
2026-02-23 16:14:48,098 - lg_cotrain - INFO - Phase 2 epoch 7/18: loss1=0.0085, loss2=0.0818, dev_macro_f1=0.5113, dev_err=23.68%
2026-02-23 16:15:05,884 - lg_cotrain - INFO - Phase 2 epoch 8/18: loss1=0.0108, loss2=0.0642, dev_macro_f1=0.5290, dev_err=22.37%
2026-02-23 16:15:23,794 - lg_cotrain - INFO - Phase 2 epoch 9/18: loss1=0.0201, loss2=0.0392, dev_macro_f1=0.4980, dev_err=26.32%
2026-02-23 16:15:41,305 - lg_cotrain - INFO - Phase 2 epoch 10/18: loss1=0.0110, loss2=0.0256, dev_macro_f1=0.5604, dev_err=21.05%
2026-02-23 16:15:58,995 - lg_cotrain - INFO - Phase 2 epoch 11/18: loss1=0.0124, loss2=0.0135, dev_macro_f1=0.5351, dev_err=21.93%
2026-02-23 16:16:16,528 - lg_cotrain - INFO - Phase 2 epoch 12/18: loss1=0.0113, loss2=0.0216, dev_macro_f1=0.5309, dev_err=22.81%
2026-02-23 16:16:34,022 - lg_cotrain - INFO - Phase 2 epoch 13/18: loss1=0.0062, loss2=0.0139, dev_macro_f1=0.5531, dev_err=21.93%
2026-02-23 16:16:51,296 - lg_cotrain - INFO - Phase 2 epoch 14/18: loss1=0.0048, loss2=0.0081, dev_macro_f1=0.5682, dev_err=20.61%
2026-02-23 16:17:08,478 - lg_cotrain - INFO - Phase 2 epoch 15/18: loss1=0.0037, loss2=0.0071, dev_macro_f1=0.5548, dev_err=21.49%
2026-02-23 16:17:25,662 - lg_cotrain - INFO - Phase 2 epoch 16/18: loss1=0.0036, loss2=0.0073, dev_macro_f1=0.5803, dev_err=20.18%
2026-02-23 16:17:42,802 - lg_cotrain - INFO - Phase 2 epoch 17/18: loss1=0.0032, loss2=0.0062, dev_macro_f1=0.5732, dev_err=20.18%
2026-02-23 16:17:59,958 - lg_cotrain - INFO - Phase 2 epoch 18/18: loss1=0.0045, loss2=0.0069, dev_macro_f1=0.5625, dev_err=22.37%
2026-02-23 16:17:59,960 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 16:18:00,954 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.5620, dev_err=22.37%, es_counter1=0, es_counter2=0
2026-02-23 16:18:01,912 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.5599, dev_err=22.37%, es_counter1=1, es_counter2=1
2026-02-23 16:18:02,877 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.5456, dev_err=23.25%, es_counter1=2, es_counter2=2
2026-02-23 16:18:03,844 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.5166, dev_err=25.00%, es_counter1=3, es_counter2=3
2026-02-23 16:18:04,818 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.5284, dev_err=24.56%, es_counter1=4, es_counter2=4
2026-02-23 16:18:05,787 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.5283, dev_err=24.56%, es_counter1=5, es_counter2=5
2026-02-23 16:18:06,756 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.5316, dev_err=24.56%, es_counter1=6, es_counter2=6
2026-02-23 16:18:07,724 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.5315, dev_err=24.56%, es_counter1=7, es_counter2=7
2026-02-23 16:18:08,695 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.5307, dev_err=24.56%, es_counter1=8, es_counter2=8
2026-02-23 16:18:09,664 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.5300, dev_err=24.56%, es_counter1=9, es_counter2=9
2026-02-23 16:18:10,628 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.5530, dev_err=22.81%, es_counter1=10, es_counter2=10
2026-02-23 16:18:10,628 - lg_cotrain - INFO - Early stopping at epoch 11
2026-02-23 16:18:10,639 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 16:18:12,535 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmphq25odhs\canada_wildfires_2016\10_set1\metrics.json
2026-02-23 16:18:12,535 - lg_cotrain - INFO - Test error rate: 22.70%, Test macro-F1: 0.5720, Test ECE: 0.1778
2026-02-23 16:18:12,545 - lg_cotrain - INFO - --- Trial 10/10 done: dev_macro_f1=0.5620 ---
