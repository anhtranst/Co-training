2026-02-23 19:00:38,152 - lg_cotrain - INFO - === Optuna study: canada_wildfires_2016 budget=50 seed=3 | target=10 trials, 0 replayed, 10 new ===
2026-02-23 19:00:38,152 - lg_cotrain - INFO - --- Trial 1/10 ---
2026-02-23 19:00:38,720 - lg_cotrain - INFO - Starting LG-CoTrain: event=canada_wildfires_2016, budget=50, seed_set=3
2026-02-23 19:00:38,750 - lg_cotrain - INFO - Detected 8 classes for event canada_wildfires_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 19:00:38,754 - lg_cotrain - INFO - D_l1: 182, D_l2: 182, D_LG: 1205
2026-02-23 19:00:38,755 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 19:00:45,261 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1221, mean_prob2=0.1325
2026-02-23 19:00:50,669 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1300, mean_prob2=0.1412
2026-02-23 19:00:56,001 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1362, mean_prob2=0.1606
2026-02-23 19:01:01,310 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1505, mean_prob2=0.1660
2026-02-23 19:01:06,669 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1593, mean_prob2=0.1694
2026-02-23 19:01:12,103 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1626, mean_prob2=0.1733
2026-02-23 19:01:17,483 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1773, mean_prob2=0.1880
2026-02-23 19:01:17,483 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 19:01:18,566 - lg_cotrain - INFO - LR scheduler: total_steps_1=866, warmup=34; total_steps_2=866, warmup=34
2026-02-23 19:01:18,567 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1773, range=[0.0400, 0.3308]
2026-02-23 19:01:18,567 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1880, range=[0.0409, 0.3264]
2026-02-23 19:01:34,036 - lg_cotrain - INFO - Phase 2 epoch 1/7: loss1=0.3382, loss2=0.3338, dev_macro_f1=0.1445, dev_err=50.00%
2026-02-23 19:01:49,475 - lg_cotrain - INFO - Phase 2 epoch 2/7: loss1=0.1817, loss2=0.2918, dev_macro_f1=0.1703, dev_err=43.42%
2026-02-23 19:02:04,933 - lg_cotrain - INFO - Phase 2 epoch 3/7: loss1=0.1047, loss2=0.2086, dev_macro_f1=0.1681, dev_err=43.86%
2026-02-23 19:02:20,362 - lg_cotrain - INFO - Phase 2 epoch 4/7: loss1=0.0771, loss2=0.1511, dev_macro_f1=0.2178, dev_err=40.35%
2026-02-23 19:02:35,623 - lg_cotrain - INFO - Phase 2 epoch 5/7: loss1=0.0577, loss2=0.1313, dev_macro_f1=0.2660, dev_err=35.09%
2026-02-23 19:02:50,822 - lg_cotrain - INFO - Phase 2 epoch 6/7: loss1=0.0453, loss2=0.1162, dev_macro_f1=0.3354, dev_err=31.14%
2026-02-23 19:03:05,918 - lg_cotrain - INFO - Phase 2 epoch 7/7: loss1=0.0378, loss2=0.1129, dev_macro_f1=0.3958, dev_err=27.63%
2026-02-23 19:03:05,918 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 19:03:08,212 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.4655, dev_err=30.26%, es_counter1=0, es_counter2=0
2026-02-23 19:03:10,516 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.4755, dev_err=26.32%, es_counter1=0, es_counter2=0
2026-02-23 19:03:12,825 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.5599, dev_err=22.37%, es_counter1=0, es_counter2=0
2026-02-23 19:03:15,129 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.5669, dev_err=22.81%, es_counter1=0, es_counter2=0
2026-02-23 19:03:17,417 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.5716, dev_err=23.68%, es_counter1=0, es_counter2=0
2026-02-23 19:03:19,703 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.5935, dev_err=21.49%, es_counter1=0, es_counter2=0
2026-02-23 19:03:21,953 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.5917, dev_err=21.05%, es_counter1=1, es_counter2=1
2026-02-23 19:03:24,267 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.5816, dev_err=21.93%, es_counter1=2, es_counter2=2
2026-02-23 19:03:26,663 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.6106, dev_err=19.74%, es_counter1=0, es_counter2=0
2026-02-23 19:03:28,967 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.6012, dev_err=20.18%, es_counter1=1, es_counter2=1
2026-02-23 19:03:31,265 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.6069, dev_err=20.18%, es_counter1=2, es_counter2=2
2026-02-23 19:03:33,598 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.6139, dev_err=19.74%, es_counter1=0, es_counter2=0
2026-02-23 19:03:35,871 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.5994, dev_err=20.61%, es_counter1=1, es_counter2=1
2026-02-23 19:03:38,145 - lg_cotrain - INFO - Phase 3 epoch 14: dev_macro_f1=0.5947, dev_err=21.05%, es_counter1=2, es_counter2=2
2026-02-23 19:03:40,424 - lg_cotrain - INFO - Phase 3 epoch 15: dev_macro_f1=0.5947, dev_err=21.05%, es_counter1=3, es_counter2=3
2026-02-23 19:03:42,696 - lg_cotrain - INFO - Phase 3 epoch 16: dev_macro_f1=0.5995, dev_err=20.61%, es_counter1=4, es_counter2=4
2026-02-23 19:03:44,977 - lg_cotrain - INFO - Phase 3 epoch 17: dev_macro_f1=0.5894, dev_err=21.49%, es_counter1=5, es_counter2=5
2026-02-23 19:03:47,297 - lg_cotrain - INFO - Phase 3 epoch 18: dev_macro_f1=0.5917, dev_err=21.05%, es_counter1=6, es_counter2=6
2026-02-23 19:03:49,576 - lg_cotrain - INFO - Phase 3 epoch 19: dev_macro_f1=0.5941, dev_err=21.05%, es_counter1=7, es_counter2=7
2026-02-23 19:03:51,851 - lg_cotrain - INFO - Phase 3 epoch 20: dev_macro_f1=0.5925, dev_err=21.05%, es_counter1=8, es_counter2=8
2026-02-23 19:03:54,125 - lg_cotrain - INFO - Phase 3 epoch 21: dev_macro_f1=0.5967, dev_err=21.05%, es_counter1=9, es_counter2=9
2026-02-23 19:03:54,125 - lg_cotrain - INFO - Early stopping at epoch 21
2026-02-23 19:03:54,142 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 19:03:56,144 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpwpcxhend\canada_wildfires_2016\50_set3\metrics.json
2026-02-23 19:03:56,144 - lg_cotrain - INFO - Test error rate: 22.02%, Test macro-F1: 0.5783, Test ECE: 0.0619
2026-02-23 19:03:56,156 - lg_cotrain - INFO - --- Trial 1/10 done: dev_macro_f1=0.6139 ---
2026-02-23 19:03:56,156 - lg_cotrain - INFO - --- Trial 2/10 ---
2026-02-23 19:03:56,741 - lg_cotrain - INFO - Starting LG-CoTrain: event=canada_wildfires_2016, budget=50, seed_set=3
2026-02-23 19:03:56,757 - lg_cotrain - INFO - Detected 8 classes for event canada_wildfires_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 19:03:56,762 - lg_cotrain - INFO - D_l1: 182, D_l2: 182, D_LG: 1205
2026-02-23 19:03:56,763 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 19:04:04,451 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1783, mean_prob2=0.1301
2026-02-23 19:04:11,165 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1954, mean_prob2=0.2965
2026-02-23 19:04:17,805 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.3755, mean_prob2=0.4600
2026-02-23 19:04:24,524 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.5054, mean_prob2=0.5848
2026-02-23 19:04:31,159 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.6458, mean_prob2=0.5946
2026-02-23 19:04:37,805 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.6511, mean_prob2=0.6627
2026-02-23 19:04:44,488 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.6196, mean_prob2=0.6240
2026-02-23 19:04:44,489 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 19:04:45,461 - lg_cotrain - INFO - LR scheduler: total_steps_1=4112, warmup=948; total_steps_2=4112, warmup=948
2026-02-23 19:04:45,462 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.6196, range=[0.0023, 0.9726]
2026-02-23 19:04:45,462 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.6240, range=[0.0019, 0.9791]
2026-02-23 19:05:05,600 - lg_cotrain - INFO - Phase 2 epoch 1/12: loss1=1.0346, loss2=1.1079, dev_macro_f1=0.1627, dev_err=45.18%
2026-02-23 19:05:25,566 - lg_cotrain - INFO - Phase 2 epoch 2/12: loss1=0.1746, loss2=0.5775, dev_macro_f1=0.2572, dev_err=36.40%
2026-02-23 19:05:45,426 - lg_cotrain - INFO - Phase 2 epoch 3/12: loss1=0.0910, loss2=0.2578, dev_macro_f1=0.3982, dev_err=28.07%
2026-02-23 19:06:05,211 - lg_cotrain - INFO - Phase 2 epoch 4/12: loss1=0.0578, loss2=0.1314, dev_macro_f1=0.4624, dev_err=22.81%
2026-02-23 19:06:25,036 - lg_cotrain - INFO - Phase 2 epoch 5/12: loss1=0.0395, loss2=0.1347, dev_macro_f1=0.5097, dev_err=23.25%
2026-02-23 19:06:44,828 - lg_cotrain - INFO - Phase 2 epoch 6/12: loss1=0.0608, loss2=0.0778, dev_macro_f1=0.4789, dev_err=24.56%
2026-02-23 19:07:04,696 - lg_cotrain - INFO - Phase 2 epoch 7/12: loss1=0.0853, loss2=0.1151, dev_macro_f1=0.4853, dev_err=22.81%
2026-02-23 19:07:24,514 - lg_cotrain - INFO - Phase 2 epoch 8/12: loss1=0.0495, loss2=0.0566, dev_macro_f1=0.5167, dev_err=22.37%
2026-02-23 19:07:44,400 - lg_cotrain - INFO - Phase 2 epoch 9/12: loss1=0.0161, loss2=0.1078, dev_macro_f1=0.4815, dev_err=25.88%
2026-02-23 19:08:04,290 - lg_cotrain - INFO - Phase 2 epoch 10/12: loss1=0.0137, loss2=0.0437, dev_macro_f1=0.5076, dev_err=24.56%
2026-02-23 19:08:24,140 - lg_cotrain - INFO - Phase 2 epoch 11/12: loss1=0.0243, loss2=0.0116, dev_macro_f1=0.5084, dev_err=24.12%
2026-02-23 19:08:44,124 - lg_cotrain - INFO - Phase 2 epoch 12/12: loss1=0.0124, loss2=0.0083, dev_macro_f1=0.5194, dev_err=23.68%
2026-02-23 19:08:44,124 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 19:08:47,211 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.5204, dev_err=27.63%, es_counter1=0, es_counter2=0
2026-02-23 19:08:50,226 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.5379, dev_err=27.19%, es_counter1=0, es_counter2=0
2026-02-23 19:08:53,257 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.5657, dev_err=26.32%, es_counter1=0, es_counter2=0
2026-02-23 19:08:56,350 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.6602, dev_err=21.05%, es_counter1=0, es_counter2=0
2026-02-23 19:08:59,425 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.6661, dev_err=22.81%, es_counter1=0, es_counter2=0
2026-02-23 19:09:02,534 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.6784, dev_err=21.05%, es_counter1=0, es_counter2=0
2026-02-23 19:09:05,561 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.6729, dev_err=21.93%, es_counter1=1, es_counter2=1
2026-02-23 19:09:08,571 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.6570, dev_err=21.93%, es_counter1=2, es_counter2=2
2026-02-23 19:09:11,594 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.6463, dev_err=22.81%, es_counter1=3, es_counter2=3
2026-02-23 19:09:14,637 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.6646, dev_err=21.93%, es_counter1=4, es_counter2=4
2026-02-23 19:09:17,636 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.6320, dev_err=24.12%, es_counter1=5, es_counter2=5
2026-02-23 19:09:17,636 - lg_cotrain - INFO - Early stopping at epoch 11
2026-02-23 19:09:17,647 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 19:09:19,952 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpxr560m08\canada_wildfires_2016\50_set3\metrics.json
2026-02-23 19:09:19,953 - lg_cotrain - INFO - Test error rate: 23.60%, Test macro-F1: 0.6235, Test ECE: 0.0672
2026-02-23 19:09:19,963 - lg_cotrain - INFO - --- Trial 2/10 done: dev_macro_f1=0.6784 ---
2026-02-23 19:09:19,963 - lg_cotrain - INFO - --- Trial 3/10 ---
2026-02-23 19:09:20,522 - lg_cotrain - INFO - Starting LG-CoTrain: event=canada_wildfires_2016, budget=50, seed_set=3
2026-02-23 19:09:20,532 - lg_cotrain - INFO - Detected 8 classes for event canada_wildfires_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 19:09:20,532 - lg_cotrain - INFO - D_l1: 182, D_l2: 182, D_LG: 1205
2026-02-23 19:09:20,532 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 19:09:26,998 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1254, mean_prob2=0.1407
2026-02-23 19:09:32,319 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1417, mean_prob2=0.1625
2026-02-23 19:09:37,609 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1501, mean_prob2=0.1735
2026-02-23 19:09:42,911 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1730, mean_prob2=0.1770
2026-02-23 19:09:48,242 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1672, mean_prob2=0.1969
2026-02-23 19:09:53,593 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.2071, mean_prob2=0.2053
2026-02-23 19:09:58,876 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.2155, mean_prob2=0.2365
2026-02-23 19:09:58,876 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 19:09:59,892 - lg_cotrain - INFO - LR scheduler: total_steps_1=790, warmup=30; total_steps_2=790, warmup=30
2026-02-23 19:09:59,892 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.2155, range=[0.0249, 0.4182]
2026-02-23 19:09:59,893 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.2365, range=[0.0373, 0.4314]
2026-02-23 19:10:15,076 - lg_cotrain - INFO - Phase 2 epoch 1/5: loss1=0.4004, loss2=0.3779, dev_macro_f1=0.1615, dev_err=46.05%
2026-02-23 19:10:30,150 - lg_cotrain - INFO - Phase 2 epoch 2/5: loss1=0.1540, loss2=0.2612, dev_macro_f1=0.1669, dev_err=44.30%
2026-02-23 19:10:45,223 - lg_cotrain - INFO - Phase 2 epoch 3/5: loss1=0.0935, loss2=0.1524, dev_macro_f1=0.2499, dev_err=38.16%
2026-02-23 19:11:00,342 - lg_cotrain - INFO - Phase 2 epoch 4/5: loss1=0.0600, loss2=0.1060, dev_macro_f1=0.3674, dev_err=30.70%
2026-02-23 19:11:15,475 - lg_cotrain - INFO - Phase 2 epoch 5/5: loss1=0.0405, loss2=0.0906, dev_macro_f1=0.4019, dev_err=28.51%
2026-02-23 19:11:15,475 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 19:11:17,771 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.5344, dev_err=25.44%, es_counter1=0, es_counter2=0
2026-02-23 19:11:20,059 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.5793, dev_err=20.61%, es_counter1=0, es_counter2=0
2026-02-23 19:11:22,470 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.5935, dev_err=20.18%, es_counter1=0, es_counter2=0
2026-02-23 19:11:24,744 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.5713, dev_err=22.81%, es_counter1=1, es_counter2=1
2026-02-23 19:11:27,035 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.6028, dev_err=20.61%, es_counter1=0, es_counter2=0
2026-02-23 19:11:29,303 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.5711, dev_err=23.25%, es_counter1=1, es_counter2=1
2026-02-23 19:11:31,599 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.6164, dev_err=19.30%, es_counter1=0, es_counter2=0
2026-02-23 19:11:33,871 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.5980, dev_err=20.61%, es_counter1=1, es_counter2=1
2026-02-23 19:11:36,143 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.5869, dev_err=21.05%, es_counter1=2, es_counter2=2
2026-02-23 19:11:38,397 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.6023, dev_err=20.18%, es_counter1=3, es_counter2=3
2026-02-23 19:11:40,663 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.6117, dev_err=19.74%, es_counter1=4, es_counter2=4
2026-02-23 19:11:42,944 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.6833, dev_err=20.18%, es_counter1=0, es_counter2=0
2026-02-23 19:11:45,207 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.6497, dev_err=20.61%, es_counter1=1, es_counter2=1
2026-02-23 19:11:47,474 - lg_cotrain - INFO - Phase 3 epoch 14: dev_macro_f1=0.6463, dev_err=20.61%, es_counter1=2, es_counter2=2
2026-02-23 19:11:49,744 - lg_cotrain - INFO - Phase 3 epoch 15: dev_macro_f1=0.6318, dev_err=22.81%, es_counter1=3, es_counter2=3
2026-02-23 19:11:52,020 - lg_cotrain - INFO - Phase 3 epoch 16: dev_macro_f1=0.6739, dev_err=21.49%, es_counter1=4, es_counter2=4
2026-02-23 19:11:54,325 - lg_cotrain - INFO - Phase 3 epoch 17: dev_macro_f1=0.6966, dev_err=19.74%, es_counter1=0, es_counter2=0
2026-02-23 19:11:56,584 - lg_cotrain - INFO - Phase 3 epoch 18: dev_macro_f1=0.6589, dev_err=21.49%, es_counter1=1, es_counter2=1
2026-02-23 19:11:58,843 - lg_cotrain - INFO - Phase 3 epoch 19: dev_macro_f1=0.6635, dev_err=21.05%, es_counter1=2, es_counter2=2
2026-02-23 19:12:01,116 - lg_cotrain - INFO - Phase 3 epoch 20: dev_macro_f1=0.6766, dev_err=20.61%, es_counter1=3, es_counter2=3
2026-02-23 19:12:03,386 - lg_cotrain - INFO - Phase 3 epoch 21: dev_macro_f1=0.6679, dev_err=20.61%, es_counter1=4, es_counter2=4
2026-02-23 19:12:05,657 - lg_cotrain - INFO - Phase 3 epoch 22: dev_macro_f1=0.6635, dev_err=21.05%, es_counter1=5, es_counter2=5
2026-02-23 19:12:07,910 - lg_cotrain - INFO - Phase 3 epoch 23: dev_macro_f1=0.6650, dev_err=21.05%, es_counter1=6, es_counter2=6
2026-02-23 19:12:10,182 - lg_cotrain - INFO - Phase 3 epoch 24: dev_macro_f1=0.6592, dev_err=21.49%, es_counter1=7, es_counter2=7
2026-02-23 19:12:12,459 - lg_cotrain - INFO - Phase 3 epoch 25: dev_macro_f1=0.6592, dev_err=21.49%, es_counter1=8, es_counter2=8
2026-02-23 19:12:14,727 - lg_cotrain - INFO - Phase 3 epoch 26: dev_macro_f1=0.6577, dev_err=21.49%, es_counter1=9, es_counter2=9
2026-02-23 19:12:16,990 - lg_cotrain - INFO - Phase 3 epoch 27: dev_macro_f1=0.6635, dev_err=21.05%, es_counter1=10, es_counter2=10
2026-02-23 19:12:16,990 - lg_cotrain - INFO - Early stopping at epoch 27
2026-02-23 19:12:17,001 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 19:12:18,960 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpwzbdc7dl\canada_wildfires_2016\50_set3\metrics.json
2026-02-23 19:12:18,961 - lg_cotrain - INFO - Test error rate: 22.92%, Test macro-F1: 0.6007, Test ECE: 0.0744
2026-02-23 19:12:18,971 - lg_cotrain - INFO - --- Trial 3/10 done: dev_macro_f1=0.6966 ---
2026-02-23 19:12:18,971 - lg_cotrain - INFO - --- Trial 4/10 ---
2026-02-23 19:12:19,554 - lg_cotrain - INFO - Starting LG-CoTrain: event=canada_wildfires_2016, budget=50, seed_set=3
2026-02-23 19:12:19,567 - lg_cotrain - INFO - Detected 8 classes for event canada_wildfires_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 19:12:19,576 - lg_cotrain - INFO - D_l1: 182, D_l2: 182, D_LG: 1205
2026-02-23 19:12:19,578 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 19:12:25,922 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1235, mean_prob2=0.1473
2026-02-23 19:12:31,272 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1538, mean_prob2=0.1700
2026-02-23 19:12:36,569 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1579, mean_prob2=0.1861
2026-02-23 19:12:41,876 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1889, mean_prob2=0.2059
2026-02-23 19:12:47,168 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1981, mean_prob2=0.2365
2026-02-23 19:12:52,507 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.2525, mean_prob2=0.2947
2026-02-23 19:12:57,811 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.2824, mean_prob2=0.3494
2026-02-23 19:12:57,821 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 19:12:58,805 - lg_cotrain - INFO - LR scheduler: total_steps_1=1360, warmup=93; total_steps_2=1360, warmup=93
2026-02-23 19:12:58,805 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.2824, range=[0.0172, 0.5227]
2026-02-23 19:12:58,805 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.3494, range=[0.0299, 0.6540]
2026-02-23 19:13:13,876 - lg_cotrain - INFO - Phase 2 epoch 1/20: loss1=0.6154, loss2=0.5322, dev_macro_f1=0.1360, dev_err=51.75%
2026-02-23 19:13:28,972 - lg_cotrain - INFO - Phase 2 epoch 2/20: loss1=0.2182, loss2=0.3568, dev_macro_f1=0.1681, dev_err=43.86%
2026-02-23 19:13:44,057 - lg_cotrain - INFO - Phase 2 epoch 3/20: loss1=0.1150, loss2=0.2053, dev_macro_f1=0.2037, dev_err=41.23%
2026-02-23 19:13:59,105 - lg_cotrain - INFO - Phase 2 epoch 4/20: loss1=0.0650, loss2=0.1093, dev_macro_f1=0.3850, dev_err=29.82%
2026-02-23 19:14:14,191 - lg_cotrain - INFO - Phase 2 epoch 5/20: loss1=0.0393, loss2=0.0810, dev_macro_f1=0.4078, dev_err=27.63%
2026-02-23 19:14:29,412 - lg_cotrain - INFO - Phase 2 epoch 6/20: loss1=0.0374, loss2=0.0631, dev_macro_f1=0.4646, dev_err=22.81%
2026-02-23 19:14:44,781 - lg_cotrain - INFO - Phase 2 epoch 7/20: loss1=0.0268, loss2=0.0573, dev_macro_f1=0.4716, dev_err=24.12%
2026-02-23 19:14:59,858 - lg_cotrain - INFO - Phase 2 epoch 8/20: loss1=0.0194, loss2=0.0759, dev_macro_f1=0.4258, dev_err=26.32%
2026-02-23 19:15:15,109 - lg_cotrain - INFO - Phase 2 epoch 9/20: loss1=0.0172, loss2=0.0545, dev_macro_f1=0.4910, dev_err=22.37%
2026-02-23 19:15:30,315 - lg_cotrain - INFO - Phase 2 epoch 10/20: loss1=0.0128, loss2=0.0328, dev_macro_f1=0.5029, dev_err=23.25%
2026-02-23 19:15:45,911 - lg_cotrain - INFO - Phase 2 epoch 11/20: loss1=0.0109, loss2=0.0266, dev_macro_f1=0.4934, dev_err=23.25%
2026-02-23 19:16:01,364 - lg_cotrain - INFO - Phase 2 epoch 12/20: loss1=0.0125, loss2=0.0185, dev_macro_f1=0.4982, dev_err=23.25%
2026-02-23 19:16:16,535 - lg_cotrain - INFO - Phase 2 epoch 13/20: loss1=0.0215, loss2=0.0175, dev_macro_f1=0.4971, dev_err=24.12%
2026-02-23 19:16:31,609 - lg_cotrain - INFO - Phase 2 epoch 14/20: loss1=0.0252, loss2=0.0117, dev_macro_f1=0.4996, dev_err=23.68%
2026-02-23 19:16:46,755 - lg_cotrain - INFO - Phase 2 epoch 15/20: loss1=0.0121, loss2=0.0095, dev_macro_f1=0.5005, dev_err=24.12%
2026-02-23 19:17:02,031 - lg_cotrain - INFO - Phase 2 epoch 16/20: loss1=0.0083, loss2=0.0144, dev_macro_f1=0.5106, dev_err=22.37%
2026-02-23 19:17:17,323 - lg_cotrain - INFO - Phase 2 epoch 17/20: loss1=0.0082, loss2=0.0110, dev_macro_f1=0.5055, dev_err=23.68%
2026-02-23 19:17:32,623 - lg_cotrain - INFO - Phase 2 epoch 18/20: loss1=0.0082, loss2=0.0191, dev_macro_f1=0.5111, dev_err=22.81%
2026-02-23 19:17:47,875 - lg_cotrain - INFO - Phase 2 epoch 19/20: loss1=0.0093, loss2=0.0109, dev_macro_f1=0.5131, dev_err=23.68%
2026-02-23 19:18:03,134 - lg_cotrain - INFO - Phase 2 epoch 20/20: loss1=0.0078, loss2=0.0064, dev_macro_f1=0.5116, dev_err=23.68%
2026-02-23 19:18:03,134 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 19:18:05,446 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.5037, dev_err=30.26%, es_counter1=0, es_counter2=0
2026-02-23 19:18:07,771 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.5587, dev_err=25.88%, es_counter1=0, es_counter2=0
2026-02-23 19:18:10,098 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.5732, dev_err=22.37%, es_counter1=0, es_counter2=0
2026-02-23 19:18:12,417 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.5847, dev_err=21.93%, es_counter1=0, es_counter2=0
2026-02-23 19:18:14,716 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.5962, dev_err=21.05%, es_counter1=0, es_counter2=0
2026-02-23 19:18:16,996 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.5799, dev_err=21.49%, es_counter1=1, es_counter2=1
2026-02-23 19:18:19,295 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.6008, dev_err=20.61%, es_counter1=0, es_counter2=0
2026-02-23 19:18:21,602 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.6243, dev_err=19.30%, es_counter1=0, es_counter2=0
2026-02-23 19:18:23,907 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.6164, dev_err=20.18%, es_counter1=1, es_counter2=1
2026-02-23 19:18:26,200 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.6116, dev_err=20.61%, es_counter1=2, es_counter2=2
2026-02-23 19:18:28,506 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.6077, dev_err=20.18%, es_counter1=3, es_counter2=3
2026-02-23 19:18:30,826 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.6048, dev_err=20.61%, es_counter1=4, es_counter2=4
2026-02-23 19:18:33,112 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.6056, dev_err=20.61%, es_counter1=5, es_counter2=5
2026-02-23 19:18:33,112 - lg_cotrain - INFO - Early stopping at epoch 13
2026-02-23 19:18:33,124 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 19:18:35,114 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmptb8y2okg\canada_wildfires_2016\50_set3\metrics.json
2026-02-23 19:18:35,114 - lg_cotrain - INFO - Test error rate: 21.80%, Test macro-F1: 0.5840, Test ECE: 0.0933
2026-02-23 19:18:35,128 - lg_cotrain - INFO - --- Trial 4/10 done: dev_macro_f1=0.6243 ---
2026-02-23 19:18:35,129 - lg_cotrain - INFO - --- Trial 5/10 ---
2026-02-23 19:18:35,697 - lg_cotrain - INFO - Starting LG-CoTrain: event=canada_wildfires_2016, budget=50, seed_set=3
2026-02-23 19:18:35,710 - lg_cotrain - INFO - Detected 8 classes for event canada_wildfires_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 19:18:35,715 - lg_cotrain - INFO - D_l1: 182, D_l2: 182, D_LG: 1205
2026-02-23 19:18:35,716 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 19:18:42,046 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1328, mean_prob2=0.1551
2026-02-23 19:18:47,406 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1532, mean_prob2=0.1923
2026-02-23 19:18:52,766 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.2700, mean_prob2=0.2625
2026-02-23 19:18:58,138 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.4122, mean_prob2=0.4263
2026-02-23 19:19:03,433 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.5375, mean_prob2=0.5710
2026-02-23 19:19:08,733 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.6404, mean_prob2=0.6300
2026-02-23 19:19:14,045 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.6095, mean_prob2=0.6631
2026-02-23 19:19:14,045 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 19:19:15,021 - lg_cotrain - INFO - LR scheduler: total_steps_1=1322, warmup=315; total_steps_2=1322, warmup=315
2026-02-23 19:19:15,021 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.6095, range=[0.0028, 0.9651]
2026-02-23 19:19:15,021 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.6631, range=[0.0039, 0.9714]
2026-02-23 19:19:30,067 - lg_cotrain - INFO - Phase 2 epoch 1/19: loss1=1.1740, loss2=1.1655, dev_macro_f1=0.1505, dev_err=48.25%
2026-02-23 19:19:45,154 - lg_cotrain - INFO - Phase 2 epoch 2/19: loss1=0.2171, loss2=0.7455, dev_macro_f1=0.1673, dev_err=44.30%
2026-02-23 19:20:00,207 - lg_cotrain - INFO - Phase 2 epoch 3/19: loss1=0.1316, loss2=0.3525, dev_macro_f1=0.2172, dev_err=40.79%
2026-02-23 19:20:15,287 - lg_cotrain - INFO - Phase 2 epoch 4/19: loss1=0.0813, loss2=0.1739, dev_macro_f1=0.3970, dev_err=28.51%
2026-02-23 19:20:30,356 - lg_cotrain - INFO - Phase 2 epoch 5/19: loss1=0.0510, loss2=0.1018, dev_macro_f1=0.4614, dev_err=25.44%
2026-02-23 19:20:45,453 - lg_cotrain - INFO - Phase 2 epoch 6/19: loss1=0.0418, loss2=0.0848, dev_macro_f1=0.4432, dev_err=26.32%
2026-02-23 19:21:00,574 - lg_cotrain - INFO - Phase 2 epoch 7/19: loss1=0.0302, loss2=0.1345, dev_macro_f1=0.4619, dev_err=23.25%
2026-02-23 19:21:15,819 - lg_cotrain - INFO - Phase 2 epoch 8/19: loss1=0.0165, loss2=0.0755, dev_macro_f1=0.4887, dev_err=24.56%
2026-02-23 19:21:31,029 - lg_cotrain - INFO - Phase 2 epoch 9/19: loss1=0.0126, loss2=0.1241, dev_macro_f1=0.4804, dev_err=23.25%
2026-02-23 19:21:46,248 - lg_cotrain - INFO - Phase 2 epoch 10/19: loss1=0.0511, loss2=0.0932, dev_macro_f1=0.5031, dev_err=22.81%
2026-02-23 19:22:01,800 - lg_cotrain - INFO - Phase 2 epoch 11/19: loss1=0.0493, loss2=0.0643, dev_macro_f1=0.4624, dev_err=23.68%
2026-02-23 19:22:17,089 - lg_cotrain - INFO - Phase 2 epoch 12/19: loss1=0.0368, loss2=0.0615, dev_macro_f1=0.4737, dev_err=23.68%
2026-02-23 19:22:32,451 - lg_cotrain - INFO - Phase 2 epoch 13/19: loss1=0.0254, loss2=0.0338, dev_macro_f1=0.5397, dev_err=20.61%
2026-02-23 19:22:47,605 - lg_cotrain - INFO - Phase 2 epoch 14/19: loss1=0.0625, loss2=0.0324, dev_macro_f1=0.5121, dev_err=22.37%
2026-02-23 19:23:02,805 - lg_cotrain - INFO - Phase 2 epoch 15/19: loss1=0.0354, loss2=0.0176, dev_macro_f1=0.5270, dev_err=21.93%
2026-02-23 19:23:17,950 - lg_cotrain - INFO - Phase 2 epoch 16/19: loss1=0.0202, loss2=0.0192, dev_macro_f1=0.5565, dev_err=19.30%
2026-02-23 19:23:33,047 - lg_cotrain - INFO - Phase 2 epoch 17/19: loss1=0.0180, loss2=0.0096, dev_macro_f1=0.5549, dev_err=19.74%
2026-02-23 19:23:48,156 - lg_cotrain - INFO - Phase 2 epoch 18/19: loss1=0.0319, loss2=0.0093, dev_macro_f1=0.5877, dev_err=20.18%
2026-02-23 19:24:07,033 - lg_cotrain - INFO - Phase 2 epoch 19/19: loss1=0.0145, loss2=0.0182, dev_macro_f1=0.5497, dev_err=20.61%
2026-02-23 19:24:07,034 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 19:24:09,326 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.4940, dev_err=29.39%, es_counter1=0, es_counter2=0
2026-02-23 19:24:11,617 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.5442, dev_err=22.37%, es_counter1=0, es_counter2=0
2026-02-23 19:24:13,903 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.5770, dev_err=23.25%, es_counter1=0, es_counter2=0
2026-02-23 19:24:16,176 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.5735, dev_err=24.12%, es_counter1=1, es_counter2=1
2026-02-23 19:24:18,473 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.5989, dev_err=23.68%, es_counter1=0, es_counter2=0
2026-02-23 19:24:20,769 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.7033, dev_err=22.37%, es_counter1=0, es_counter2=0
2026-02-23 19:24:23,028 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.6430, dev_err=24.12%, es_counter1=1, es_counter2=1
2026-02-23 19:24:25,295 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.6457, dev_err=22.37%, es_counter1=2, es_counter2=2
2026-02-23 19:24:27,570 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.6454, dev_err=22.81%, es_counter1=3, es_counter2=3
2026-02-23 19:24:29,850 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.6364, dev_err=23.68%, es_counter1=4, es_counter2=4
2026-02-23 19:24:32,130 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.6337, dev_err=23.68%, es_counter1=5, es_counter2=5
2026-02-23 19:24:34,408 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.6277, dev_err=23.68%, es_counter1=6, es_counter2=6
2026-02-23 19:24:36,685 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.6470, dev_err=22.81%, es_counter1=7, es_counter2=7
2026-02-23 19:24:36,685 - lg_cotrain - INFO - Early stopping at epoch 13
2026-02-23 19:24:36,701 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 19:24:38,672 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpn75dfpo3\canada_wildfires_2016\50_set3\metrics.json
2026-02-23 19:24:38,672 - lg_cotrain - INFO - Test error rate: 24.94%, Test macro-F1: 0.5725, Test ECE: 0.0883
2026-02-23 19:24:38,684 - lg_cotrain - INFO - --- Trial 5/10 done: dev_macro_f1=0.7033 ---
2026-02-23 19:24:38,684 - lg_cotrain - INFO - --- Trial 6/10 ---
2026-02-23 19:24:39,263 - lg_cotrain - INFO - Starting LG-CoTrain: event=canada_wildfires_2016, budget=50, seed_set=3
2026-02-23 19:24:39,271 - lg_cotrain - INFO - Detected 8 classes for event canada_wildfires_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 19:24:39,279 - lg_cotrain - INFO - D_l1: 182, D_l2: 182, D_LG: 1205
2026-02-23 19:24:39,279 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 19:24:45,536 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1466, mean_prob2=0.1592
2026-02-23 19:24:50,848 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1588, mean_prob2=0.1901
2026-02-23 19:24:56,154 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.2123, mean_prob2=0.2609
2026-02-23 19:25:01,486 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.4174, mean_prob2=0.4450
2026-02-23 19:25:06,823 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.5995, mean_prob2=0.5932
2026-02-23 19:25:12,153 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.6146, mean_prob2=0.6094
2026-02-23 19:25:17,481 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.6861, mean_prob2=0.6106
2026-02-23 19:25:17,481 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 19:25:18,521 - lg_cotrain - INFO - LR scheduler: total_steps_1=1132, warmup=13; total_steps_2=1132, warmup=13
2026-02-23 19:25:18,521 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.6861, range=[0.0005, 0.9913]
2026-02-23 19:25:18,521 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.6106, range=[0.0007, 0.9824]
2026-02-23 19:25:33,696 - lg_cotrain - INFO - Phase 2 epoch 1/14: loss1=0.6956, loss2=0.7253, dev_macro_f1=0.3527, dev_err=30.70%
2026-02-23 19:25:48,907 - lg_cotrain - INFO - Phase 2 epoch 2/14: loss1=0.1094, loss2=0.2893, dev_macro_f1=0.4130, dev_err=28.07%
2026-02-23 19:26:04,077 - lg_cotrain - INFO - Phase 2 epoch 3/14: loss1=0.0776, loss2=0.2901, dev_macro_f1=0.4619, dev_err=25.44%
2026-02-23 19:26:19,362 - lg_cotrain - INFO - Phase 2 epoch 4/14: loss1=0.0453, loss2=0.2942, dev_macro_f1=0.4365, dev_err=25.88%
2026-02-23 19:26:34,498 - lg_cotrain - INFO - Phase 2 epoch 5/14: loss1=0.0406, loss2=0.2970, dev_macro_f1=0.4371, dev_err=25.88%
2026-02-23 19:26:49,639 - lg_cotrain - INFO - Phase 2 epoch 6/14: loss1=0.0440, loss2=0.1600, dev_macro_f1=0.4712, dev_err=22.81%
2026-02-23 19:27:04,695 - lg_cotrain - INFO - Phase 2 epoch 7/14: loss1=0.0271, loss2=0.1839, dev_macro_f1=0.5203, dev_err=21.49%
2026-02-23 19:27:19,802 - lg_cotrain - INFO - Phase 2 epoch 8/14: loss1=0.0236, loss2=0.1509, dev_macro_f1=0.4709, dev_err=25.00%
2026-02-23 19:27:34,889 - lg_cotrain - INFO - Phase 2 epoch 9/14: loss1=0.0234, loss2=0.3037, dev_macro_f1=0.4888, dev_err=22.81%
2026-02-23 19:27:49,951 - lg_cotrain - INFO - Phase 2 epoch 10/14: loss1=0.0170, loss2=0.3154, dev_macro_f1=0.5261, dev_err=21.49%
2026-02-23 19:28:05,028 - lg_cotrain - INFO - Phase 2 epoch 11/14: loss1=0.0159, loss2=0.2479, dev_macro_f1=0.4899, dev_err=22.37%
2026-02-23 19:28:20,161 - lg_cotrain - INFO - Phase 2 epoch 12/14: loss1=0.0173, loss2=0.1944, dev_macro_f1=0.4625, dev_err=22.37%
2026-02-23 19:28:35,248 - lg_cotrain - INFO - Phase 2 epoch 13/14: loss1=0.0161, loss2=0.1334, dev_macro_f1=0.4838, dev_err=23.25%
2026-02-23 19:28:50,338 - lg_cotrain - INFO - Phase 2 epoch 14/14: loss1=0.0252, loss2=0.0945, dev_macro_f1=0.4814, dev_err=23.68%
2026-02-23 19:28:50,338 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 19:28:52,626 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.4907, dev_err=32.46%, es_counter1=0, es_counter2=0
2026-02-23 19:28:54,918 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.5688, dev_err=23.68%, es_counter1=0, es_counter2=0
2026-02-23 19:28:57,210 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.6075, dev_err=21.05%, es_counter1=0, es_counter2=0
2026-02-23 19:28:59,481 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.5813, dev_err=24.12%, es_counter1=1, es_counter2=1
2026-02-23 19:29:01,762 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.5787, dev_err=23.68%, es_counter1=2, es_counter2=2
2026-02-23 19:29:04,062 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.6208, dev_err=20.61%, es_counter1=0, es_counter2=0
2026-02-23 19:29:06,341 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.5941, dev_err=22.37%, es_counter1=1, es_counter2=1
2026-02-23 19:29:08,626 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.6879, dev_err=21.49%, es_counter1=0, es_counter2=0
2026-02-23 19:29:10,908 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.6034, dev_err=25.00%, es_counter1=1, es_counter2=1
2026-02-23 19:29:13,183 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.6506, dev_err=21.49%, es_counter1=2, es_counter2=2
2026-02-23 19:29:15,448 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.6015, dev_err=21.93%, es_counter1=3, es_counter2=3
2026-02-23 19:29:17,725 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.6058, dev_err=22.81%, es_counter1=4, es_counter2=4
2026-02-23 19:29:19,999 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.5520, dev_err=29.39%, es_counter1=5, es_counter2=5
2026-02-23 19:29:19,999 - lg_cotrain - INFO - Early stopping at epoch 13
2026-02-23 19:29:20,008 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 19:29:21,977 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmp8r22lfiq\canada_wildfires_2016\50_set3\metrics.json
2026-02-23 19:29:21,978 - lg_cotrain - INFO - Test error rate: 30.56%, Test macro-F1: 0.5288, Test ECE: 0.0750
2026-02-23 19:29:21,989 - lg_cotrain - INFO - --- Trial 6/10 done: dev_macro_f1=0.6879 ---
2026-02-23 19:29:21,989 - lg_cotrain - INFO - --- Trial 7/10 ---
2026-02-23 19:29:22,585 - lg_cotrain - INFO - Starting LG-CoTrain: event=canada_wildfires_2016, budget=50, seed_set=3
2026-02-23 19:29:22,595 - lg_cotrain - INFO - Detected 8 classes for event canada_wildfires_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 19:29:22,600 - lg_cotrain - INFO - D_l1: 182, D_l2: 182, D_LG: 1205
2026-02-23 19:29:22,600 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 19:29:29,822 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1289, mean_prob2=0.1474
2026-02-23 19:29:35,745 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1301, mean_prob2=0.1860
2026-02-23 19:29:41,672 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1707, mean_prob2=0.2117
2026-02-23 19:29:47,657 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.2039, mean_prob2=0.2617
2026-02-23 19:29:53,575 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.2238, mean_prob2=0.3039
2026-02-23 19:29:59,518 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.3093, mean_prob2=0.4184
2026-02-23 19:30:05,574 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.3713, mean_prob2=0.4263
2026-02-23 19:30:05,574 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 19:30:06,641 - lg_cotrain - INFO - LR scheduler: total_steps_1=1732, warmup=219; total_steps_2=1732, warmup=219
2026-02-23 19:30:06,641 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.3713, range=[0.0129, 0.6129]
2026-02-23 19:30:06,641 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.4263, range=[0.0224, 0.8051]
2026-02-23 19:30:23,743 - lg_cotrain - INFO - Phase 2 epoch 1/7: loss1=0.7388, loss2=0.6782, dev_macro_f1=0.1253, dev_err=53.51%
2026-02-23 19:30:40,833 - lg_cotrain - INFO - Phase 2 epoch 2/7: loss1=0.2152, loss2=0.3883, dev_macro_f1=0.1712, dev_err=42.98%
2026-02-23 19:30:57,952 - lg_cotrain - INFO - Phase 2 epoch 3/7: loss1=0.1209, loss2=0.2109, dev_macro_f1=0.2662, dev_err=38.16%
2026-02-23 19:31:15,047 - lg_cotrain - INFO - Phase 2 epoch 4/7: loss1=0.0670, loss2=0.1190, dev_macro_f1=0.3550, dev_err=31.14%
2026-02-23 19:31:32,101 - lg_cotrain - INFO - Phase 2 epoch 5/7: loss1=0.0390, loss2=0.1051, dev_macro_f1=0.4478, dev_err=24.12%
2026-02-23 19:31:49,146 - lg_cotrain - INFO - Phase 2 epoch 6/7: loss1=0.0296, loss2=0.0806, dev_macro_f1=0.4521, dev_err=23.68%
2026-02-23 19:32:06,208 - lg_cotrain - INFO - Phase 2 epoch 7/7: loss1=0.0224, loss2=0.0547, dev_macro_f1=0.4569, dev_err=23.68%
2026-02-23 19:32:06,208 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 19:32:08,816 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.4936, dev_err=32.46%, es_counter1=0, es_counter2=0
2026-02-23 19:32:11,407 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.5571, dev_err=22.81%, es_counter1=0, es_counter2=0
2026-02-23 19:32:13,989 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.5530, dev_err=25.44%, es_counter1=1, es_counter2=1
2026-02-23 19:32:16,593 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.5796, dev_err=21.93%, es_counter1=0, es_counter2=0
2026-02-23 19:32:19,181 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.5751, dev_err=21.93%, es_counter1=1, es_counter2=1
2026-02-23 19:32:21,803 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.6498, dev_err=21.05%, es_counter1=0, es_counter2=0
2026-02-23 19:32:24,388 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.6398, dev_err=21.49%, es_counter1=1, es_counter2=1
2026-02-23 19:32:26,981 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.6540, dev_err=20.61%, es_counter1=0, es_counter2=0
2026-02-23 19:32:29,566 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.6003, dev_err=25.88%, es_counter1=1, es_counter2=1
2026-02-23 19:32:32,163 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.6679, dev_err=23.25%, es_counter1=0, es_counter2=0
2026-02-23 19:32:34,731 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.6403, dev_err=22.37%, es_counter1=1, es_counter2=1
2026-02-23 19:32:37,328 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.6325, dev_err=23.25%, es_counter1=2, es_counter2=2
2026-02-23 19:32:39,924 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.6345, dev_err=23.68%, es_counter1=3, es_counter2=3
2026-02-23 19:32:42,499 - lg_cotrain - INFO - Phase 3 epoch 14: dev_macro_f1=0.6386, dev_err=22.81%, es_counter1=4, es_counter2=4
2026-02-23 19:32:45,079 - lg_cotrain - INFO - Phase 3 epoch 15: dev_macro_f1=0.6468, dev_err=21.93%, es_counter1=5, es_counter2=5
2026-02-23 19:32:47,654 - lg_cotrain - INFO - Phase 3 epoch 16: dev_macro_f1=0.6411, dev_err=22.37%, es_counter1=6, es_counter2=6
2026-02-23 19:32:50,236 - lg_cotrain - INFO - Phase 3 epoch 17: dev_macro_f1=0.6459, dev_err=21.49%, es_counter1=7, es_counter2=7
2026-02-23 19:32:52,802 - lg_cotrain - INFO - Phase 3 epoch 18: dev_macro_f1=0.6427, dev_err=21.93%, es_counter1=8, es_counter2=8
2026-02-23 19:32:52,809 - lg_cotrain - INFO - Early stopping at epoch 18
2026-02-23 19:32:52,819 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 19:32:54,968 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpi814vmfj\canada_wildfires_2016\50_set3\metrics.json
2026-02-23 19:32:54,968 - lg_cotrain - INFO - Test error rate: 23.82%, Test macro-F1: 0.5950, Test ECE: 0.0759
2026-02-23 19:32:54,982 - lg_cotrain - INFO - --- Trial 7/10 done: dev_macro_f1=0.6679 ---
2026-02-23 19:32:54,982 - lg_cotrain - INFO - --- Trial 8/10 ---
2026-02-23 19:32:55,592 - lg_cotrain - INFO - Starting LG-CoTrain: event=canada_wildfires_2016, budget=50, seed_set=3
2026-02-23 19:32:55,606 - lg_cotrain - INFO - Detected 8 classes for event canada_wildfires_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 19:32:55,611 - lg_cotrain - INFO - D_l1: 182, D_l2: 182, D_LG: 1205
2026-02-23 19:32:55,612 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 19:33:03,229 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1467, mean_prob2=0.0943
2026-02-23 19:33:09,772 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1077, mean_prob2=0.1355
2026-02-23 19:33:16,386 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1238, mean_prob2=0.1003
2026-02-23 19:33:22,958 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1166, mean_prob2=0.1515
2026-02-23 19:33:29,578 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1355, mean_prob2=0.1268
2026-02-23 19:33:36,139 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1103, mean_prob2=0.1078
2026-02-23 19:33:42,687 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1546, mean_prob2=0.1365
2026-02-23 19:33:42,687 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 19:33:43,662 - lg_cotrain - INFO - LR scheduler: total_steps_1=5320, warmup=1277; total_steps_2=5320, warmup=1277
2026-02-23 19:33:43,662 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1546, range=[0.0600, 0.3155]
2026-02-23 19:33:43,662 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1365, range=[0.0386, 0.1696]
2026-02-23 19:34:03,471 - lg_cotrain - INFO - Phase 2 epoch 1/20: loss1=0.1794, loss2=0.1785, dev_macro_f1=0.4084, dev_err=26.75%
2026-02-23 19:34:23,287 - lg_cotrain - INFO - Phase 2 epoch 2/20: loss1=0.0635, loss2=0.3015, dev_macro_f1=0.3655, dev_err=30.70%
2026-02-23 19:34:43,092 - lg_cotrain - INFO - Phase 2 epoch 3/20: loss1=0.0893, loss2=0.6324, dev_macro_f1=0.2871, dev_err=35.53%
2026-02-23 19:35:02,844 - lg_cotrain - INFO - Phase 2 epoch 4/20: loss1=0.1717, loss2=1.1073, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 19:35:22,625 - lg_cotrain - INFO - Phase 2 epoch 5/20: loss1=0.1158, loss2=1.0561, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 19:35:42,420 - lg_cotrain - INFO - Phase 2 epoch 6/20: loss1=0.0998, loss2=0.9667, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 19:36:02,156 - lg_cotrain - INFO - Phase 2 epoch 7/20: loss1=0.0909, loss2=0.9037, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 19:36:21,998 - lg_cotrain - INFO - Phase 2 epoch 8/20: loss1=0.0852, loss2=0.8696, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 19:36:41,872 - lg_cotrain - INFO - Phase 2 epoch 9/20: loss1=0.0842, loss2=0.8391, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 19:37:01,754 - lg_cotrain - INFO - Phase 2 epoch 10/20: loss1=0.0679, loss2=0.7965, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 19:37:21,582 - lg_cotrain - INFO - Phase 2 epoch 11/20: loss1=0.0724, loss2=0.7589, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 19:37:41,377 - lg_cotrain - INFO - Phase 2 epoch 12/20: loss1=0.0666, loss2=0.7368, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 19:38:01,218 - lg_cotrain - INFO - Phase 2 epoch 13/20: loss1=0.0634, loss2=0.7085, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 19:38:20,981 - lg_cotrain - INFO - Phase 2 epoch 14/20: loss1=0.0660, loss2=0.6984, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 19:38:40,811 - lg_cotrain - INFO - Phase 2 epoch 15/20: loss1=0.0613, loss2=0.6757, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 19:39:00,606 - lg_cotrain - INFO - Phase 2 epoch 16/20: loss1=0.0617, loss2=0.6517, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 19:39:20,425 - lg_cotrain - INFO - Phase 2 epoch 17/20: loss1=0.0595, loss2=0.6387, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 19:39:40,201 - lg_cotrain - INFO - Phase 2 epoch 18/20: loss1=0.0575, loss2=0.6249, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 19:40:00,014 - lg_cotrain - INFO - Phase 2 epoch 19/20: loss1=0.0545, loss2=0.6085, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 19:40:19,816 - lg_cotrain - INFO - Phase 2 epoch 20/20: loss1=0.0532, loss2=0.5997, dev_macro_f1=0.0735, dev_err=58.33%
2026-02-23 19:40:19,816 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 19:40:22,849 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.0085, dev_err=96.49%, es_counter1=0, es_counter2=0
2026-02-23 19:40:25,872 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.0247, dev_err=89.04%, es_counter1=0, es_counter2=0
2026-02-23 19:40:28,899 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.0115, dev_err=95.18%, es_counter1=1, es_counter2=1
2026-02-23 19:40:31,918 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.0735, dev_err=58.33%, es_counter1=0, es_counter2=0
2026-02-23 19:40:34,923 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.0365, dev_err=82.89%, es_counter1=1, es_counter2=1
2026-02-23 19:40:37,919 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.0365, dev_err=82.89%, es_counter1=2, es_counter2=2
2026-02-23 19:40:40,944 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.0735, dev_err=58.33%, es_counter1=3, es_counter2=3
2026-02-23 19:40:43,961 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.0115, dev_err=95.18%, es_counter1=4, es_counter2=4
2026-02-23 19:40:46,970 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.0164, dev_err=92.98%, es_counter1=5, es_counter2=5
2026-02-23 19:40:49,985 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.0308, dev_err=85.96%, es_counter1=6, es_counter2=6
2026-02-23 19:40:52,978 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.0247, dev_err=89.04%, es_counter1=7, es_counter2=7
2026-02-23 19:40:52,978 - lg_cotrain - INFO - Early stopping at epoch 11
2026-02-23 19:40:52,988 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 19:40:55,277 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpojyb9umg\canada_wildfires_2016\50_set3\metrics.json
2026-02-23 19:40:55,277 - lg_cotrain - INFO - Test error rate: 58.20%, Test macro-F1: 0.0737, Test ECE: 0.2149
2026-02-23 19:40:55,287 - lg_cotrain - INFO - --- Trial 8/10 done: dev_macro_f1=0.0735 ---
2026-02-23 19:40:55,287 - lg_cotrain - INFO - --- Trial 9/10 ---
2026-02-23 19:40:55,850 - lg_cotrain - INFO - Starting LG-CoTrain: event=canada_wildfires_2016, budget=50, seed_set=3
2026-02-23 19:40:55,860 - lg_cotrain - INFO - Detected 8 classes for event canada_wildfires_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 19:40:55,860 - lg_cotrain - INFO - D_l1: 182, D_l2: 182, D_LG: 1205
2026-02-23 19:40:55,870 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 19:41:02,799 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1356, mean_prob2=0.1400
2026-02-23 19:41:08,855 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1730, mean_prob2=0.2179
2026-02-23 19:41:14,764 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.2268, mean_prob2=0.2719
2026-02-23 19:41:20,689 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.2895, mean_prob2=0.3827
2026-02-23 19:41:26,766 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.4048, mean_prob2=0.5174
2026-02-23 19:41:32,895 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.5101, mean_prob2=0.6075
2026-02-23 19:41:38,835 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.5748, mean_prob2=0.6068
2026-02-23 19:41:38,836 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 19:41:39,879 - lg_cotrain - INFO - LR scheduler: total_steps_1=2188, warmup=370; total_steps_2=2188, warmup=370
2026-02-23 19:41:39,879 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.5748, range=[0.0084, 0.9022]
2026-02-23 19:41:39,879 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.6068, range=[0.0048, 0.9469]
2026-02-23 19:41:56,941 - lg_cotrain - INFO - Phase 2 epoch 1/13: loss1=1.0410, loss2=1.0491, dev_macro_f1=0.1366, dev_err=51.75%
2026-02-23 19:42:14,086 - lg_cotrain - INFO - Phase 2 epoch 2/13: loss1=0.2224, loss2=0.5823, dev_macro_f1=0.1703, dev_err=43.42%
2026-02-23 19:42:31,214 - lg_cotrain - INFO - Phase 2 epoch 3/13: loss1=0.1286, loss2=0.2726, dev_macro_f1=0.2852, dev_err=34.21%
2026-02-23 19:42:48,248 - lg_cotrain - INFO - Phase 2 epoch 4/13: loss1=0.0776, loss2=0.1429, dev_macro_f1=0.4114, dev_err=27.63%
2026-02-23 19:43:05,368 - lg_cotrain - INFO - Phase 2 epoch 5/13: loss1=0.0419, loss2=0.1041, dev_macro_f1=0.4403, dev_err=25.88%
2026-02-23 19:43:22,431 - lg_cotrain - INFO - Phase 2 epoch 6/13: loss1=0.0381, loss2=0.1140, dev_macro_f1=0.4363, dev_err=25.00%
2026-02-23 19:43:39,567 - lg_cotrain - INFO - Phase 2 epoch 7/13: loss1=0.0262, loss2=0.0685, dev_macro_f1=0.4454, dev_err=25.00%
2026-02-23 19:43:56,590 - lg_cotrain - INFO - Phase 2 epoch 8/13: loss1=0.0176, loss2=0.0603, dev_macro_f1=0.4900, dev_err=22.37%
2026-02-23 19:44:13,620 - lg_cotrain - INFO - Phase 2 epoch 9/13: loss1=0.0196, loss2=0.0379, dev_macro_f1=0.4767, dev_err=23.68%
2026-02-23 19:44:30,755 - lg_cotrain - INFO - Phase 2 epoch 10/13: loss1=0.0218, loss2=0.0204, dev_macro_f1=0.4842, dev_err=22.81%
2026-02-23 19:44:47,780 - lg_cotrain - INFO - Phase 2 epoch 11/13: loss1=0.0126, loss2=0.0193, dev_macro_f1=0.4926, dev_err=23.25%
2026-02-23 19:45:04,844 - lg_cotrain - INFO - Phase 2 epoch 12/13: loss1=0.0105, loss2=0.0301, dev_macro_f1=0.5402, dev_err=22.37%
2026-02-23 19:45:21,890 - lg_cotrain - INFO - Phase 2 epoch 13/13: loss1=0.0093, loss2=0.0493, dev_macro_f1=0.4911, dev_err=24.12%
2026-02-23 19:45:21,891 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 19:45:24,487 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.4861, dev_err=32.46%, es_counter1=0, es_counter2=0
2026-02-23 19:45:27,092 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.6160, dev_err=21.05%, es_counter1=0, es_counter2=0
2026-02-23 19:45:29,672 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.5883, dev_err=24.12%, es_counter1=1, es_counter2=1
2026-02-23 19:45:32,237 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.5942, dev_err=22.81%, es_counter1=2, es_counter2=2
2026-02-23 19:45:34,814 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.5776, dev_err=25.00%, es_counter1=3, es_counter2=3
2026-02-23 19:45:37,419 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.6192, dev_err=21.05%, es_counter1=0, es_counter2=0
2026-02-23 19:45:40,024 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.6221, dev_err=20.61%, es_counter1=0, es_counter2=0
2026-02-23 19:45:42,629 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.6223, dev_err=24.12%, es_counter1=0, es_counter2=0
2026-02-23 19:45:45,222 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.6309, dev_err=23.25%, es_counter1=0, es_counter2=0
2026-02-23 19:45:47,820 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.6399, dev_err=22.81%, es_counter1=0, es_counter2=0
2026-02-23 19:45:50,431 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.6419, dev_err=22.37%, es_counter1=0, es_counter2=0
2026-02-23 19:45:53,018 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.6388, dev_err=22.37%, es_counter1=1, es_counter2=1
2026-02-23 19:45:55,594 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.6379, dev_err=22.37%, es_counter1=2, es_counter2=2
2026-02-23 19:45:58,169 - lg_cotrain - INFO - Phase 3 epoch 14: dev_macro_f1=0.6379, dev_err=22.37%, es_counter1=3, es_counter2=3
2026-02-23 19:46:00,748 - lg_cotrain - INFO - Phase 3 epoch 15: dev_macro_f1=0.6379, dev_err=22.37%, es_counter1=4, es_counter2=4
2026-02-23 19:46:03,333 - lg_cotrain - INFO - Phase 3 epoch 16: dev_macro_f1=0.6379, dev_err=22.37%, es_counter1=5, es_counter2=5
2026-02-23 19:46:05,907 - lg_cotrain - INFO - Phase 3 epoch 17: dev_macro_f1=0.6395, dev_err=22.37%, es_counter1=6, es_counter2=6
2026-02-23 19:46:08,486 - lg_cotrain - INFO - Phase 3 epoch 18: dev_macro_f1=0.6379, dev_err=22.37%, es_counter1=7, es_counter2=7
2026-02-23 19:46:08,486 - lg_cotrain - INFO - Early stopping at epoch 18
2026-02-23 19:46:08,506 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 19:46:10,671 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmp1g_unsnh\canada_wildfires_2016\50_set3\metrics.json
2026-02-23 19:46:10,671 - lg_cotrain - INFO - Test error rate: 25.62%, Test macro-F1: 0.5906, Test ECE: 0.1104
2026-02-23 19:46:10,679 - lg_cotrain - INFO - --- Trial 9/10 done: dev_macro_f1=0.6419 ---
2026-02-23 19:46:10,679 - lg_cotrain - INFO - --- Trial 10/10 ---
2026-02-23 19:46:11,233 - lg_cotrain - INFO - Starting LG-CoTrain: event=canada_wildfires_2016, budget=50, seed_set=3
2026-02-23 19:46:11,243 - lg_cotrain - INFO - Detected 8 classes for event canada_wildfires_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 19:46:11,248 - lg_cotrain - INFO - D_l1: 182, D_l2: 182, D_LG: 1205
2026-02-23 19:46:11,248 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 19:46:18,789 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1728, mean_prob2=0.1356
2026-02-23 19:46:25,417 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.2163, mean_prob2=0.2697
2026-02-23 19:46:32,068 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.4016, mean_prob2=0.4294
2026-02-23 19:46:38,669 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.4806, mean_prob2=0.6045
2026-02-23 19:46:45,278 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.6146, mean_prob2=0.5293
2026-02-23 19:46:51,860 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.6237, mean_prob2=0.6649
2026-02-23 19:46:58,422 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.6168, mean_prob2=0.6783
2026-02-23 19:46:58,422 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 19:46:59,550 - lg_cotrain - INFO - LR scheduler: total_steps_1=4565, warmup=14; total_steps_2=4565, warmup=14
2026-02-23 19:46:59,550 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.6168, range=[0.0026, 0.9659]
2026-02-23 19:46:59,550 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.6783, range=[0.0013, 0.9752]
2026-02-23 19:47:19,391 - lg_cotrain - INFO - Phase 2 epoch 1/15: loss1=0.5576, loss2=0.5349, dev_macro_f1=0.4198, dev_err=27.19%
2026-02-23 19:47:39,192 - lg_cotrain - INFO - Phase 2 epoch 2/15: loss1=0.0722, loss2=0.2374, dev_macro_f1=0.5225, dev_err=21.05%
2026-02-23 19:47:58,980 - lg_cotrain - INFO - Phase 2 epoch 3/15: loss1=0.0470, loss2=0.1022, dev_macro_f1=0.5638, dev_err=20.61%
2026-02-23 19:48:18,772 - lg_cotrain - INFO - Phase 2 epoch 4/15: loss1=0.0493, loss2=0.0968, dev_macro_f1=0.5773, dev_err=20.18%
2026-02-23 19:48:38,570 - lg_cotrain - INFO - Phase 2 epoch 5/15: loss1=0.0307, loss2=0.0591, dev_macro_f1=0.5738, dev_err=20.18%
2026-02-23 19:48:58,386 - lg_cotrain - INFO - Phase 2 epoch 6/15: loss1=0.0231, loss2=0.0276, dev_macro_f1=0.5596, dev_err=21.49%
2026-02-23 19:49:18,188 - lg_cotrain - INFO - Phase 2 epoch 7/15: loss1=0.0262, loss2=0.0163, dev_macro_f1=0.5744, dev_err=20.61%
2026-02-23 19:49:37,939 - lg_cotrain - INFO - Phase 2 epoch 8/15: loss1=0.0410, loss2=0.0108, dev_macro_f1=0.5890, dev_err=19.30%
2026-02-23 19:49:57,702 - lg_cotrain - INFO - Phase 2 epoch 9/15: loss1=0.0376, loss2=0.0186, dev_macro_f1=0.5694, dev_err=21.05%
2026-02-23 19:50:17,433 - lg_cotrain - INFO - Phase 2 epoch 10/15: loss1=0.0212, loss2=0.0582, dev_macro_f1=0.5332, dev_err=22.37%
2026-02-23 19:50:37,175 - lg_cotrain - INFO - Phase 2 epoch 11/15: loss1=0.0082, loss2=0.0077, dev_macro_f1=0.5516, dev_err=22.37%
2026-02-23 19:50:56,882 - lg_cotrain - INFO - Phase 2 epoch 12/15: loss1=0.0072, loss2=0.0054, dev_macro_f1=0.5830, dev_err=20.18%
2026-02-23 19:51:16,629 - lg_cotrain - INFO - Phase 2 epoch 13/15: loss1=0.0045, loss2=0.0038, dev_macro_f1=0.5613, dev_err=21.93%
2026-02-23 19:51:36,388 - lg_cotrain - INFO - Phase 2 epoch 14/15: loss1=0.0045, loss2=0.0090, dev_macro_f1=0.5269, dev_err=23.68%
2026-02-23 19:51:56,093 - lg_cotrain - INFO - Phase 2 epoch 15/15: loss1=0.0034, loss2=0.0186, dev_macro_f1=0.5512, dev_err=22.37%
2026-02-23 19:51:56,093 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 19:51:59,114 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.6088, dev_err=20.18%, es_counter1=0, es_counter2=0
2026-02-23 19:52:02,107 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.6036, dev_err=20.61%, es_counter1=1, es_counter2=1
2026-02-23 19:52:05,122 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.7395, dev_err=18.42%, es_counter1=0, es_counter2=0
2026-02-23 19:52:08,160 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.7447, dev_err=17.54%, es_counter1=0, es_counter2=0
2026-02-23 19:52:11,163 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.7401, dev_err=17.54%, es_counter1=1, es_counter2=1
2026-02-23 19:52:14,156 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.7074, dev_err=18.42%, es_counter1=2, es_counter2=2
2026-02-23 19:52:17,139 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.7044, dev_err=18.42%, es_counter1=3, es_counter2=3
2026-02-23 19:52:20,135 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.7162, dev_err=17.54%, es_counter1=4, es_counter2=4
2026-02-23 19:52:23,124 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.6890, dev_err=19.30%, es_counter1=5, es_counter2=5
2026-02-23 19:52:26,106 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.7111, dev_err=17.54%, es_counter1=6, es_counter2=6
2026-02-23 19:52:29,101 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.6936, dev_err=18.86%, es_counter1=7, es_counter2=7
2026-02-23 19:52:29,102 - lg_cotrain - INFO - Early stopping at epoch 11
2026-02-23 19:52:29,113 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 19:52:31,408 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpapnfa__g\canada_wildfires_2016\50_set3\metrics.json
2026-02-23 19:52:31,408 - lg_cotrain - INFO - Test error rate: 24.72%, Test macro-F1: 0.5529, Test ECE: 0.1043
2026-02-23 19:52:31,408 - lg_cotrain - INFO - --- Trial 10/10 done: dev_macro_f1=0.7447 ---
