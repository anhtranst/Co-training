2026-02-28 13:25:11,078 - lg_cotrain - INFO - === Optuna study: kaikoura_earthquake_2016 budget=50 seed=3 | target=10 trials, 0 replayed, 10 new ===
2026-02-28 13:25:11,079 - lg_cotrain - INFO - --- Trial 1/10 ---
2026-02-28 13:25:11,557 - lg_cotrain - INFO - Starting LG-CoTrain: event=kaikoura_earthquake_2016, budget=50, seed_set=3
2026-02-28 13:25:11,586 - lg_cotrain - INFO - Detected 9 classes for event kaikoura_earthquake_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-28 13:25:11,591 - lg_cotrain - INFO - D_l1: 209, D_l2: 208, D_LG: 1119
2026-02-28 13:25:11,593 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-28 13:25:19,535 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1716, mean_prob2=0.1028
2026-02-28 13:25:26,350 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1166, mean_prob2=0.0999
2026-02-28 13:25:33,151 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.0991, mean_prob2=0.1047
2026-02-28 13:25:39,938 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1073, mean_prob2=0.1031
2026-02-28 13:25:46,719 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1276, mean_prob2=0.1111
2026-02-28 13:25:53,457 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1263, mean_prob2=0.1098
2026-02-28 13:26:00,223 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1125, mean_prob2=0.1194
2026-02-28 13:26:00,223 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-28 13:26:01,298 - lg_cotrain - INFO - LR scheduler: total_steps_1=4660, warmup=480; total_steps_2=4560, warmup=470
2026-02-28 13:26:01,299 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1125, range=[0.0467, 0.2095]
2026-02-28 13:26:01,299 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1194, range=[0.0162, 0.2082]
2026-02-28 13:26:20,145 - lg_cotrain - INFO - Phase 2 epoch 1/14: loss1=0.1947, loss2=0.1633, dev_macro_f1=0.2404, dev_err=59.82%
2026-02-28 13:26:38,915 - lg_cotrain - INFO - Phase 2 epoch 2/14: loss1=0.1454, loss2=0.6040, dev_macro_f1=0.1271, dev_err=66.52%
2026-02-28 13:26:57,696 - lg_cotrain - INFO - Phase 2 epoch 3/14: loss1=0.1337, loss2=0.5099, dev_macro_f1=0.1271, dev_err=66.52%
2026-02-28 13:27:16,529 - lg_cotrain - INFO - Phase 2 epoch 4/14: loss1=0.1545, loss2=0.4861, dev_macro_f1=0.1262, dev_err=66.52%
2026-02-28 13:27:35,281 - lg_cotrain - INFO - Phase 2 epoch 5/14: loss1=0.1695, loss2=0.5135, dev_macro_f1=0.0534, dev_err=83.04%
2026-02-28 13:27:53,994 - lg_cotrain - INFO - Phase 2 epoch 6/14: loss1=0.1533, loss2=0.5267, dev_macro_f1=0.1093, dev_err=70.09%
2026-02-28 13:28:12,737 - lg_cotrain - INFO - Phase 2 epoch 7/14: loss1=0.1408, loss2=0.4838, dev_macro_f1=0.1093, dev_err=70.09%
2026-02-28 13:28:31,454 - lg_cotrain - INFO - Phase 2 epoch 8/14: loss1=0.1446, loss2=0.4642, dev_macro_f1=0.1093, dev_err=70.09%
2026-02-28 13:28:50,178 - lg_cotrain - INFO - Phase 2 epoch 9/14: loss1=0.1503, loss2=0.4475, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 13:29:09,092 - lg_cotrain - INFO - Phase 2 epoch 10/14: loss1=0.1502, loss2=0.4417, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 13:29:28,292 - lg_cotrain - INFO - Phase 2 epoch 11/14: loss1=0.1492, loss2=0.4830, dev_macro_f1=0.0278, dev_err=85.71%
2026-02-28 13:29:47,180 - lg_cotrain - INFO - Phase 2 epoch 12/14: loss1=0.1435, loss2=0.4879, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 13:30:06,344 - lg_cotrain - INFO - Phase 2 epoch 13/14: loss1=0.1388, loss2=0.4680, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 13:30:26,080 - lg_cotrain - INFO - Phase 2 epoch 14/14: loss1=0.1347, loss2=0.4670, dev_macro_f1=0.0278, dev_err=85.71%
2026-02-28 13:30:26,080 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-28 13:30:29,605 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.0406, dev_err=77.68%, es_counter1=0, es_counter2=0
2026-02-28 13:30:33,062 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.0190, dev_err=90.62%, es_counter1=1, es_counter2=1
2026-02-28 13:30:36,518 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.0278, dev_err=85.71%, es_counter1=2, es_counter2=2
2026-02-28 13:30:40,001 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.0278, dev_err=85.71%, es_counter1=3, es_counter2=3
2026-02-28 13:30:43,457 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.0278, dev_err=85.71%, es_counter1=4, es_counter2=4
2026-02-28 13:30:46,893 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.0104, dev_err=95.09%, es_counter1=5, es_counter2=5
2026-02-28 13:30:50,383 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.0365, dev_err=80.36%, es_counter1=6, es_counter2=6
2026-02-28 13:30:53,860 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.0365, dev_err=80.36%, es_counter1=7, es_counter2=7
2026-02-28 13:30:57,308 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.0365, dev_err=80.36%, es_counter1=8, es_counter2=8
2026-02-28 13:30:57,308 - lg_cotrain - INFO - Early stopping at epoch 9
2026-02-28 13:30:57,317 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-28 13:30:59,600 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpjpzqvfjx\kaikoura_earthquake_2016\50_set3\metrics.json
2026-02-28 13:30:59,601 - lg_cotrain - INFO - Test error rate: 77.47%, Test macro-F1: 0.0409, Test ECE: 0.0439
2026-02-28 13:30:59,611 - lg_cotrain - INFO - --- Trial 1/10 done: dev_macro_f1=0.0406 ---
2026-02-28 13:30:59,612 - lg_cotrain - INFO - --- Trial 2/10 ---
2026-02-28 13:31:00,099 - lg_cotrain - INFO - Starting LG-CoTrain: event=kaikoura_earthquake_2016, budget=50, seed_set=3
2026-02-28 13:31:00,113 - lg_cotrain - INFO - Detected 9 classes for event kaikoura_earthquake_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-28 13:31:00,117 - lg_cotrain - INFO - D_l1: 209, D_l2: 208, D_LG: 1119
2026-02-28 13:31:00,118 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-28 13:31:06,596 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1382, mean_prob2=0.0940
2026-02-28 13:31:12,001 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1106, mean_prob2=0.1239
2026-02-28 13:31:17,419 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1052, mean_prob2=0.1424
2026-02-28 13:31:22,816 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1185, mean_prob2=0.1387
2026-02-28 13:31:28,249 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1231, mean_prob2=0.1920
2026-02-28 13:31:34,072 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1373, mean_prob2=0.2853
2026-02-28 13:31:39,557 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1370, mean_prob2=0.4902
2026-02-28 13:31:39,557 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-28 13:31:40,541 - lg_cotrain - INFO - LR scheduler: total_steps_1=1365, warmup=121; total_steps_2=1365, warmup=121
2026-02-28 13:31:40,542 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1370, range=[0.0185, 0.2484]
2026-02-28 13:31:40,542 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.4902, range=[0.0014, 0.9682]
2026-02-28 13:31:54,875 - lg_cotrain - INFO - Phase 2 epoch 1/19: loss1=0.9831, loss2=0.2521, dev_macro_f1=0.2307, dev_err=51.34%
2026-02-28 13:32:09,244 - lg_cotrain - INFO - Phase 2 epoch 2/19: loss1=0.2032, loss2=0.1953, dev_macro_f1=0.4979, dev_err=33.93%
2026-02-28 13:32:23,612 - lg_cotrain - INFO - Phase 2 epoch 3/19: loss1=0.0755, loss2=0.2233, dev_macro_f1=0.5032, dev_err=34.38%
2026-02-28 13:32:38,068 - lg_cotrain - INFO - Phase 2 epoch 4/19: loss1=0.0537, loss2=0.3073, dev_macro_f1=0.4207, dev_err=38.39%
2026-02-28 13:32:52,971 - lg_cotrain - INFO - Phase 2 epoch 5/19: loss1=0.0498, loss2=0.3534, dev_macro_f1=0.4741, dev_err=36.61%
2026-02-28 13:33:08,025 - lg_cotrain - INFO - Phase 2 epoch 6/19: loss1=0.0722, loss2=0.3975, dev_macro_f1=0.4627, dev_err=39.73%
2026-02-28 13:33:22,360 - lg_cotrain - INFO - Phase 2 epoch 7/19: loss1=0.0802, loss2=0.3598, dev_macro_f1=0.5029, dev_err=34.82%
2026-02-28 13:33:36,645 - lg_cotrain - INFO - Phase 2 epoch 8/19: loss1=0.1091, loss2=0.3096, dev_macro_f1=0.5152, dev_err=34.38%
2026-02-28 13:33:50,929 - lg_cotrain - INFO - Phase 2 epoch 9/19: loss1=0.0882, loss2=0.2052, dev_macro_f1=0.5099, dev_err=33.48%
2026-02-28 13:34:05,236 - lg_cotrain - INFO - Phase 2 epoch 10/19: loss1=0.0840, loss2=0.2060, dev_macro_f1=0.5081, dev_err=34.38%
2026-02-28 13:34:20,048 - lg_cotrain - INFO - Phase 2 epoch 11/19: loss1=0.0907, loss2=0.2705, dev_macro_f1=0.5306, dev_err=33.48%
2026-02-28 13:34:34,446 - lg_cotrain - INFO - Phase 2 epoch 12/19: loss1=0.0667, loss2=0.2419, dev_macro_f1=0.4917, dev_err=36.61%
2026-02-28 13:34:49,157 - lg_cotrain - INFO - Phase 2 epoch 13/19: loss1=0.1064, loss2=0.3336, dev_macro_f1=0.5123, dev_err=34.82%
2026-02-28 13:35:04,045 - lg_cotrain - INFO - Phase 2 epoch 14/19: loss1=0.0928, loss2=0.4187, dev_macro_f1=0.4101, dev_err=41.52%
2026-02-28 13:35:18,511 - lg_cotrain - INFO - Phase 2 epoch 15/19: loss1=0.0750, loss2=1.1441, dev_macro_f1=0.5018, dev_err=35.71%
2026-02-28 13:35:32,826 - lg_cotrain - INFO - Phase 2 epoch 16/19: loss1=0.0445, loss2=0.5721, dev_macro_f1=0.5053, dev_err=33.93%
2026-02-28 13:35:47,413 - lg_cotrain - INFO - Phase 2 epoch 17/19: loss1=0.1617, loss2=0.4845, dev_macro_f1=0.3671, dev_err=44.20%
2026-02-28 13:36:01,698 - lg_cotrain - INFO - Phase 2 epoch 18/19: loss1=0.1672, loss2=0.5432, dev_macro_f1=0.4428, dev_err=41.07%
2026-02-28 13:36:15,993 - lg_cotrain - INFO - Phase 2 epoch 19/19: loss1=0.0947, loss2=0.4240, dev_macro_f1=0.5192, dev_err=33.93%
2026-02-28 13:36:15,993 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-28 13:36:18,552 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.3271, dev_err=51.79%, es_counter1=0, es_counter2=0
2026-02-28 13:36:21,107 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.3557, dev_err=62.50%, es_counter1=0, es_counter2=0
2026-02-28 13:36:23,640 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.2801, dev_err=51.34%, es_counter1=1, es_counter2=1
2026-02-28 13:36:26,201 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.4036, dev_err=44.20%, es_counter1=0, es_counter2=0
2026-02-28 13:36:28,921 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.4747, dev_err=42.86%, es_counter1=0, es_counter2=0
2026-02-28 13:36:31,950 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.4722, dev_err=37.50%, es_counter1=1, es_counter2=1
2026-02-28 13:36:34,674 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.5162, dev_err=36.16%, es_counter1=0, es_counter2=0
2026-02-28 13:36:37,248 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.5134, dev_err=38.84%, es_counter1=1, es_counter2=1
2026-02-28 13:36:39,970 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.4669, dev_err=37.95%, es_counter1=2, es_counter2=2
2026-02-28 13:36:42,492 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.4729, dev_err=41.07%, es_counter1=3, es_counter2=3
2026-02-28 13:36:45,016 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.4664, dev_err=38.84%, es_counter1=4, es_counter2=4
2026-02-28 13:36:47,536 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.3990, dev_err=45.98%, es_counter1=5, es_counter2=5
2026-02-28 13:36:50,052 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.1781, dev_err=75.00%, es_counter1=6, es_counter2=6
2026-02-28 13:36:52,637 - lg_cotrain - INFO - Phase 3 epoch 14: dev_macro_f1=0.0859, dev_err=85.27%, es_counter1=7, es_counter2=7
2026-02-28 13:36:55,248 - lg_cotrain - INFO - Phase 3 epoch 15: dev_macro_f1=0.1178, dev_err=67.86%, es_counter1=8, es_counter2=8
2026-02-28 13:36:57,832 - lg_cotrain - INFO - Phase 3 epoch 16: dev_macro_f1=0.1587, dev_err=68.75%, es_counter1=9, es_counter2=9
2026-02-28 13:37:00,395 - lg_cotrain - INFO - Phase 3 epoch 17: dev_macro_f1=0.1039, dev_err=75.89%, es_counter1=10, es_counter2=10
2026-02-28 13:37:00,396 - lg_cotrain - INFO - Early stopping at epoch 17
2026-02-28 13:37:00,405 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-28 13:37:02,416 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpobohph3v\kaikoura_earthquake_2016\50_set3\metrics.json
2026-02-28 13:37:02,417 - lg_cotrain - INFO - Test error rate: 37.70%, Test macro-F1: 0.5186, Test ECE: 0.1757
2026-02-28 13:37:02,427 - lg_cotrain - INFO - --- Trial 2/10 done: dev_macro_f1=0.5162 ---
2026-02-28 13:37:02,427 - lg_cotrain - INFO - --- Trial 3/10 ---
2026-02-28 13:37:02,920 - lg_cotrain - INFO - Starting LG-CoTrain: event=kaikoura_earthquake_2016, budget=50, seed_set=3
2026-02-28 13:37:02,931 - lg_cotrain - INFO - Detected 9 classes for event kaikoura_earthquake_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-28 13:37:02,937 - lg_cotrain - INFO - D_l1: 209, D_l2: 208, D_LG: 1119
2026-02-28 13:37:02,937 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-28 13:37:11,197 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1207, mean_prob2=0.1465
2026-02-28 13:37:18,776 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1471, mean_prob2=0.2026
2026-02-28 13:37:25,621 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1969, mean_prob2=0.2615
2026-02-28 13:37:32,371 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.2958, mean_prob2=0.3532
2026-02-28 13:37:39,125 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.3668, mean_prob2=0.4513
2026-02-28 13:37:45,939 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.4672, mean_prob2=0.5154
2026-02-28 13:37:52,685 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.5158, mean_prob2=0.5576
2026-02-28 13:37:52,685 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-28 13:37:53,680 - lg_cotrain - INFO - LR scheduler: total_steps_1=3820, warmup=771; total_steps_2=3720, warmup=751
2026-02-28 13:37:53,681 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.5158, range=[0.0067, 0.9382]
2026-02-28 13:37:53,681 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.5576, range=[0.0035, 0.9317]
2026-02-28 13:38:12,534 - lg_cotrain - INFO - Phase 2 epoch 1/8: loss1=1.2540, loss2=1.0420, dev_macro_f1=0.1135, dev_err=63.84%
2026-02-28 13:38:31,570 - lg_cotrain - INFO - Phase 2 epoch 2/8: loss1=0.2404, loss2=0.8019, dev_macro_f1=0.2772, dev_err=47.32%
2026-02-28 13:38:50,203 - lg_cotrain - INFO - Phase 2 epoch 3/8: loss1=0.1863, loss2=0.3834, dev_macro_f1=0.3360, dev_err=40.62%
2026-02-28 13:39:08,849 - lg_cotrain - INFO - Phase 2 epoch 4/8: loss1=0.1095, loss2=0.2065, dev_macro_f1=0.4605, dev_err=35.71%
2026-02-28 13:39:27,417 - lg_cotrain - INFO - Phase 2 epoch 5/8: loss1=0.0671, loss2=0.1363, dev_macro_f1=0.5228, dev_err=33.48%
2026-02-28 13:39:46,125 - lg_cotrain - INFO - Phase 2 epoch 6/8: loss1=0.0458, loss2=0.0744, dev_macro_f1=0.5285, dev_err=35.27%
2026-02-28 13:40:04,919 - lg_cotrain - INFO - Phase 2 epoch 7/8: loss1=0.0400, loss2=0.0528, dev_macro_f1=0.6028, dev_err=31.70%
2026-02-28 13:40:23,766 - lg_cotrain - INFO - Phase 2 epoch 8/8: loss1=0.0299, loss2=0.0535, dev_macro_f1=0.6143, dev_err=31.25%
2026-02-28 13:40:23,767 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-28 13:40:27,175 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.5700, dev_err=39.29%, es_counter1=0, es_counter2=0
2026-02-28 13:40:30,607 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.6582, dev_err=27.23%, es_counter1=0, es_counter2=0
2026-02-28 13:40:34,030 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.6615, dev_err=27.23%, es_counter1=0, es_counter2=0
2026-02-28 13:40:37,482 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.6622, dev_err=27.23%, es_counter1=0, es_counter2=0
2026-02-28 13:40:40,881 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.6503, dev_err=28.12%, es_counter1=1, es_counter2=1
2026-02-28 13:40:44,316 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.6667, dev_err=26.79%, es_counter1=0, es_counter2=0
2026-02-28 13:40:47,713 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.6474, dev_err=28.57%, es_counter1=1, es_counter2=1
2026-02-28 13:40:51,093 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.6516, dev_err=28.12%, es_counter1=2, es_counter2=2
2026-02-28 13:40:54,462 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.6509, dev_err=28.12%, es_counter1=3, es_counter2=3
2026-02-28 13:40:57,854 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.6509, dev_err=28.12%, es_counter1=4, es_counter2=4
2026-02-28 13:41:01,246 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.6509, dev_err=28.12%, es_counter1=5, es_counter2=5
2026-02-28 13:41:01,246 - lg_cotrain - INFO - Early stopping at epoch 11
2026-02-28 13:41:01,260 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-28 13:41:03,547 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmp1dhddnlx\kaikoura_earthquake_2016\50_set3\metrics.json
2026-02-28 13:41:03,547 - lg_cotrain - INFO - Test error rate: 23.91%, Test macro-F1: 0.7395, Test ECE: 0.0876
2026-02-28 13:41:03,560 - lg_cotrain - INFO - --- Trial 3/10 done: dev_macro_f1=0.6667 ---
2026-02-28 13:41:03,560 - lg_cotrain - INFO - --- Trial 4/10 ---
2026-02-28 13:41:04,065 - lg_cotrain - INFO - Starting LG-CoTrain: event=kaikoura_earthquake_2016, budget=50, seed_set=3
2026-02-28 13:41:04,076 - lg_cotrain - INFO - Detected 9 classes for event kaikoura_earthquake_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-28 13:41:04,080 - lg_cotrain - INFO - D_l1: 209, D_l2: 208, D_LG: 1119
2026-02-28 13:41:04,080 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-28 13:41:10,279 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1206, mean_prob2=0.1149
2026-02-28 13:41:15,387 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1209, mean_prob2=0.1308
2026-02-28 13:41:20,488 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1609, mean_prob2=0.1669
2026-02-28 13:41:25,564 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1900, mean_prob2=0.2106
2026-02-28 13:41:30,677 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.2304, mean_prob2=0.2725
2026-02-28 13:41:35,768 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.2970, mean_prob2=0.3376
2026-02-28 13:41:40,863 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.3637, mean_prob2=0.4029
2026-02-28 13:41:40,864 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-28 13:41:42,020 - lg_cotrain - INFO - LR scheduler: total_steps_1=724, warmup=54; total_steps_2=724, warmup=54
2026-02-28 13:41:42,020 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.3637, range=[0.0187, 0.8865]
2026-02-28 13:41:42,020 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.4029, range=[0.0113, 0.7693]
2026-02-28 13:41:55,310 - lg_cotrain - INFO - Phase 2 epoch 1/18: loss1=0.9175, loss2=0.7236, dev_macro_f1=0.1696, dev_err=60.27%
2026-02-28 13:42:08,908 - lg_cotrain - INFO - Phase 2 epoch 2/18: loss1=0.2567, loss2=0.5563, dev_macro_f1=0.2733, dev_err=46.88%
2026-02-28 13:42:22,700 - lg_cotrain - INFO - Phase 2 epoch 3/18: loss1=0.1592, loss2=0.2797, dev_macro_f1=0.3110, dev_err=42.86%
2026-02-28 13:42:36,320 - lg_cotrain - INFO - Phase 2 epoch 4/18: loss1=0.0789, loss2=0.1501, dev_macro_f1=0.4772, dev_err=35.71%
2026-02-28 13:42:49,743 - lg_cotrain - INFO - Phase 2 epoch 5/18: loss1=0.0454, loss2=0.0879, dev_macro_f1=0.4851, dev_err=35.27%
2026-02-28 13:43:03,242 - lg_cotrain - INFO - Phase 2 epoch 6/18: loss1=0.0349, loss2=0.0781, dev_macro_f1=0.5431, dev_err=33.93%
2026-02-28 13:43:16,791 - lg_cotrain - INFO - Phase 2 epoch 7/18: loss1=0.0234, loss2=0.0516, dev_macro_f1=0.5795, dev_err=32.14%
2026-02-28 13:43:30,246 - lg_cotrain - INFO - Phase 2 epoch 8/18: loss1=0.0243, loss2=0.1027, dev_macro_f1=0.5693, dev_err=33.93%
2026-02-28 13:43:43,791 - lg_cotrain - INFO - Phase 2 epoch 9/18: loss1=0.0229, loss2=0.0684, dev_macro_f1=0.6149, dev_err=31.25%
2026-02-28 13:43:57,152 - lg_cotrain - INFO - Phase 2 epoch 10/18: loss1=0.0234, loss2=0.0303, dev_macro_f1=0.6123, dev_err=31.70%
2026-02-28 13:44:10,455 - lg_cotrain - INFO - Phase 2 epoch 11/18: loss1=0.0251, loss2=0.0256, dev_macro_f1=0.5969, dev_err=33.04%
2026-02-28 13:44:23,643 - lg_cotrain - INFO - Phase 2 epoch 12/18: loss1=0.0203, loss2=0.0303, dev_macro_f1=0.6342, dev_err=30.80%
2026-02-28 13:44:36,880 - lg_cotrain - INFO - Phase 2 epoch 13/18: loss1=0.0320, loss2=0.0178, dev_macro_f1=0.6192, dev_err=30.80%
2026-02-28 13:44:50,012 - lg_cotrain - INFO - Phase 2 epoch 14/18: loss1=0.0222, loss2=0.0134, dev_macro_f1=0.6175, dev_err=31.25%
2026-02-28 13:45:03,172 - lg_cotrain - INFO - Phase 2 epoch 15/18: loss1=0.0138, loss2=0.0108, dev_macro_f1=0.6248, dev_err=30.80%
2026-02-28 13:45:16,321 - lg_cotrain - INFO - Phase 2 epoch 16/18: loss1=0.0076, loss2=0.0079, dev_macro_f1=0.6184, dev_err=31.70%
2026-02-28 13:45:29,590 - lg_cotrain - INFO - Phase 2 epoch 17/18: loss1=0.0070, loss2=0.0063, dev_macro_f1=0.6483, dev_err=29.02%
2026-02-28 13:45:42,824 - lg_cotrain - INFO - Phase 2 epoch 18/18: loss1=0.0102, loss2=0.0050, dev_macro_f1=0.6339, dev_err=30.80%
2026-02-28 13:45:42,825 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-28 13:45:45,181 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.5807, dev_err=34.82%, es_counter1=0, es_counter2=0
2026-02-28 13:45:47,539 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.6427, dev_err=32.59%, es_counter1=0, es_counter2=0
2026-02-28 13:45:49,900 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.6714, dev_err=27.23%, es_counter1=0, es_counter2=0
2026-02-28 13:45:52,254 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.6889, dev_err=24.55%, es_counter1=0, es_counter2=0
2026-02-28 13:45:54,597 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.6546, dev_err=28.12%, es_counter1=1, es_counter2=1
2026-02-28 13:45:56,941 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.6415, dev_err=29.46%, es_counter1=2, es_counter2=2
2026-02-28 13:45:59,291 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.6461, dev_err=28.57%, es_counter1=3, es_counter2=3
2026-02-28 13:46:01,643 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.6722, dev_err=26.79%, es_counter1=4, es_counter2=4
2026-02-28 13:46:03,986 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.6855, dev_err=25.45%, es_counter1=5, es_counter2=5
2026-02-28 13:46:06,332 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.6732, dev_err=26.79%, es_counter1=6, es_counter2=6
2026-02-28 13:46:08,678 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.6669, dev_err=27.68%, es_counter1=7, es_counter2=7
2026-02-28 13:46:08,678 - lg_cotrain - INFO - Early stopping at epoch 11
2026-02-28 13:46:08,691 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-28 13:46:10,577 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpxcu1pskx\kaikoura_earthquake_2016\50_set3\metrics.json
2026-02-28 13:46:10,577 - lg_cotrain - INFO - Test error rate: 24.60%, Test macro-F1: 0.6792, Test ECE: 0.0523
2026-02-28 13:46:10,585 - lg_cotrain - INFO - --- Trial 4/10 done: dev_macro_f1=0.6889 ---
2026-02-28 13:46:10,586 - lg_cotrain - INFO - --- Trial 5/10 ---
2026-02-28 13:46:11,102 - lg_cotrain - INFO - Starting LG-CoTrain: event=kaikoura_earthquake_2016, budget=50, seed_set=3
2026-02-28 13:46:11,116 - lg_cotrain - INFO - Detected 9 classes for event kaikoura_earthquake_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-28 13:46:11,120 - lg_cotrain - INFO - D_l1: 209, D_l2: 208, D_LG: 1119
2026-02-28 13:46:11,121 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-28 13:46:18,078 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1309, mean_prob2=0.1369
2026-02-28 13:46:24,050 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1477, mean_prob2=0.1689
2026-02-28 13:46:30,007 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1979, mean_prob2=0.2287
2026-02-28 13:46:36,034 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.2585, mean_prob2=0.2793
2026-02-28 13:46:42,028 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.3077, mean_prob2=0.3611
2026-02-28 13:46:47,985 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.4115, mean_prob2=0.4510
2026-02-28 13:46:53,967 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.4885, mean_prob2=0.5091
2026-02-28 13:46:53,967 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-28 13:46:55,001 - lg_cotrain - INFO - LR scheduler: total_steps_1=2380, warmup=150; total_steps_2=2280, warmup=143
2026-02-28 13:46:55,001 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.4885, range=[0.0073, 0.9128]
2026-02-28 13:46:55,002 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.5091, range=[0.0067, 0.8951]
2026-02-28 13:47:11,084 - lg_cotrain - INFO - Phase 2 epoch 1/14: loss1=1.0774, loss2=0.9187, dev_macro_f1=0.2047, dev_err=58.93%
2026-02-28 13:47:27,145 - lg_cotrain - INFO - Phase 2 epoch 2/14: loss1=0.2112, loss2=0.4926, dev_macro_f1=0.3618, dev_err=39.73%
2026-02-28 13:47:43,242 - lg_cotrain - INFO - Phase 2 epoch 3/14: loss1=0.1048, loss2=0.2246, dev_macro_f1=0.4549, dev_err=37.05%
2026-02-28 13:47:59,376 - lg_cotrain - INFO - Phase 2 epoch 4/14: loss1=0.0594, loss2=0.1339, dev_macro_f1=0.5591, dev_err=32.59%
2026-02-28 13:48:15,458 - lg_cotrain - INFO - Phase 2 epoch 5/14: loss1=0.0382, loss2=0.0785, dev_macro_f1=0.5919, dev_err=31.25%
2026-02-28 13:48:31,661 - lg_cotrain - INFO - Phase 2 epoch 6/14: loss1=0.0279, loss2=0.0426, dev_macro_f1=0.6298, dev_err=29.91%
2026-02-28 13:48:47,824 - lg_cotrain - INFO - Phase 2 epoch 7/14: loss1=0.0191, loss2=0.0275, dev_macro_f1=0.6324, dev_err=30.36%
2026-02-28 13:49:03,789 - lg_cotrain - INFO - Phase 2 epoch 8/14: loss1=0.0152, loss2=0.0436, dev_macro_f1=0.6320, dev_err=30.80%
2026-02-28 13:49:19,757 - lg_cotrain - INFO - Phase 2 epoch 9/14: loss1=0.0161, loss2=0.0269, dev_macro_f1=0.6448, dev_err=29.91%
2026-02-28 13:49:35,737 - lg_cotrain - INFO - Phase 2 epoch 10/14: loss1=0.0296, loss2=0.0137, dev_macro_f1=0.6263, dev_err=31.25%
2026-02-28 13:49:51,722 - lg_cotrain - INFO - Phase 2 epoch 11/14: loss1=0.0567, loss2=0.0143, dev_macro_f1=0.6382, dev_err=29.91%
2026-02-28 13:50:07,669 - lg_cotrain - INFO - Phase 2 epoch 12/14: loss1=0.0249, loss2=0.0113, dev_macro_f1=0.6421, dev_err=29.91%
2026-02-28 13:50:23,639 - lg_cotrain - INFO - Phase 2 epoch 13/14: loss1=0.0143, loss2=0.0066, dev_macro_f1=0.6387, dev_err=29.46%
2026-02-28 13:50:39,707 - lg_cotrain - INFO - Phase 2 epoch 14/14: loss1=0.0102, loss2=0.0057, dev_macro_f1=0.6523, dev_err=28.57%
2026-02-28 13:50:39,708 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-28 13:50:42,598 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.6449, dev_err=29.91%, es_counter1=0, es_counter2=0
2026-02-28 13:50:45,507 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.6520, dev_err=27.23%, es_counter1=0, es_counter2=0
2026-02-28 13:50:48,388 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.6685, dev_err=25.89%, es_counter1=0, es_counter2=0
2026-02-28 13:50:51,263 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.6830, dev_err=24.11%, es_counter1=0, es_counter2=0
2026-02-28 13:50:54,124 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.6690, dev_err=25.89%, es_counter1=1, es_counter2=1
2026-02-28 13:50:56,987 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.6584, dev_err=26.79%, es_counter1=2, es_counter2=2
2026-02-28 13:50:59,840 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.6602, dev_err=27.68%, es_counter1=3, es_counter2=3
2026-02-28 13:51:02,702 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.6790, dev_err=25.89%, es_counter1=4, es_counter2=4
2026-02-28 13:51:05,551 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.6567, dev_err=27.68%, es_counter1=5, es_counter2=5
2026-02-28 13:51:08,426 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.6559, dev_err=27.68%, es_counter1=6, es_counter2=6
2026-02-28 13:51:11,286 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.6600, dev_err=27.23%, es_counter1=7, es_counter2=7
2026-02-28 13:51:14,143 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.6577, dev_err=27.68%, es_counter1=8, es_counter2=8
2026-02-28 13:51:14,144 - lg_cotrain - INFO - Early stopping at epoch 12
2026-02-28 13:51:14,157 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-28 13:51:16,316 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpmpdjrhn7\kaikoura_earthquake_2016\50_set3\metrics.json
2026-02-28 13:51:16,317 - lg_cotrain - INFO - Test error rate: 23.91%, Test macro-F1: 0.6901, Test ECE: 0.0708
2026-02-28 13:51:16,328 - lg_cotrain - INFO - --- Trial 5/10 done: dev_macro_f1=0.6830 ---
2026-02-28 13:51:16,329 - lg_cotrain - INFO - --- Trial 6/10 ---
2026-02-28 13:51:16,833 - lg_cotrain - INFO - Starting LG-CoTrain: event=kaikoura_earthquake_2016, budget=50, seed_set=3
2026-02-28 13:51:16,847 - lg_cotrain - INFO - Detected 9 classes for event kaikoura_earthquake_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-28 13:51:16,852 - lg_cotrain - INFO - D_l1: 209, D_l2: 208, D_LG: 1119
2026-02-28 13:51:16,853 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-28 13:51:24,542 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1223, mean_prob2=0.1446
2026-02-28 13:51:31,305 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1496, mean_prob2=0.2030
2026-02-28 13:51:38,106 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1973, mean_prob2=0.2512
2026-02-28 13:51:44,854 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.2657, mean_prob2=0.3301
2026-02-28 13:51:51,622 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.3531, mean_prob2=0.4354
2026-02-28 13:51:58,321 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.4440, mean_prob2=0.5042
2026-02-28 13:52:05,016 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.5020, mean_prob2=0.5535
2026-02-28 13:52:05,016 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-28 13:52:06,031 - lg_cotrain - INFO - LR scheduler: total_steps_1=3820, warmup=129; total_steps_2=3720, warmup=126
2026-02-28 13:52:06,032 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.5020, range=[0.0066, 0.9324]
2026-02-28 13:52:06,032 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.5535, range=[0.0036, 0.9191]
2026-02-28 13:52:24,681 - lg_cotrain - INFO - Phase 2 epoch 1/8: loss1=1.0263, loss2=0.8725, dev_macro_f1=0.2763, dev_err=45.98%
2026-02-28 13:52:43,470 - lg_cotrain - INFO - Phase 2 epoch 2/8: loss1=0.1595, loss2=0.3567, dev_macro_f1=0.4812, dev_err=33.93%
2026-02-28 13:53:02,117 - lg_cotrain - INFO - Phase 2 epoch 3/8: loss1=0.0837, loss2=0.1658, dev_macro_f1=0.5404, dev_err=32.14%
2026-02-28 13:53:20,773 - lg_cotrain - INFO - Phase 2 epoch 4/8: loss1=0.0550, loss2=0.0902, dev_macro_f1=0.5610, dev_err=33.04%
2026-02-28 13:53:39,382 - lg_cotrain - INFO - Phase 2 epoch 5/8: loss1=0.0423, loss2=0.0593, dev_macro_f1=0.6270, dev_err=29.91%
2026-02-28 13:53:57,993 - lg_cotrain - INFO - Phase 2 epoch 6/8: loss1=0.0451, loss2=0.0526, dev_macro_f1=0.6340, dev_err=29.91%
2026-02-28 13:54:16,611 - lg_cotrain - INFO - Phase 2 epoch 7/8: loss1=0.0311, loss2=0.0490, dev_macro_f1=0.6287, dev_err=30.36%
2026-02-28 13:54:35,275 - lg_cotrain - INFO - Phase 2 epoch 8/8: loss1=0.0196, loss2=0.0243, dev_macro_f1=0.6374, dev_err=29.91%
2026-02-28 13:54:35,275 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-28 13:54:38,657 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.6606, dev_err=26.79%, es_counter1=0, es_counter2=0
2026-02-28 13:54:42,012 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.6601, dev_err=27.23%, es_counter1=1, es_counter2=1
2026-02-28 13:54:45,395 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.6736, dev_err=26.34%, es_counter1=0, es_counter2=0
2026-02-28 13:54:48,763 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.6676, dev_err=27.23%, es_counter1=1, es_counter2=1
2026-02-28 13:54:52,134 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.6627, dev_err=28.12%, es_counter1=2, es_counter2=2
2026-02-28 13:54:55,480 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.6645, dev_err=27.23%, es_counter1=3, es_counter2=3
2026-02-28 13:54:58,838 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.6509, dev_err=28.57%, es_counter1=4, es_counter2=4
2026-02-28 13:55:02,198 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.6565, dev_err=28.12%, es_counter1=5, es_counter2=5
2026-02-28 13:55:05,556 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.6624, dev_err=27.68%, es_counter1=6, es_counter2=6
2026-02-28 13:55:05,556 - lg_cotrain - INFO - Early stopping at epoch 9
2026-02-28 13:55:05,570 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-28 13:55:07,869 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpdzsqkmyi\kaikoura_earthquake_2016\50_set3\metrics.json
2026-02-28 13:55:07,869 - lg_cotrain - INFO - Test error rate: 22.76%, Test macro-F1: 0.6973, Test ECE: 0.1156
2026-02-28 13:55:07,880 - lg_cotrain - INFO - --- Trial 6/10 done: dev_macro_f1=0.6736 ---
2026-02-28 13:55:07,880 - lg_cotrain - INFO - --- Trial 7/10 ---
2026-02-28 13:55:08,403 - lg_cotrain - INFO - Starting LG-CoTrain: event=kaikoura_earthquake_2016, budget=50, seed_set=3
2026-02-28 13:55:08,414 - lg_cotrain - INFO - Detected 9 classes for event kaikoura_earthquake_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-28 13:55:08,418 - lg_cotrain - INFO - D_l1: 209, D_l2: 208, D_LG: 1119
2026-02-28 13:55:08,419 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-28 13:55:16,128 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1409, mean_prob2=0.1214
2026-02-28 13:55:22,804 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1238, mean_prob2=0.1258
2026-02-28 13:55:29,481 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1156, mean_prob2=0.3190
2026-02-28 13:55:36,270 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1179, mean_prob2=0.4551
2026-02-28 13:55:42,953 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1159, mean_prob2=0.4434
2026-02-28 13:55:49,631 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1242, mean_prob2=0.5404
2026-02-28 13:55:56,375 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1175, mean_prob2=0.5750
2026-02-28 13:55:56,376 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-28 13:55:57,391 - lg_cotrain - INFO - LR scheduler: total_steps_1=5220, warmup=695; total_steps_2=5120, warmup=681
2026-02-28 13:55:57,392 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1175, range=[0.0494, 0.1309]
2026-02-28 13:55:57,392 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.5750, range=[0.0004, 0.9828]
2026-02-28 13:56:16,051 - lg_cotrain - INFO - Phase 2 epoch 1/18: loss1=1.0365, loss2=0.2042, dev_macro_f1=0.3249, dev_err=44.20%
2026-02-28 13:56:34,736 - lg_cotrain - INFO - Phase 2 epoch 2/18: loss1=0.1226, loss2=0.1896, dev_macro_f1=0.3900, dev_err=37.50%
2026-02-28 13:56:53,348 - lg_cotrain - INFO - Phase 2 epoch 3/18: loss1=0.0810, loss2=0.2075, dev_macro_f1=0.4920, dev_err=34.82%
2026-02-28 13:57:11,992 - lg_cotrain - INFO - Phase 2 epoch 4/18: loss1=0.0911, loss2=0.2524, dev_macro_f1=0.4079, dev_err=42.86%
2026-02-28 13:57:30,579 - lg_cotrain - INFO - Phase 2 epoch 5/18: loss1=0.3961, loss2=0.8473, dev_macro_f1=0.2802, dev_err=49.11%
2026-02-28 13:57:49,190 - lg_cotrain - INFO - Phase 2 epoch 6/18: loss1=0.1777, loss2=1.3489, dev_macro_f1=0.4441, dev_err=37.05%
2026-02-28 13:58:08,169 - lg_cotrain - INFO - Phase 2 epoch 7/18: loss1=0.0703, loss2=1.3629, dev_macro_f1=0.4705, dev_err=37.05%
2026-02-28 13:58:26,929 - lg_cotrain - INFO - Phase 2 epoch 8/18: loss1=0.0420, loss2=1.3839, dev_macro_f1=0.3452, dev_err=41.52%
2026-02-28 13:58:45,641 - lg_cotrain - INFO - Phase 2 epoch 9/18: loss1=0.0226, loss2=1.3909, dev_macro_f1=0.3519, dev_err=41.96%
2026-02-28 13:59:04,268 - lg_cotrain - INFO - Phase 2 epoch 10/18: loss1=0.0178, loss2=1.4063, dev_macro_f1=0.3485, dev_err=41.96%
2026-02-28 13:59:22,856 - lg_cotrain - INFO - Phase 2 epoch 11/18: loss1=0.0380, loss2=1.4244, dev_macro_f1=0.3276, dev_err=44.64%
2026-02-28 13:59:41,588 - lg_cotrain - INFO - Phase 2 epoch 12/18: loss1=0.0276, loss2=1.4179, dev_macro_f1=0.2057, dev_err=56.25%
2026-02-28 14:00:00,204 - lg_cotrain - INFO - Phase 2 epoch 13/18: loss1=0.0198, loss2=1.4030, dev_macro_f1=0.2626, dev_err=48.21%
2026-02-28 14:00:18,926 - lg_cotrain - INFO - Phase 2 epoch 14/18: loss1=0.0136, loss2=1.4129, dev_macro_f1=0.2583, dev_err=48.66%
2026-02-28 14:00:37,698 - lg_cotrain - INFO - Phase 2 epoch 15/18: loss1=0.0121, loss2=1.4049, dev_macro_f1=0.2942, dev_err=46.43%
2026-02-28 14:00:56,290 - lg_cotrain - INFO - Phase 2 epoch 16/18: loss1=0.0099, loss2=1.4116, dev_macro_f1=0.2683, dev_err=49.11%
2026-02-28 14:01:14,798 - lg_cotrain - INFO - Phase 2 epoch 17/18: loss1=0.0089, loss2=1.4063, dev_macro_f1=0.3014, dev_err=47.32%
2026-02-28 14:01:33,365 - lg_cotrain - INFO - Phase 2 epoch 18/18: loss1=0.0085, loss2=1.4162, dev_macro_f1=0.2882, dev_err=47.32%
2026-02-28 14:01:33,365 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-28 14:01:36,758 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.1051, dev_err=79.02%, es_counter1=0, es_counter2=0
2026-02-28 14:01:40,134 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.0929, dev_err=84.38%, es_counter1=1, es_counter2=1
2026-02-28 14:01:43,526 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.0534, dev_err=79.46%, es_counter1=2, es_counter2=2
2026-02-28 14:01:46,947 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.0533, dev_err=76.79%, es_counter1=3, es_counter2=3
2026-02-28 14:01:50,381 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.1193, dev_err=70.54%, es_counter1=0, es_counter2=0
2026-02-28 14:01:53,779 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.1068, dev_err=78.57%, es_counter1=1, es_counter2=1
2026-02-28 14:01:57,174 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.0278, dev_err=85.71%, es_counter1=2, es_counter2=2
2026-02-28 14:02:00,599 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.0406, dev_err=77.68%, es_counter1=3, es_counter2=3
2026-02-28 14:02:03,998 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.0207, dev_err=89.73%, es_counter1=4, es_counter2=4
2026-02-28 14:02:07,449 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.0278, dev_err=85.71%, es_counter1=5, es_counter2=5
2026-02-28 14:02:10,865 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.0207, dev_err=89.73%, es_counter1=6, es_counter2=6
2026-02-28 14:02:14,263 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.0207, dev_err=89.73%, es_counter1=7, es_counter2=7
2026-02-28 14:02:17,747 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.0086, dev_err=95.98%, es_counter1=8, es_counter2=8
2026-02-28 14:02:17,747 - lg_cotrain - INFO - Early stopping at epoch 13
2026-02-28 14:02:17,765 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-28 14:02:20,034 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmp_dilnep4\kaikoura_earthquake_2016\50_set3\metrics.json
2026-02-28 14:02:20,034 - lg_cotrain - INFO - Test error rate: 68.74%, Test macro-F1: 0.1332, Test ECE: 0.1138
2026-02-28 14:02:20,044 - lg_cotrain - INFO - --- Trial 7/10 done: dev_macro_f1=0.1193 ---
2026-02-28 14:02:20,045 - lg_cotrain - INFO - --- Trial 8/10 ---
2026-02-28 14:02:20,621 - lg_cotrain - INFO - Starting LG-CoTrain: event=kaikoura_earthquake_2016, budget=50, seed_set=3
2026-02-28 14:02:20,634 - lg_cotrain - INFO - Detected 9 classes for event kaikoura_earthquake_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-28 14:02:20,639 - lg_cotrain - INFO - D_l1: 209, D_l2: 208, D_LG: 1119
2026-02-28 14:02:20,639 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-28 14:02:27,032 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1211, mean_prob2=0.1103
2026-02-28 14:02:32,088 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1012, mean_prob2=0.1183
2026-02-28 14:02:37,132 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1212, mean_prob2=0.1358
2026-02-28 14:02:42,222 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1149, mean_prob2=0.1215
2026-02-28 14:02:47,259 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1073, mean_prob2=0.1261
2026-02-28 14:02:52,262 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1306, mean_prob2=0.1156
2026-02-28 14:02:57,415 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1242, mean_prob2=0.1119
2026-02-28 14:02:57,415 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-28 14:02:58,417 - lg_cotrain - INFO - LR scheduler: total_steps_1=634, warmup=107; total_steps_2=634, warmup=107
2026-02-28 14:02:58,417 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1242, range=[0.0528, 0.1731]
2026-02-28 14:02:58,418 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1119, range=[0.0479, 0.1513]
2026-02-28 14:03:11,835 - lg_cotrain - INFO - Phase 2 epoch 1/13: loss1=0.2411, loss2=0.2304, dev_macro_f1=0.2170, dev_err=51.79%
2026-02-28 14:03:25,069 - lg_cotrain - INFO - Phase 2 epoch 2/13: loss1=0.1428, loss2=0.1660, dev_macro_f1=0.4451, dev_err=38.39%
2026-02-28 14:03:38,289 - lg_cotrain - INFO - Phase 2 epoch 3/13: loss1=0.0560, loss2=0.1937, dev_macro_f1=0.4748, dev_err=37.50%
2026-02-28 14:03:51,554 - lg_cotrain - INFO - Phase 2 epoch 4/13: loss1=0.0618, loss2=0.3512, dev_macro_f1=0.3049, dev_err=47.32%
2026-02-28 14:04:04,779 - lg_cotrain - INFO - Phase 2 epoch 5/13: loss1=0.1116, loss2=0.6269, dev_macro_f1=0.2287, dev_err=60.71%
2026-02-28 14:04:17,967 - lg_cotrain - INFO - Phase 2 epoch 6/13: loss1=0.2215, loss2=1.4005, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 14:04:31,452 - lg_cotrain - INFO - Phase 2 epoch 7/13: loss1=0.1556, loss2=1.2235, dev_macro_f1=0.0365, dev_err=80.36%
2026-02-28 14:04:44,711 - lg_cotrain - INFO - Phase 2 epoch 8/13: loss1=0.1177, loss2=1.1216, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 14:04:57,912 - lg_cotrain - INFO - Phase 2 epoch 9/13: loss1=0.1020, loss2=1.0683, dev_macro_f1=0.0365, dev_err=80.36%
2026-02-28 14:05:11,003 - lg_cotrain - INFO - Phase 2 epoch 10/13: loss1=0.0909, loss2=1.0346, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 14:05:24,095 - lg_cotrain - INFO - Phase 2 epoch 11/13: loss1=0.0814, loss2=0.9891, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 14:05:37,202 - lg_cotrain - INFO - Phase 2 epoch 12/13: loss1=0.0776, loss2=0.9490, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 14:05:50,302 - lg_cotrain - INFO - Phase 2 epoch 13/13: loss1=0.0759, loss2=0.9217, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 14:05:50,302 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-28 14:05:52,654 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.0104, dev_err=95.09%, es_counter1=0, es_counter2=0
2026-02-28 14:05:54,997 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.0207, dev_err=89.73%, es_counter1=0, es_counter2=0
2026-02-28 14:05:57,335 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.0278, dev_err=85.71%, es_counter1=0, es_counter2=0
2026-02-28 14:05:59,682 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.0365, dev_err=80.36%, es_counter1=0, es_counter2=0
2026-02-28 14:06:02,021 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.0406, dev_err=77.68%, es_counter1=0, es_counter2=0
2026-02-28 14:06:04,343 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.0278, dev_err=85.71%, es_counter1=1, es_counter2=1
2026-02-28 14:06:06,670 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.0278, dev_err=85.71%, es_counter1=2, es_counter2=2
2026-02-28 14:06:08,999 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.0104, dev_err=95.09%, es_counter1=3, es_counter2=3
2026-02-28 14:06:11,324 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.0207, dev_err=89.73%, es_counter1=4, es_counter2=4
2026-02-28 14:06:13,646 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.0278, dev_err=85.71%, es_counter1=5, es_counter2=5
2026-02-28 14:06:15,964 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.0278, dev_err=85.71%, es_counter1=6, es_counter2=6
2026-02-28 14:06:18,294 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.0278, dev_err=85.71%, es_counter1=7, es_counter2=7
2026-02-28 14:06:20,622 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.0278, dev_err=85.71%, es_counter1=8, es_counter2=8
2026-02-28 14:06:22,957 - lg_cotrain - INFO - Phase 3 epoch 14: dev_macro_f1=0.0104, dev_err=95.09%, es_counter1=9, es_counter2=9
2026-02-28 14:06:22,957 - lg_cotrain - INFO - Early stopping at epoch 14
2026-02-28 14:06:22,968 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-28 14:06:24,855 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpt_8mx13t\kaikoura_earthquake_2016\50_set3\metrics.json
2026-02-28 14:06:24,855 - lg_cotrain - INFO - Test error rate: 77.47%, Test macro-F1: 0.0409, Test ECE: 0.0362
2026-02-28 14:06:24,866 - lg_cotrain - INFO - --- Trial 8/10 done: dev_macro_f1=0.0406 ---
2026-02-28 14:06:24,866 - lg_cotrain - INFO - --- Trial 9/10 ---
2026-02-28 14:06:25,384 - lg_cotrain - INFO - Starting LG-CoTrain: event=kaikoura_earthquake_2016, budget=50, seed_set=3
2026-02-28 14:06:25,396 - lg_cotrain - INFO - Detected 9 classes for event kaikoura_earthquake_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-28 14:06:25,400 - lg_cotrain - INFO - D_l1: 209, D_l2: 208, D_LG: 1119
2026-02-28 14:06:25,401 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-28 14:06:32,281 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1197, mean_prob2=0.1259
2026-02-28 14:06:38,278 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1234, mean_prob2=0.1528
2026-02-28 14:06:44,370 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1375, mean_prob2=0.3190
2026-02-28 14:06:50,390 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1674, mean_prob2=0.5552
2026-02-28 14:06:56,415 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.2724, mean_prob2=0.5902
2026-02-28 14:07:02,561 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.3972, mean_prob2=0.6764
2026-02-28 14:07:08,586 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.4303, mean_prob2=0.5586
2026-02-28 14:07:08,587 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-28 14:07:09,528 - lg_cotrain - INFO - LR scheduler: total_steps_1=1960, warmup=87; total_steps_2=1860, warmup=82
2026-02-28 14:07:09,528 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.4303, range=[0.0003, 0.9858]
2026-02-28 14:07:09,529 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.5586, range=[0.0005, 0.9908]
2026-02-28 14:07:25,802 - lg_cotrain - INFO - Phase 2 epoch 1/8: loss1=0.9593, loss2=0.5955, dev_macro_f1=0.4984, dev_err=33.93%
2026-02-28 14:07:42,286 - lg_cotrain - INFO - Phase 2 epoch 2/8: loss1=0.1396, loss2=0.4052, dev_macro_f1=0.4934, dev_err=34.38%
2026-02-28 14:07:58,293 - lg_cotrain - INFO - Phase 2 epoch 3/8: loss1=0.0819, loss2=0.4242, dev_macro_f1=0.5189, dev_err=33.04%
2026-02-28 14:08:14,302 - lg_cotrain - INFO - Phase 2 epoch 4/8: loss1=0.0645, loss2=0.2621, dev_macro_f1=0.5308, dev_err=30.80%
2026-02-28 14:08:30,296 - lg_cotrain - INFO - Phase 2 epoch 5/8: loss1=0.0693, loss2=0.2910, dev_macro_f1=0.5372, dev_err=30.80%
2026-02-28 14:08:46,433 - lg_cotrain - INFO - Phase 2 epoch 6/8: loss1=0.0848, loss2=0.2347, dev_macro_f1=0.4980, dev_err=34.38%
2026-02-28 14:09:02,282 - lg_cotrain - INFO - Phase 2 epoch 7/8: loss1=0.0584, loss2=0.1681, dev_macro_f1=0.5467, dev_err=29.46%
2026-02-28 14:09:18,382 - lg_cotrain - INFO - Phase 2 epoch 8/8: loss1=0.0476, loss2=0.1242, dev_macro_f1=0.5969, dev_err=30.36%
2026-02-28 14:09:18,383 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-28 14:09:21,257 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.5956, dev_err=30.36%, es_counter1=0, es_counter2=0
2026-02-28 14:09:24,117 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.6350, dev_err=29.46%, es_counter1=0, es_counter2=0
2026-02-28 14:09:26,991 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.6473, dev_err=27.68%, es_counter1=0, es_counter2=0
2026-02-28 14:09:29,879 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.6122, dev_err=29.91%, es_counter1=1, es_counter2=1
2026-02-28 14:09:32,778 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.6217, dev_err=29.46%, es_counter1=2, es_counter2=2
2026-02-28 14:09:35,653 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.6717, dev_err=25.45%, es_counter1=0, es_counter2=0
2026-02-28 14:09:38,492 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.6479, dev_err=26.34%, es_counter1=1, es_counter2=1
2026-02-28 14:09:41,336 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.5529, dev_err=33.48%, es_counter1=2, es_counter2=2
2026-02-28 14:09:44,191 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.6703, dev_err=26.79%, es_counter1=3, es_counter2=3
2026-02-28 14:09:47,049 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.6463, dev_err=30.36%, es_counter1=4, es_counter2=4
2026-02-28 14:09:49,893 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.6424, dev_err=28.12%, es_counter1=5, es_counter2=5
2026-02-28 14:09:52,782 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.6920, dev_err=24.11%, es_counter1=0, es_counter2=0
2026-02-28 14:09:55,628 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.6343, dev_err=30.36%, es_counter1=1, es_counter2=1
2026-02-28 14:09:58,487 - lg_cotrain - INFO - Phase 3 epoch 14: dev_macro_f1=0.6579, dev_err=30.36%, es_counter1=2, es_counter2=2
2026-02-28 14:10:01,353 - lg_cotrain - INFO - Phase 3 epoch 15: dev_macro_f1=0.6477, dev_err=28.57%, es_counter1=3, es_counter2=3
2026-02-28 14:10:04,211 - lg_cotrain - INFO - Phase 3 epoch 16: dev_macro_f1=0.6419, dev_err=30.36%, es_counter1=4, es_counter2=4
2026-02-28 14:10:07,061 - lg_cotrain - INFO - Phase 3 epoch 17: dev_macro_f1=0.6307, dev_err=27.68%, es_counter1=5, es_counter2=5
2026-02-28 14:10:09,915 - lg_cotrain - INFO - Phase 3 epoch 18: dev_macro_f1=0.6631, dev_err=26.79%, es_counter1=6, es_counter2=6
2026-02-28 14:10:12,761 - lg_cotrain - INFO - Phase 3 epoch 19: dev_macro_f1=0.6204, dev_err=29.91%, es_counter1=7, es_counter2=7
2026-02-28 14:10:15,614 - lg_cotrain - INFO - Phase 3 epoch 20: dev_macro_f1=0.6169, dev_err=31.25%, es_counter1=8, es_counter2=8
2026-02-28 14:10:18,494 - lg_cotrain - INFO - Phase 3 epoch 21: dev_macro_f1=0.6349, dev_err=30.80%, es_counter1=9, es_counter2=9
2026-02-28 14:10:18,494 - lg_cotrain - INFO - Early stopping at epoch 21
2026-02-28 14:10:18,506 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-28 14:10:20,647 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmp09yi6vq_\kaikoura_earthquake_2016\50_set3\metrics.json
2026-02-28 14:10:20,647 - lg_cotrain - INFO - Test error rate: 29.66%, Test macro-F1: 0.6514, Test ECE: 0.1401
2026-02-28 14:10:20,658 - lg_cotrain - INFO - --- Trial 9/10 done: dev_macro_f1=0.6920 ---
2026-02-28 14:10:20,659 - lg_cotrain - INFO - --- Trial 10/10 ---
2026-02-28 14:10:21,157 - lg_cotrain - INFO - Starting LG-CoTrain: event=kaikoura_earthquake_2016, budget=50, seed_set=3
2026-02-28 14:10:21,167 - lg_cotrain - INFO - Detected 9 classes for event kaikoura_earthquake_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-28 14:10:21,170 - lg_cotrain - INFO - D_l1: 209, D_l2: 208, D_LG: 1119
2026-02-28 14:10:21,171 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-28 14:10:27,487 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1356, mean_prob2=0.1302
2026-02-28 14:10:32,829 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1479, mean_prob2=0.1459
2026-02-28 14:10:38,194 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.2283, mean_prob2=0.2490
2026-02-28 14:10:43,577 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.3800, mean_prob2=0.3435
2026-02-28 14:10:48,927 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.5438, mean_prob2=0.4680
2026-02-28 14:10:54,293 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.6134, mean_prob2=0.5497
2026-02-28 14:10:59,635 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.6032, mean_prob2=0.5954
2026-02-28 14:10:59,635 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-28 14:11:00,770 - lg_cotrain - INFO - LR scheduler: total_steps_1=1190, warmup=109; total_steps_2=1190, warmup=109
2026-02-28 14:11:00,771 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.6032, range=[0.0014, 0.9793]
2026-02-28 14:11:00,771 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.5954, range=[0.0009, 0.9789]
2026-02-28 14:11:15,041 - lg_cotrain - INFO - Phase 2 epoch 1/14: loss1=1.2673, loss2=1.0913, dev_macro_f1=0.2148, dev_err=51.79%
2026-02-28 14:11:29,235 - lg_cotrain - INFO - Phase 2 epoch 2/14: loss1=0.1966, loss2=0.5558, dev_macro_f1=0.4411, dev_err=37.05%
2026-02-28 14:11:43,447 - lg_cotrain - INFO - Phase 2 epoch 3/14: loss1=0.0702, loss2=0.2619, dev_macro_f1=0.5099, dev_err=35.71%
2026-02-28 14:11:57,724 - lg_cotrain - INFO - Phase 2 epoch 4/14: loss1=0.0444, loss2=0.2365, dev_macro_f1=0.6100, dev_err=31.70%
2026-02-28 14:12:12,014 - lg_cotrain - INFO - Phase 2 epoch 5/14: loss1=0.0429, loss2=0.1712, dev_macro_f1=0.5619, dev_err=33.48%
2026-02-28 14:12:26,344 - lg_cotrain - INFO - Phase 2 epoch 6/14: loss1=0.0491, loss2=0.1789, dev_macro_f1=0.6238, dev_err=29.91%
2026-02-28 14:12:40,591 - lg_cotrain - INFO - Phase 2 epoch 7/14: loss1=0.0644, loss2=0.1761, dev_macro_f1=0.5723, dev_err=34.82%
2026-02-28 14:12:54,763 - lg_cotrain - INFO - Phase 2 epoch 8/14: loss1=0.0465, loss2=0.0659, dev_macro_f1=0.6281, dev_err=29.91%
2026-02-28 14:13:08,928 - lg_cotrain - INFO - Phase 2 epoch 9/14: loss1=0.0793, loss2=0.0734, dev_macro_f1=0.5810, dev_err=33.04%
2026-02-28 14:13:23,023 - lg_cotrain - INFO - Phase 2 epoch 10/14: loss1=0.0650, loss2=0.0879, dev_macro_f1=0.6137, dev_err=31.70%
2026-02-28 14:13:37,169 - lg_cotrain - INFO - Phase 2 epoch 11/14: loss1=0.0484, loss2=0.0535, dev_macro_f1=0.6578, dev_err=28.57%
2026-02-28 14:13:51,280 - lg_cotrain - INFO - Phase 2 epoch 12/14: loss1=0.0439, loss2=0.0438, dev_macro_f1=0.5651, dev_err=33.48%
2026-02-28 14:14:05,556 - lg_cotrain - INFO - Phase 2 epoch 13/14: loss1=0.0314, loss2=0.0317, dev_macro_f1=0.6085, dev_err=31.70%
2026-02-28 14:14:19,821 - lg_cotrain - INFO - Phase 2 epoch 14/14: loss1=0.0398, loss2=0.0244, dev_macro_f1=0.5812, dev_err=34.38%
2026-02-28 14:14:19,821 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-28 14:14:22,347 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.6383, dev_err=29.46%, es_counter1=0, es_counter2=0
2026-02-28 14:14:24,879 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.6321, dev_err=31.70%, es_counter1=1, es_counter2=1
2026-02-28 14:14:27,407 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.6596, dev_err=26.34%, es_counter1=0, es_counter2=0
2026-02-28 14:14:29,968 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.6788, dev_err=25.89%, es_counter1=0, es_counter2=0
2026-02-28 14:14:32,482 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.6726, dev_err=27.23%, es_counter1=1, es_counter2=1
2026-02-28 14:14:35,003 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.6605, dev_err=26.79%, es_counter1=2, es_counter2=2
2026-02-28 14:14:37,544 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.6953, dev_err=26.34%, es_counter1=0, es_counter2=0
2026-02-28 14:14:40,059 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.6762, dev_err=27.23%, es_counter1=1, es_counter2=1
2026-02-28 14:14:42,591 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.6450, dev_err=29.02%, es_counter1=2, es_counter2=2
2026-02-28 14:14:45,115 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.6752, dev_err=28.12%, es_counter1=3, es_counter2=3
2026-02-28 14:14:47,676 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.7053, dev_err=26.79%, es_counter1=0, es_counter2=0
2026-02-28 14:14:50,190 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.6867, dev_err=28.12%, es_counter1=1, es_counter2=1
2026-02-28 14:14:52,706 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.7022, dev_err=26.79%, es_counter1=2, es_counter2=2
2026-02-28 14:14:55,227 - lg_cotrain - INFO - Phase 3 epoch 14: dev_macro_f1=0.6738, dev_err=29.46%, es_counter1=3, es_counter2=3
2026-02-28 14:14:57,760 - lg_cotrain - INFO - Phase 3 epoch 15: dev_macro_f1=0.6887, dev_err=27.23%, es_counter1=4, es_counter2=4
2026-02-28 14:15:00,309 - lg_cotrain - INFO - Phase 3 epoch 16: dev_macro_f1=0.6756, dev_err=29.91%, es_counter1=5, es_counter2=5
2026-02-28 14:15:02,858 - lg_cotrain - INFO - Phase 3 epoch 17: dev_macro_f1=0.6782, dev_err=29.02%, es_counter1=6, es_counter2=6
2026-02-28 14:15:05,377 - lg_cotrain - INFO - Phase 3 epoch 18: dev_macro_f1=0.6770, dev_err=29.02%, es_counter1=7, es_counter2=7
2026-02-28 14:15:07,913 - lg_cotrain - INFO - Phase 3 epoch 19: dev_macro_f1=0.6780, dev_err=31.25%, es_counter1=8, es_counter2=8
2026-02-28 14:15:10,412 - lg_cotrain - INFO - Phase 3 epoch 20: dev_macro_f1=0.6997, dev_err=27.68%, es_counter1=9, es_counter2=9
2026-02-28 14:15:12,949 - lg_cotrain - INFO - Phase 3 epoch 21: dev_macro_f1=0.7052, dev_err=27.23%, es_counter1=10, es_counter2=10
2026-02-28 14:15:12,949 - lg_cotrain - INFO - Early stopping at epoch 21
2026-02-28 14:15:12,960 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-28 14:15:14,904 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpw1fhf1q9\kaikoura_earthquake_2016\50_set3\metrics.json
2026-02-28 14:15:14,904 - lg_cotrain - INFO - Test error rate: 27.82%, Test macro-F1: 0.6600, Test ECE: 0.0942
2026-02-28 14:15:14,914 - lg_cotrain - INFO - --- Trial 10/10 done: dev_macro_f1=0.7053 ---
