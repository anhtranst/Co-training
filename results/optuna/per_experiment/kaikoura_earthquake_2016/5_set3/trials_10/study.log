2026-02-28 09:16:56,691 - lg_cotrain - INFO - === Optuna study: kaikoura_earthquake_2016 budget=5 seed=3 | target=10 trials, 0 replayed, 10 new ===
2026-02-28 09:16:56,691 - lg_cotrain - INFO - --- Trial 1/10 ---
2026-02-28 09:16:57,197 - lg_cotrain - INFO - Starting LG-CoTrain: event=kaikoura_earthquake_2016, budget=5, seed_set=3
2026-02-28 09:16:57,239 - lg_cotrain - INFO - Detected 9 classes for event kaikoura_earthquake_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-28 09:16:57,246 - lg_cotrain - INFO - D_l1: 27, D_l2: 18, D_LG: 1491
2026-02-28 09:16:57,246 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-28 09:17:04,066 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1169, mean_prob2=0.1158
2026-02-28 09:17:09,882 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1153, mean_prob2=0.1232
2026-02-28 09:17:15,680 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1104, mean_prob2=0.1192
2026-02-28 09:17:21,485 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1202, mean_prob2=0.1201
2026-02-28 09:17:27,326 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1263, mean_prob2=0.1352
2026-02-28 09:17:33,197 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1321, mean_prob2=0.1422
2026-02-28 09:17:39,044 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1548, mean_prob2=0.1666
2026-02-28 09:17:39,044 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-28 09:17:40,043 - lg_cotrain - INFO - LR scheduler: total_steps_1=1892, warmup=88; total_steps_2=1892, warmup=88
2026-02-28 09:17:40,043 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1548, range=[0.0276, 0.4898]
2026-02-28 09:17:40,044 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1666, range=[0.0180, 0.4799]
2026-02-28 09:18:03,499 - lg_cotrain - INFO - Phase 2 epoch 1/18: loss1=0.2363, loss2=0.2143, dev_macro_f1=0.5206, dev_err=35.71%
2026-02-28 09:18:26,974 - lg_cotrain - INFO - Phase 2 epoch 2/18: loss1=0.0969, loss2=0.5303, dev_macro_f1=0.4590, dev_err=38.84%
2026-02-28 09:18:50,417 - lg_cotrain - INFO - Phase 2 epoch 3/18: loss1=0.0553, loss2=0.6553, dev_macro_f1=0.4786, dev_err=36.16%
2026-02-28 09:19:13,885 - lg_cotrain - INFO - Phase 2 epoch 4/18: loss1=0.0497, loss2=0.8414, dev_macro_f1=0.4643, dev_err=36.61%
2026-02-28 09:19:37,266 - lg_cotrain - INFO - Phase 2 epoch 5/18: loss1=0.0360, loss2=1.1431, dev_macro_f1=0.4449, dev_err=38.39%
2026-02-28 09:20:00,616 - lg_cotrain - INFO - Phase 2 epoch 6/18: loss1=0.0246, loss2=1.4480, dev_macro_f1=0.4204, dev_err=39.29%
2026-02-28 09:20:24,005 - lg_cotrain - INFO - Phase 2 epoch 7/18: loss1=0.0411, loss2=1.3963, dev_macro_f1=0.4161, dev_err=42.86%
2026-02-28 09:20:47,366 - lg_cotrain - INFO - Phase 2 epoch 8/18: loss1=0.0210, loss2=1.3990, dev_macro_f1=0.4623, dev_err=37.95%
2026-02-28 09:21:10,699 - lg_cotrain - INFO - Phase 2 epoch 9/18: loss1=0.0134, loss2=1.4028, dev_macro_f1=0.4930, dev_err=34.82%
2026-02-28 09:21:34,050 - lg_cotrain - INFO - Phase 2 epoch 10/18: loss1=0.0208, loss2=1.4698, dev_macro_f1=0.4481, dev_err=39.73%
2026-02-28 09:21:57,341 - lg_cotrain - INFO - Phase 2 epoch 11/18: loss1=0.0249, loss2=1.3495, dev_macro_f1=0.3664, dev_err=43.30%
2026-02-28 09:22:20,627 - lg_cotrain - INFO - Phase 2 epoch 12/18: loss1=0.0105, loss2=1.3313, dev_macro_f1=0.2668, dev_err=48.21%
2026-02-28 09:22:43,922 - lg_cotrain - INFO - Phase 2 epoch 13/18: loss1=0.0085, loss2=1.3410, dev_macro_f1=0.2773, dev_err=47.77%
2026-02-28 09:23:07,191 - lg_cotrain - INFO - Phase 2 epoch 14/18: loss1=0.0073, loss2=1.3267, dev_macro_f1=0.2734, dev_err=48.21%
2026-02-28 09:23:30,473 - lg_cotrain - INFO - Phase 2 epoch 15/18: loss1=0.0068, loss2=1.3591, dev_macro_f1=0.2955, dev_err=48.21%
2026-02-28 09:23:53,717 - lg_cotrain - INFO - Phase 2 epoch 16/18: loss1=0.0105, loss2=1.3507, dev_macro_f1=0.2871, dev_err=47.32%
2026-02-28 09:24:16,920 - lg_cotrain - INFO - Phase 2 epoch 17/18: loss1=0.0072, loss2=1.3566, dev_macro_f1=0.3032, dev_err=47.32%
2026-02-28 09:24:40,121 - lg_cotrain - INFO - Phase 2 epoch 18/18: loss1=0.0068, loss2=1.3727, dev_macro_f1=0.3065, dev_err=47.32%
2026-02-28 09:24:40,121 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-28 09:24:41,214 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.3012, dev_err=47.32%, es_counter1=0, es_counter2=0
2026-02-28 09:24:42,318 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.4240, dev_err=40.62%, es_counter1=0, es_counter2=0
2026-02-28 09:24:43,388 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.4232, dev_err=41.07%, es_counter1=1, es_counter2=1
2026-02-28 09:24:44,479 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.4255, dev_err=40.18%, es_counter1=0, es_counter2=0
2026-02-28 09:24:45,569 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.4565, dev_err=36.61%, es_counter1=0, es_counter2=0
2026-02-28 09:24:46,660 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.4931, dev_err=34.82%, es_counter1=0, es_counter2=0
2026-02-28 09:24:47,730 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.4894, dev_err=35.27%, es_counter1=1, es_counter2=1
2026-02-28 09:24:48,824 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.4985, dev_err=35.27%, es_counter1=0, es_counter2=0
2026-02-28 09:24:49,901 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.5192, dev_err=34.38%, es_counter1=0, es_counter2=0
2026-02-28 09:24:51,001 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.5333, dev_err=34.38%, es_counter1=0, es_counter2=0
2026-02-28 09:24:52,070 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.5290, dev_err=34.82%, es_counter1=1, es_counter2=1
2026-02-28 09:24:53,144 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.5059, dev_err=36.61%, es_counter1=2, es_counter2=2
2026-02-28 09:24:54,217 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.5106, dev_err=36.16%, es_counter1=3, es_counter2=3
2026-02-28 09:24:55,278 - lg_cotrain - INFO - Phase 3 epoch 14: dev_macro_f1=0.5047, dev_err=36.61%, es_counter1=4, es_counter2=4
2026-02-28 09:24:56,349 - lg_cotrain - INFO - Phase 3 epoch 15: dev_macro_f1=0.5156, dev_err=36.61%, es_counter1=5, es_counter2=5
2026-02-28 09:24:57,419 - lg_cotrain - INFO - Phase 3 epoch 16: dev_macro_f1=0.5125, dev_err=37.05%, es_counter1=6, es_counter2=6
2026-02-28 09:24:57,419 - lg_cotrain - INFO - Early stopping at epoch 16
2026-02-28 09:24:57,429 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-28 09:24:59,746 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpcw55i8s5\kaikoura_earthquake_2016\5_set3\metrics.json
2026-02-28 09:24:59,746 - lg_cotrain - INFO - Test error rate: 33.10%, Test macro-F1: 0.5524, Test ECE: 0.1687
2026-02-28 09:24:59,757 - lg_cotrain - INFO - --- Trial 1/10 done: dev_macro_f1=0.5333 ---
2026-02-28 09:24:59,758 - lg_cotrain - INFO - --- Trial 2/10 ---
2026-02-28 09:25:00,273 - lg_cotrain - INFO - Starting LG-CoTrain: event=kaikoura_earthquake_2016, budget=5, seed_set=3
2026-02-28 09:25:00,286 - lg_cotrain - INFO - Detected 9 classes for event kaikoura_earthquake_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-28 09:25:00,292 - lg_cotrain - INFO - D_l1: 27, D_l2: 18, D_LG: 1491
2026-02-28 09:25:00,293 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-28 09:25:07,827 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1165, mean_prob2=0.1140
2026-02-28 09:25:14,254 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1101, mean_prob2=0.1234
2026-02-28 09:25:20,675 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1168, mean_prob2=0.1296
2026-02-28 09:25:27,113 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1287, mean_prob2=0.1340
2026-02-28 09:25:33,585 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1421, mean_prob2=0.1446
2026-02-28 09:25:40,021 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1578, mean_prob2=0.1372
2026-02-28 09:25:46,451 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1763, mean_prob2=0.1660
2026-02-28 09:25:46,451 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-28 09:25:47,463 - lg_cotrain - INFO - LR scheduler: total_steps_1=3205, warmup=259; total_steps_2=3105, warmup=251
2026-02-28 09:25:47,463 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1763, range=[0.0150, 0.6283]
2026-02-28 09:25:47,463 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1660, range=[0.0107, 0.6422]
2026-02-28 09:26:15,015 - lg_cotrain - INFO - Phase 2 epoch 1/15: loss1=0.2393, loss2=0.2425, dev_macro_f1=0.5098, dev_err=34.82%
2026-02-28 09:26:42,658 - lg_cotrain - INFO - Phase 2 epoch 2/15: loss1=0.0946, loss2=0.4448, dev_macro_f1=0.4706, dev_err=35.71%
2026-02-28 09:27:10,290 - lg_cotrain - INFO - Phase 2 epoch 3/15: loss1=0.0993, loss2=0.4135, dev_macro_f1=0.5212, dev_err=35.71%
2026-02-28 09:27:37,965 - lg_cotrain - INFO - Phase 2 epoch 4/15: loss1=0.0806, loss2=0.4164, dev_macro_f1=0.4561, dev_err=37.95%
2026-02-28 09:28:05,649 - lg_cotrain - INFO - Phase 2 epoch 5/15: loss1=0.1375, loss2=0.9248, dev_macro_f1=0.4890, dev_err=43.30%
2026-02-28 09:28:33,329 - lg_cotrain - INFO - Phase 2 epoch 6/15: loss1=0.0624, loss2=1.5044, dev_macro_f1=0.4767, dev_err=38.39%
2026-02-28 09:29:00,927 - lg_cotrain - INFO - Phase 2 epoch 7/15: loss1=0.0291, loss2=1.5549, dev_macro_f1=0.5221, dev_err=34.82%
2026-02-28 09:29:28,603 - lg_cotrain - INFO - Phase 2 epoch 8/15: loss1=0.0162, loss2=1.6223, dev_macro_f1=0.4987, dev_err=38.39%
2026-02-28 09:29:56,288 - lg_cotrain - INFO - Phase 2 epoch 9/15: loss1=0.0107, loss2=1.6235, dev_macro_f1=0.4735, dev_err=38.84%
2026-02-28 09:30:24,010 - lg_cotrain - INFO - Phase 2 epoch 10/15: loss1=0.0092, loss2=1.6607, dev_macro_f1=0.5109, dev_err=36.16%
2026-02-28 09:30:51,687 - lg_cotrain - INFO - Phase 2 epoch 11/15: loss1=0.0087, loss2=1.6762, dev_macro_f1=0.4806, dev_err=37.95%
2026-02-28 09:31:19,344 - lg_cotrain - INFO - Phase 2 epoch 12/15: loss1=0.0091, loss2=1.6726, dev_macro_f1=0.4585, dev_err=39.73%
2026-02-28 09:31:47,018 - lg_cotrain - INFO - Phase 2 epoch 13/15: loss1=0.0071, loss2=1.6738, dev_macro_f1=0.4787, dev_err=39.29%
2026-02-28 09:32:14,708 - lg_cotrain - INFO - Phase 2 epoch 14/15: loss1=0.0070, loss2=1.6739, dev_macro_f1=0.3148, dev_err=46.43%
2026-02-28 09:32:42,444 - lg_cotrain - INFO - Phase 2 epoch 15/15: loss1=0.0059, loss2=1.6757, dev_macro_f1=0.3303, dev_err=45.98%
2026-02-28 09:32:42,444 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-28 09:32:43,689 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.5976, dev_err=32.14%, es_counter1=0, es_counter2=0
2026-02-28 09:32:44,927 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.6144, dev_err=32.14%, es_counter1=0, es_counter2=0
2026-02-28 09:32:46,136 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.5187, dev_err=38.39%, es_counter1=1, es_counter2=1
2026-02-28 09:32:47,351 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.5186, dev_err=38.39%, es_counter1=2, es_counter2=2
2026-02-28 09:32:48,571 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.5443, dev_err=35.71%, es_counter1=3, es_counter2=3
2026-02-28 09:32:49,786 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.5372, dev_err=35.27%, es_counter1=4, es_counter2=4
2026-02-28 09:32:49,786 - lg_cotrain - INFO - Early stopping at epoch 6
2026-02-28 09:32:49,798 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-28 09:32:52,367 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmp1dje6ibr\kaikoura_earthquake_2016\5_set3\metrics.json
2026-02-28 09:32:52,367 - lg_cotrain - INFO - Test error rate: 31.95%, Test macro-F1: 0.6034, Test ECE: 0.1703
2026-02-28 09:32:52,378 - lg_cotrain - INFO - --- Trial 2/10 done: dev_macro_f1=0.6144 ---
2026-02-28 09:32:52,378 - lg_cotrain - INFO - --- Trial 3/10 ---
2026-02-28 09:32:52,863 - lg_cotrain - INFO - Starting LG-CoTrain: event=kaikoura_earthquake_2016, budget=5, seed_set=3
2026-02-28 09:32:52,874 - lg_cotrain - INFO - Detected 9 classes for event kaikoura_earthquake_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-28 09:32:52,880 - lg_cotrain - INFO - D_l1: 27, D_l2: 18, D_LG: 1491
2026-02-28 09:32:52,881 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-28 09:32:59,595 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1168, mean_prob2=0.1105
2026-02-28 09:33:05,389 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1128, mean_prob2=0.1140
2026-02-28 09:33:11,177 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1070, mean_prob2=0.1164
2026-02-28 09:33:17,006 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1230, mean_prob2=0.1229
2026-02-28 09:33:22,826 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1346, mean_prob2=0.1538
2026-02-28 09:33:28,649 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1350, mean_prob2=0.1705
2026-02-28 09:33:34,511 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1371, mean_prob2=0.1839
2026-02-28 09:33:34,512 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-28 09:33:35,535 - lg_cotrain - INFO - LR scheduler: total_steps_1=1140, warmup=153; total_steps_2=1140, warmup=153
2026-02-28 09:33:35,535 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1371, range=[0.0361, 0.3931]
2026-02-28 09:33:35,536 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1839, range=[0.0208, 0.4829]
2026-02-28 09:33:58,911 - lg_cotrain - INFO - Phase 2 epoch 1/10: loss1=0.3084, loss2=0.2257, dev_macro_f1=0.4790, dev_err=35.27%
2026-02-28 09:34:22,290 - lg_cotrain - INFO - Phase 2 epoch 2/10: loss1=0.0985, loss2=0.2418, dev_macro_f1=0.5686, dev_err=33.04%
2026-02-28 09:34:45,766 - lg_cotrain - INFO - Phase 2 epoch 3/10: loss1=0.0660, loss2=0.2689, dev_macro_f1=0.5790, dev_err=33.04%
2026-02-28 09:35:09,178 - lg_cotrain - INFO - Phase 2 epoch 4/10: loss1=0.0553, loss2=0.2467, dev_macro_f1=0.6448, dev_err=29.46%
2026-02-28 09:35:32,568 - lg_cotrain - INFO - Phase 2 epoch 5/10: loss1=0.0496, loss2=0.1403, dev_macro_f1=0.5997, dev_err=32.14%
2026-02-28 09:35:55,960 - lg_cotrain - INFO - Phase 2 epoch 6/10: loss1=0.0373, loss2=0.0899, dev_macro_f1=0.5950, dev_err=33.04%
2026-02-28 09:36:19,280 - lg_cotrain - INFO - Phase 2 epoch 7/10: loss1=0.0298, loss2=0.0578, dev_macro_f1=0.6298, dev_err=29.46%
2026-02-28 09:36:42,630 - lg_cotrain - INFO - Phase 2 epoch 8/10: loss1=0.0143, loss2=0.0378, dev_macro_f1=0.6308, dev_err=29.02%
2026-02-28 09:37:06,011 - lg_cotrain - INFO - Phase 2 epoch 9/10: loss1=0.0077, loss2=0.0280, dev_macro_f1=0.6448, dev_err=28.57%
2026-02-28 09:37:29,386 - lg_cotrain - INFO - Phase 2 epoch 10/10: loss1=0.0243, loss2=0.0132, dev_macro_f1=0.6193, dev_err=29.91%
2026-02-28 09:37:29,386 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-28 09:37:30,497 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.6159, dev_err=30.36%, es_counter1=0, es_counter2=0
2026-02-28 09:37:31,605 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.6248, dev_err=29.46%, es_counter1=0, es_counter2=0
2026-02-28 09:37:32,677 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.6194, dev_err=29.91%, es_counter1=1, es_counter2=1
2026-02-28 09:37:33,777 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.6279, dev_err=29.46%, es_counter1=0, es_counter2=0
2026-02-28 09:37:34,874 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.6427, dev_err=28.57%, es_counter1=0, es_counter2=0
2026-02-28 09:37:35,965 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.6473, dev_err=28.12%, es_counter1=0, es_counter2=0
2026-02-28 09:37:37,032 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.6473, dev_err=28.12%, es_counter1=1, es_counter2=1
2026-02-28 09:37:38,122 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.6525, dev_err=27.68%, es_counter1=0, es_counter2=0
2026-02-28 09:37:39,216 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.6858, dev_err=28.57%, es_counter1=0, es_counter2=0
2026-02-28 09:37:40,297 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.6723, dev_err=28.57%, es_counter1=1, es_counter2=1
2026-02-28 09:37:41,377 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.6642, dev_err=29.02%, es_counter1=2, es_counter2=2
2026-02-28 09:37:42,463 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.6586, dev_err=29.46%, es_counter1=3, es_counter2=3
2026-02-28 09:37:43,537 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.6586, dev_err=29.46%, es_counter1=4, es_counter2=4
2026-02-28 09:37:44,614 - lg_cotrain - INFO - Phase 3 epoch 14: dev_macro_f1=0.6489, dev_err=30.36%, es_counter1=5, es_counter2=5
2026-02-28 09:37:44,614 - lg_cotrain - INFO - Early stopping at epoch 14
2026-02-28 09:37:44,624 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-28 09:37:46,954 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmppv4o4wb0\kaikoura_earthquake_2016\5_set3\metrics.json
2026-02-28 09:37:46,954 - lg_cotrain - INFO - Test error rate: 25.06%, Test macro-F1: 0.6851, Test ECE: 0.1272
2026-02-28 09:37:46,964 - lg_cotrain - INFO - --- Trial 3/10 done: dev_macro_f1=0.6858 ---
2026-02-28 09:37:46,964 - lg_cotrain - INFO - --- Trial 4/10 ---
2026-02-28 09:37:47,460 - lg_cotrain - INFO - Starting LG-CoTrain: event=kaikoura_earthquake_2016, budget=5, seed_set=3
2026-02-28 09:37:47,471 - lg_cotrain - INFO - Detected 9 classes for event kaikoura_earthquake_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-28 09:37:47,476 - lg_cotrain - INFO - D_l1: 27, D_l2: 18, D_LG: 1491
2026-02-28 09:37:47,476 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-28 09:37:53,930 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1282, mean_prob2=0.1079
2026-02-28 09:37:59,444 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1063, mean_prob2=0.1201
2026-02-28 09:38:05,007 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1239, mean_prob2=0.1267
2026-02-28 09:38:10,550 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1110, mean_prob2=0.1230
2026-02-28 09:38:16,127 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1348, mean_prob2=0.1443
2026-02-28 09:38:21,656 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1204, mean_prob2=0.1475
2026-02-28 09:38:27,188 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1351, mean_prob2=0.1481
2026-02-28 09:38:27,188 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-28 09:38:28,263 - lg_cotrain - INFO - LR scheduler: total_steps_1=993, warmup=17; total_steps_2=993, warmup=17
2026-02-28 09:38:28,264 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1351, range=[0.0282, 0.5037]
2026-02-28 09:38:28,264 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1481, range=[0.0169, 0.4274]
2026-02-28 09:38:49,402 - lg_cotrain - INFO - Phase 2 epoch 1/19: loss1=0.2375, loss2=0.1995, dev_macro_f1=0.5042, dev_err=34.82%
2026-02-28 09:39:10,652 - lg_cotrain - INFO - Phase 2 epoch 2/19: loss1=0.0709, loss2=0.2973, dev_macro_f1=0.5346, dev_err=33.48%
2026-02-28 09:39:31,854 - lg_cotrain - INFO - Phase 2 epoch 3/19: loss1=0.0407, loss2=0.2847, dev_macro_f1=0.6157, dev_err=29.91%
2026-02-28 09:39:53,063 - lg_cotrain - INFO - Phase 2 epoch 4/19: loss1=0.0674, loss2=0.2880, dev_macro_f1=0.5958, dev_err=31.70%
2026-02-28 09:40:14,278 - lg_cotrain - INFO - Phase 2 epoch 5/19: loss1=0.0522, loss2=0.2773, dev_macro_f1=0.6134, dev_err=30.80%
2026-02-28 09:40:35,484 - lg_cotrain - INFO - Phase 2 epoch 6/19: loss1=0.0632, loss2=0.1645, dev_macro_f1=0.6276, dev_err=29.91%
2026-02-28 09:40:56,659 - lg_cotrain - INFO - Phase 2 epoch 7/19: loss1=0.0819, loss2=0.1394, dev_macro_f1=0.6012, dev_err=32.14%
2026-02-28 09:41:17,834 - lg_cotrain - INFO - Phase 2 epoch 8/19: loss1=0.0541, loss2=0.0880, dev_macro_f1=0.6299, dev_err=29.91%
2026-02-28 09:41:39,031 - lg_cotrain - INFO - Phase 2 epoch 9/19: loss1=0.0259, loss2=0.0951, dev_macro_f1=0.6063, dev_err=30.80%
2026-02-28 09:42:00,195 - lg_cotrain - INFO - Phase 2 epoch 10/19: loss1=0.0487, loss2=0.0509, dev_macro_f1=0.6180, dev_err=30.80%
2026-02-28 09:42:21,369 - lg_cotrain - INFO - Phase 2 epoch 11/19: loss1=0.0398, loss2=0.0390, dev_macro_f1=0.6106, dev_err=32.59%
2026-02-28 09:42:42,574 - lg_cotrain - INFO - Phase 2 epoch 12/19: loss1=0.0266, loss2=0.0287, dev_macro_f1=0.6142, dev_err=31.70%
2026-02-28 09:43:03,719 - lg_cotrain - INFO - Phase 2 epoch 13/19: loss1=0.0392, loss2=0.0141, dev_macro_f1=0.6342, dev_err=29.91%
2026-02-28 09:43:24,861 - lg_cotrain - INFO - Phase 2 epoch 14/19: loss1=0.0245, loss2=0.0120, dev_macro_f1=0.6237, dev_err=30.80%
2026-02-28 09:43:46,081 - lg_cotrain - INFO - Phase 2 epoch 15/19: loss1=0.0171, loss2=0.0117, dev_macro_f1=0.6240, dev_err=30.36%
2026-02-28 09:44:07,304 - lg_cotrain - INFO - Phase 2 epoch 16/19: loss1=0.0141, loss2=0.0201, dev_macro_f1=0.6416, dev_err=29.46%
2026-02-28 09:44:28,505 - lg_cotrain - INFO - Phase 2 epoch 17/19: loss1=0.0123, loss2=0.0121, dev_macro_f1=0.6397, dev_err=29.46%
2026-02-28 09:44:49,710 - lg_cotrain - INFO - Phase 2 epoch 18/19: loss1=0.0106, loss2=0.0101, dev_macro_f1=0.6283, dev_err=30.36%
2026-02-28 09:45:10,915 - lg_cotrain - INFO - Phase 2 epoch 19/19: loss1=0.0093, loss2=0.0144, dev_macro_f1=0.6358, dev_err=29.46%
2026-02-28 09:45:10,915 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-28 09:45:11,930 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.6287, dev_err=30.36%, es_counter1=0, es_counter2=0
2026-02-28 09:45:12,955 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.6294, dev_err=30.36%, es_counter1=0, es_counter2=0
2026-02-28 09:45:13,969 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.6316, dev_err=30.36%, es_counter1=0, es_counter2=0
2026-02-28 09:45:14,952 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.6295, dev_err=30.36%, es_counter1=1, es_counter2=1
2026-02-28 09:45:15,970 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.6319, dev_err=29.91%, es_counter1=0, es_counter2=0
2026-02-28 09:45:16,954 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.6316, dev_err=29.91%, es_counter1=1, es_counter2=1
2026-02-28 09:45:17,963 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.6354, dev_err=29.91%, es_counter1=0, es_counter2=0
2026-02-28 09:45:18,978 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.6417, dev_err=29.91%, es_counter1=0, es_counter2=0
2026-02-28 09:45:19,966 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.6408, dev_err=29.91%, es_counter1=1, es_counter2=1
2026-02-28 09:45:20,963 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.6319, dev_err=30.36%, es_counter1=2, es_counter2=2
2026-02-28 09:45:21,955 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.6367, dev_err=29.91%, es_counter1=3, es_counter2=3
2026-02-28 09:45:22,948 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.6342, dev_err=30.36%, es_counter1=4, es_counter2=4
2026-02-28 09:45:23,950 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.6298, dev_err=30.80%, es_counter1=5, es_counter2=5
2026-02-28 09:45:24,944 - lg_cotrain - INFO - Phase 3 epoch 14: dev_macro_f1=0.6213, dev_err=31.70%, es_counter1=6, es_counter2=6
2026-02-28 09:45:25,935 - lg_cotrain - INFO - Phase 3 epoch 15: dev_macro_f1=0.6117, dev_err=32.59%, es_counter1=7, es_counter2=7
2026-02-28 09:45:25,936 - lg_cotrain - INFO - Early stopping at epoch 15
2026-02-28 09:45:25,947 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-28 09:45:28,173 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmp03l5fn8n\kaikoura_earthquake_2016\5_set3\metrics.json
2026-02-28 09:45:28,173 - lg_cotrain - INFO - Test error rate: 27.36%, Test macro-F1: 0.6568, Test ECE: 0.1430
2026-02-28 09:45:28,183 - lg_cotrain - INFO - --- Trial 4/10 done: dev_macro_f1=0.6417 ---
2026-02-28 09:45:28,183 - lg_cotrain - INFO - --- Trial 5/10 ---
2026-02-28 09:45:28,701 - lg_cotrain - INFO - Starting LG-CoTrain: event=kaikoura_earthquake_2016, budget=5, seed_set=3
2026-02-28 09:45:28,712 - lg_cotrain - INFO - Detected 9 classes for event kaikoura_earthquake_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-28 09:45:28,715 - lg_cotrain - INFO - D_l1: 27, D_l2: 18, D_LG: 1491
2026-02-28 09:45:28,717 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-28 09:45:35,225 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1262, mean_prob2=0.1085
2026-02-28 09:45:40,702 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1084, mean_prob2=0.1205
2026-02-28 09:45:46,212 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1193, mean_prob2=0.1256
2026-02-28 09:45:51,741 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1090, mean_prob2=0.1252
2026-02-28 09:45:57,270 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1243, mean_prob2=0.1414
2026-02-28 09:46:02,792 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1395, mean_prob2=0.1419
2026-02-28 09:46:08,346 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1275, mean_prob2=0.1368
2026-02-28 09:46:08,347 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-28 09:46:09,591 - lg_cotrain - INFO - LR scheduler: total_steps_1=382, warmup=90; total_steps_2=382, warmup=90
2026-02-28 09:46:09,592 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1275, range=[0.0329, 0.4168]
2026-02-28 09:46:09,592 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1368, range=[0.0188, 0.3969]
2026-02-28 09:46:30,695 - lg_cotrain - INFO - Phase 2 epoch 1/6: loss1=0.2754, loss2=0.2293, dev_macro_f1=0.4517, dev_err=38.39%
2026-02-28 09:46:51,854 - lg_cotrain - INFO - Phase 2 epoch 2/6: loss1=0.0945, loss2=0.1902, dev_macro_f1=0.5114, dev_err=33.04%
2026-02-28 09:47:13,030 - lg_cotrain - INFO - Phase 2 epoch 3/6: loss1=0.0374, loss2=0.2689, dev_macro_f1=0.6504, dev_err=27.68%
2026-02-28 09:47:34,196 - lg_cotrain - INFO - Phase 2 epoch 4/6: loss1=0.0305, loss2=0.2094, dev_macro_f1=0.6129, dev_err=32.14%
2026-02-28 09:47:55,328 - lg_cotrain - INFO - Phase 2 epoch 5/6: loss1=0.0230, loss2=0.1625, dev_macro_f1=0.5746, dev_err=35.27%
2026-02-28 09:48:16,441 - lg_cotrain - INFO - Phase 2 epoch 6/6: loss1=0.0160, loss2=0.0919, dev_macro_f1=0.5925, dev_err=32.59%
2026-02-28 09:48:16,441 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-28 09:48:17,447 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.6002, dev_err=31.70%, es_counter1=0, es_counter2=0
2026-02-28 09:48:18,434 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.5946, dev_err=32.14%, es_counter1=1, es_counter2=1
2026-02-28 09:48:19,422 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.5730, dev_err=33.93%, es_counter1=2, es_counter2=2
2026-02-28 09:48:20,413 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.5725, dev_err=33.48%, es_counter1=3, es_counter2=3
2026-02-28 09:48:21,404 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.5784, dev_err=33.48%, es_counter1=4, es_counter2=4
2026-02-28 09:48:22,395 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.5866, dev_err=34.82%, es_counter1=5, es_counter2=5
2026-02-28 09:48:22,395 - lg_cotrain - INFO - Early stopping at epoch 6
2026-02-28 09:48:22,406 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-28 09:48:24,649 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpad58b097\kaikoura_earthquake_2016\5_set3\metrics.json
2026-02-28 09:48:24,649 - lg_cotrain - INFO - Test error rate: 28.51%, Test macro-F1: 0.6419, Test ECE: 0.1815
2026-02-28 09:48:24,658 - lg_cotrain - INFO - --- Trial 5/10 done: dev_macro_f1=0.6002 ---
2026-02-28 09:48:24,658 - lg_cotrain - INFO - --- Trial 6/10 ---
2026-02-28 09:48:25,161 - lg_cotrain - INFO - Starting LG-CoTrain: event=kaikoura_earthquake_2016, budget=5, seed_set=3
2026-02-28 09:48:25,172 - lg_cotrain - INFO - Detected 9 classes for event kaikoura_earthquake_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-28 09:48:25,175 - lg_cotrain - INFO - D_l1: 27, D_l2: 18, D_LG: 1491
2026-02-28 09:48:25,177 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-28 09:48:31,893 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1142, mean_prob2=0.1100
2026-02-28 09:48:37,647 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1105, mean_prob2=0.1087
2026-02-28 09:48:43,417 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.0973, mean_prob2=0.1140
2026-02-28 09:48:49,169 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1099, mean_prob2=0.1337
2026-02-28 09:48:54,968 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1106, mean_prob2=0.1343
2026-02-28 09:49:00,763 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1179, mean_prob2=0.1330
2026-02-28 09:49:06,529 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1065, mean_prob2=0.1235
2026-02-28 09:49:06,529 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-28 09:49:07,532 - lg_cotrain - INFO - LR scheduler: total_steps_1=2080, warmup=564; total_steps_2=2080, warmup=564
2026-02-28 09:49:07,532 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1065, range=[0.0732, 0.1547]
2026-02-28 09:49:07,532 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1235, range=[0.0532, 0.1675]
2026-02-28 09:49:30,724 - lg_cotrain - INFO - Phase 2 epoch 1/20: loss1=0.2120, loss2=0.1695, dev_macro_f1=0.5227, dev_err=32.59%
2026-02-28 09:49:54,011 - lg_cotrain - INFO - Phase 2 epoch 2/20: loss1=0.0847, loss2=0.3375, dev_macro_f1=0.5130, dev_err=33.93%
2026-02-28 09:50:17,244 - lg_cotrain - INFO - Phase 2 epoch 3/20: loss1=0.1204, loss2=0.9872, dev_macro_f1=0.4086, dev_err=40.18%
2026-02-28 09:50:40,428 - lg_cotrain - INFO - Phase 2 epoch 4/20: loss1=0.1663, loss2=1.3738, dev_macro_f1=0.0278, dev_err=85.71%
2026-02-28 09:51:03,618 - lg_cotrain - INFO - Phase 2 epoch 5/20: loss1=0.1122, loss2=1.2753, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 09:51:26,809 - lg_cotrain - INFO - Phase 2 epoch 6/20: loss1=0.0874, loss2=1.1931, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 09:51:50,054 - lg_cotrain - INFO - Phase 2 epoch 7/20: loss1=0.0823, loss2=1.1344, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 09:52:13,213 - lg_cotrain - INFO - Phase 2 epoch 8/20: loss1=0.0780, loss2=1.0666, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 09:52:36,414 - lg_cotrain - INFO - Phase 2 epoch 9/20: loss1=0.0757, loss2=1.0057, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 09:52:59,592 - lg_cotrain - INFO - Phase 2 epoch 10/20: loss1=0.0774, loss2=0.9690, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 09:53:22,794 - lg_cotrain - INFO - Phase 2 epoch 11/20: loss1=0.0783, loss2=0.9224, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 09:53:45,993 - lg_cotrain - INFO - Phase 2 epoch 12/20: loss1=0.0790, loss2=0.8987, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 09:54:09,192 - lg_cotrain - INFO - Phase 2 epoch 13/20: loss1=0.0815, loss2=0.8684, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 09:54:32,436 - lg_cotrain - INFO - Phase 2 epoch 14/20: loss1=0.0841, loss2=0.8368, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 09:54:55,606 - lg_cotrain - INFO - Phase 2 epoch 15/20: loss1=0.0860, loss2=0.8141, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 09:55:18,797 - lg_cotrain - INFO - Phase 2 epoch 16/20: loss1=0.0885, loss2=0.7966, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 09:55:41,992 - lg_cotrain - INFO - Phase 2 epoch 17/20: loss1=0.0883, loss2=0.7743, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 09:56:05,222 - lg_cotrain - INFO - Phase 2 epoch 18/20: loss1=0.0885, loss2=0.7610, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 09:56:28,446 - lg_cotrain - INFO - Phase 2 epoch 19/20: loss1=0.0891, loss2=0.7416, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 09:56:51,645 - lg_cotrain - INFO - Phase 2 epoch 20/20: loss1=0.0887, loss2=0.7242, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 09:56:51,645 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-28 09:56:52,728 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.0406, dev_err=77.68%, es_counter1=0, es_counter2=0
2026-02-28 09:56:53,793 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.0406, dev_err=77.68%, es_counter1=1, es_counter2=1
2026-02-28 09:56:54,858 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.0406, dev_err=77.68%, es_counter1=2, es_counter2=2
2026-02-28 09:56:55,924 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.0406, dev_err=77.68%, es_counter1=3, es_counter2=3
2026-02-28 09:56:56,991 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.0406, dev_err=77.68%, es_counter1=4, es_counter2=4
2026-02-28 09:56:58,058 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.0190, dev_err=90.62%, es_counter1=5, es_counter2=5
2026-02-28 09:56:58,059 - lg_cotrain - INFO - Early stopping at epoch 6
2026-02-28 09:56:58,069 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-28 09:57:00,374 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpxn2z770u\kaikoura_earthquake_2016\5_set3\metrics.json
2026-02-28 09:57:00,374 - lg_cotrain - INFO - Test error rate: 77.47%, Test macro-F1: 0.0409, Test ECE: 0.2705
2026-02-28 09:57:00,385 - lg_cotrain - INFO - --- Trial 6/10 done: dev_macro_f1=0.0406 ---
2026-02-28 09:57:00,385 - lg_cotrain - INFO - --- Trial 7/10 ---
2026-02-28 09:57:00,870 - lg_cotrain - INFO - Starting LG-CoTrain: event=kaikoura_earthquake_2016, budget=5, seed_set=3
2026-02-28 09:57:00,880 - lg_cotrain - INFO - Detected 9 classes for event kaikoura_earthquake_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-28 09:57:00,885 - lg_cotrain - INFO - D_l1: 27, D_l2: 18, D_LG: 1491
2026-02-28 09:57:00,885 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-28 09:57:07,635 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1165, mean_prob2=0.1105
2026-02-28 09:57:13,413 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1118, mean_prob2=0.1127
2026-02-28 09:57:19,192 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1082, mean_prob2=0.1148
2026-02-28 09:57:24,993 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1261, mean_prob2=0.1223
2026-02-28 09:57:30,788 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1323, mean_prob2=0.1427
2026-02-28 09:57:36,614 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1336, mean_prob2=0.1562
2026-02-28 09:57:42,426 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1367, mean_prob2=0.1650
2026-02-28 09:57:42,426 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-28 09:57:43,445 - lg_cotrain - INFO - LR scheduler: total_steps_1=1422, warmup=186; total_steps_2=1422, warmup=186
2026-02-28 09:57:43,445 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1367, range=[0.0349, 0.4051]
2026-02-28 09:57:43,446 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1650, range=[0.0218, 0.4817]
2026-02-28 09:58:06,760 - lg_cotrain - INFO - Phase 2 epoch 1/13: loss1=0.2989, loss2=0.2350, dev_macro_f1=0.4384, dev_err=37.95%
2026-02-28 09:58:30,083 - lg_cotrain - INFO - Phase 2 epoch 2/13: loss1=0.1026, loss2=0.2023, dev_macro_f1=0.5364, dev_err=34.82%
2026-02-28 09:58:53,437 - lg_cotrain - INFO - Phase 2 epoch 3/13: loss1=0.0467, loss2=0.2598, dev_macro_f1=0.5776, dev_err=33.48%
2026-02-28 09:59:16,756 - lg_cotrain - INFO - Phase 2 epoch 4/13: loss1=0.0463, loss2=0.3092, dev_macro_f1=0.5855, dev_err=32.59%
2026-02-28 09:59:40,065 - lg_cotrain - INFO - Phase 2 epoch 5/13: loss1=0.0817, loss2=0.2007, dev_macro_f1=0.6333, dev_err=30.36%
2026-02-28 10:00:03,393 - lg_cotrain - INFO - Phase 2 epoch 6/13: loss1=0.0343, loss2=0.1592, dev_macro_f1=0.6259, dev_err=30.80%
2026-02-28 10:00:26,698 - lg_cotrain - INFO - Phase 2 epoch 7/13: loss1=0.0225, loss2=0.0796, dev_macro_f1=0.6299, dev_err=30.36%
2026-02-28 10:00:50,073 - lg_cotrain - INFO - Phase 2 epoch 8/13: loss1=0.0165, loss2=0.0798, dev_macro_f1=0.6632, dev_err=27.68%
2026-02-28 10:01:13,401 - lg_cotrain - INFO - Phase 2 epoch 9/13: loss1=0.0209, loss2=0.0496, dev_macro_f1=0.6189, dev_err=30.80%
2026-02-28 10:01:36,738 - lg_cotrain - INFO - Phase 2 epoch 10/13: loss1=0.0123, loss2=0.0234, dev_macro_f1=0.6350, dev_err=29.91%
2026-02-28 10:02:00,043 - lg_cotrain - INFO - Phase 2 epoch 11/13: loss1=0.0164, loss2=0.0220, dev_macro_f1=0.6269, dev_err=30.80%
2026-02-28 10:02:23,350 - lg_cotrain - INFO - Phase 2 epoch 12/13: loss1=0.0098, loss2=0.0138, dev_macro_f1=0.6495, dev_err=29.02%
2026-02-28 10:02:46,676 - lg_cotrain - INFO - Phase 2 epoch 13/13: loss1=0.0089, loss2=0.0143, dev_macro_f1=0.6322, dev_err=30.36%
2026-02-28 10:02:46,676 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-28 10:02:47,765 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.6274, dev_err=30.36%, es_counter1=0, es_counter2=0
2026-02-28 10:02:48,849 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.6362, dev_err=29.91%, es_counter1=0, es_counter2=0
2026-02-28 10:02:49,914 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.6353, dev_err=30.36%, es_counter1=1, es_counter2=1
2026-02-28 10:02:50,988 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.6353, dev_err=30.36%, es_counter1=2, es_counter2=2
2026-02-28 10:02:52,060 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.6265, dev_err=31.25%, es_counter1=3, es_counter2=3
2026-02-28 10:02:53,136 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.6100, dev_err=33.04%, es_counter1=4, es_counter2=4
2026-02-28 10:02:54,219 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.6161, dev_err=32.59%, es_counter1=5, es_counter2=5
2026-02-28 10:02:55,290 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.6350, dev_err=31.25%, es_counter1=6, es_counter2=6
2026-02-28 10:02:56,365 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.6350, dev_err=31.25%, es_counter1=7, es_counter2=7
2026-02-28 10:02:57,438 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.6306, dev_err=31.70%, es_counter1=8, es_counter2=8
2026-02-28 10:02:58,515 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.6081, dev_err=33.93%, es_counter1=9, es_counter2=9
2026-02-28 10:02:58,515 - lg_cotrain - INFO - Early stopping at epoch 11
2026-02-28 10:02:58,526 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-28 10:03:00,856 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpe2d0lcsq\kaikoura_earthquake_2016\5_set3\metrics.json
2026-02-28 10:03:00,856 - lg_cotrain - INFO - Test error rate: 26.21%, Test macro-F1: 0.6788, Test ECE: 0.2056
2026-02-28 10:03:00,864 - lg_cotrain - INFO - --- Trial 7/10 done: dev_macro_f1=0.6362 ---
2026-02-28 10:03:00,864 - lg_cotrain - INFO - --- Trial 8/10 ---
2026-02-28 10:03:01,368 - lg_cotrain - INFO - Starting LG-CoTrain: event=kaikoura_earthquake_2016, budget=5, seed_set=3
2026-02-28 10:03:01,382 - lg_cotrain - INFO - Detected 9 classes for event kaikoura_earthquake_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-28 10:03:01,387 - lg_cotrain - INFO - D_l1: 27, D_l2: 18, D_LG: 1491
2026-02-28 10:03:01,388 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-28 10:03:08,741 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1149, mean_prob2=0.1080
2026-02-28 10:03:15,168 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1081, mean_prob2=0.1164
2026-02-28 10:03:21,627 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1032, mean_prob2=0.1117
2026-02-28 10:03:28,080 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1027, mean_prob2=0.1099
2026-02-28 10:03:34,539 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1089, mean_prob2=0.1150
2026-02-28 10:03:40,901 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1184, mean_prob2=0.1204
2026-02-28 10:03:47,265 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1126, mean_prob2=0.1218
2026-02-28 10:03:47,265 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-28 10:03:48,244 - lg_cotrain - INFO - LR scheduler: total_steps_1=3392, warmup=59; total_steps_2=3292, warmup=57
2026-02-28 10:03:48,245 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1126, range=[0.0890, 0.1419]
2026-02-28 10:03:48,245 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1218, range=[0.0747, 0.1807]
2026-02-28 10:04:15,754 - lg_cotrain - INFO - Phase 2 epoch 1/16: loss1=0.2406, loss2=0.2129, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 10:04:43,317 - lg_cotrain - INFO - Phase 2 epoch 2/16: loss1=0.1836, loss2=0.3147, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 10:05:10,953 - lg_cotrain - INFO - Phase 2 epoch 3/16: loss1=0.1483, loss2=0.3360, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 10:05:38,642 - lg_cotrain - INFO - Phase 2 epoch 4/16: loss1=0.1521, loss2=0.3398, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 10:06:06,326 - lg_cotrain - INFO - Phase 2 epoch 5/16: loss1=0.1535, loss2=0.3501, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 10:06:34,036 - lg_cotrain - INFO - Phase 2 epoch 6/16: loss1=0.1507, loss2=0.3523, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 10:07:01,799 - lg_cotrain - INFO - Phase 2 epoch 7/16: loss1=0.1527, loss2=0.3489, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 10:07:29,552 - lg_cotrain - INFO - Phase 2 epoch 8/16: loss1=0.1498, loss2=0.3443, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 10:07:57,262 - lg_cotrain - INFO - Phase 2 epoch 9/16: loss1=0.1494, loss2=0.3433, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 10:08:24,985 - lg_cotrain - INFO - Phase 2 epoch 10/16: loss1=0.1511, loss2=0.3401, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 10:08:52,722 - lg_cotrain - INFO - Phase 2 epoch 11/16: loss1=0.1496, loss2=0.3359, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 10:09:20,443 - lg_cotrain - INFO - Phase 2 epoch 12/16: loss1=0.1497, loss2=0.3333, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 10:09:48,228 - lg_cotrain - INFO - Phase 2 epoch 13/16: loss1=0.1505, loss2=0.3315, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 10:10:16,013 - lg_cotrain - INFO - Phase 2 epoch 14/16: loss1=0.1503, loss2=0.3287, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 10:10:43,796 - lg_cotrain - INFO - Phase 2 epoch 15/16: loss1=0.1504, loss2=0.3271, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 10:11:11,521 - lg_cotrain - INFO - Phase 2 epoch 16/16: loss1=0.1517, loss2=0.3239, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 10:11:11,522 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-28 10:11:12,764 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.0406, dev_err=77.68%, es_counter1=0, es_counter2=0
2026-02-28 10:11:13,974 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.0406, dev_err=77.68%, es_counter1=1, es_counter2=1
2026-02-28 10:11:15,203 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.0406, dev_err=77.68%, es_counter1=2, es_counter2=2
2026-02-28 10:11:16,420 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.0406, dev_err=77.68%, es_counter1=3, es_counter2=3
2026-02-28 10:11:17,642 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.0406, dev_err=77.68%, es_counter1=4, es_counter2=4
2026-02-28 10:11:18,853 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.0020, dev_err=99.11%, es_counter1=5, es_counter2=5
2026-02-28 10:11:20,070 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.0020, dev_err=99.11%, es_counter1=6, es_counter2=6
2026-02-28 10:11:20,070 - lg_cotrain - INFO - Early stopping at epoch 7
2026-02-28 10:11:20,081 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-28 10:11:22,629 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpwmjko5pk\kaikoura_earthquake_2016\5_set3\metrics.json
2026-02-28 10:11:22,630 - lg_cotrain - INFO - Test error rate: 77.47%, Test macro-F1: 0.0409, Test ECE: 0.3123
2026-02-28 10:11:22,638 - lg_cotrain - INFO - --- Trial 8/10 done: dev_macro_f1=0.0406 ---
2026-02-28 10:11:22,638 - lg_cotrain - INFO - --- Trial 9/10 ---
2026-02-28 10:11:23,136 - lg_cotrain - INFO - Starting LG-CoTrain: event=kaikoura_earthquake_2016, budget=5, seed_set=3
2026-02-28 10:11:23,147 - lg_cotrain - INFO - Detected 9 classes for event kaikoura_earthquake_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-28 10:11:23,152 - lg_cotrain - INFO - D_l1: 27, D_l2: 18, D_LG: 1491
2026-02-28 10:11:23,152 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-28 10:11:29,625 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1312, mean_prob2=0.1075
2026-02-28 10:11:35,141 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1038, mean_prob2=0.1108
2026-02-28 10:11:40,674 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1303, mean_prob2=0.1307
2026-02-28 10:11:46,235 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1167, mean_prob2=0.1153
2026-02-28 10:11:51,779 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1134, mean_prob2=0.1317
2026-02-28 10:11:57,360 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1685, mean_prob2=0.1405
2026-02-28 10:12:02,928 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1874, mean_prob2=0.1517
2026-02-28 10:12:02,930 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-28 10:12:04,031 - lg_cotrain - INFO - LR scheduler: total_steps_1=617, warmup=94; total_steps_2=617, warmup=94
2026-02-28 10:12:04,031 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1874, range=[0.0170, 0.6747]
2026-02-28 10:12:04,032 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1517, range=[0.0179, 0.6270]
2026-02-28 10:12:25,348 - lg_cotrain - INFO - Phase 2 epoch 1/11: loss1=0.2829, loss2=0.2949, dev_macro_f1=0.4429, dev_err=38.84%
2026-02-28 10:12:46,742 - lg_cotrain - INFO - Phase 2 epoch 2/11: loss1=0.0927, loss2=0.2841, dev_macro_f1=0.5705, dev_err=33.04%
2026-02-28 10:13:08,092 - lg_cotrain - INFO - Phase 2 epoch 3/11: loss1=0.0996, loss2=0.3529, dev_macro_f1=0.4568, dev_err=38.39%
2026-02-28 10:13:29,409 - lg_cotrain - INFO - Phase 2 epoch 4/11: loss1=0.1363, loss2=1.1930, dev_macro_f1=0.4616, dev_err=35.71%
2026-02-28 10:13:50,703 - lg_cotrain - INFO - Phase 2 epoch 5/11: loss1=0.0446, loss2=1.4025, dev_macro_f1=0.4652, dev_err=35.71%
2026-02-28 10:14:11,942 - lg_cotrain - INFO - Phase 2 epoch 6/11: loss1=0.0479, loss2=1.4744, dev_macro_f1=0.3087, dev_err=48.21%
2026-02-28 10:14:33,228 - lg_cotrain - INFO - Phase 2 epoch 7/11: loss1=0.0391, loss2=1.4555, dev_macro_f1=0.3969, dev_err=41.96%
2026-02-28 10:14:54,427 - lg_cotrain - INFO - Phase 2 epoch 8/11: loss1=0.0301, loss2=1.4764, dev_macro_f1=0.3756, dev_err=43.30%
2026-02-28 10:15:15,653 - lg_cotrain - INFO - Phase 2 epoch 9/11: loss1=0.0186, loss2=1.4528, dev_macro_f1=0.2738, dev_err=47.32%
2026-02-28 10:15:36,808 - lg_cotrain - INFO - Phase 2 epoch 10/11: loss1=0.0159, loss2=1.4268, dev_macro_f1=0.2932, dev_err=47.32%
2026-02-28 10:15:58,043 - lg_cotrain - INFO - Phase 2 epoch 11/11: loss1=0.0139, loss2=1.4387, dev_macro_f1=0.3243, dev_err=44.64%
2026-02-28 10:15:58,044 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-28 10:15:59,054 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.3638, dev_err=43.30%, es_counter1=0, es_counter2=0
2026-02-28 10:16:00,051 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.3902, dev_err=41.52%, es_counter1=0, es_counter2=0
2026-02-28 10:16:01,064 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.4271, dev_err=41.07%, es_counter1=0, es_counter2=0
2026-02-28 10:16:02,076 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.4650, dev_err=40.62%, es_counter1=0, es_counter2=0
2026-02-28 10:16:03,061 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.4577, dev_err=41.52%, es_counter1=1, es_counter2=1
2026-02-28 10:16:04,051 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.4363, dev_err=44.64%, es_counter1=2, es_counter2=2
2026-02-28 10:16:05,044 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.3603, dev_err=54.46%, es_counter1=3, es_counter2=3
2026-02-28 10:16:06,037 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.4337, dev_err=45.54%, es_counter1=4, es_counter2=4
2026-02-28 10:16:07,050 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.4871, dev_err=42.41%, es_counter1=0, es_counter2=0
2026-02-28 10:16:08,044 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.4245, dev_err=46.43%, es_counter1=1, es_counter2=1
2026-02-28 10:16:09,039 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.4164, dev_err=49.11%, es_counter1=2, es_counter2=2
2026-02-28 10:16:10,035 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.4170, dev_err=48.66%, es_counter1=3, es_counter2=3
2026-02-28 10:16:11,028 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.4275, dev_err=47.77%, es_counter1=4, es_counter2=4
2026-02-28 10:16:12,023 - lg_cotrain - INFO - Phase 3 epoch 14: dev_macro_f1=0.4292, dev_err=48.21%, es_counter1=5, es_counter2=5
2026-02-28 10:16:13,022 - lg_cotrain - INFO - Phase 3 epoch 15: dev_macro_f1=0.4163, dev_err=49.11%, es_counter1=6, es_counter2=6
2026-02-28 10:16:14,032 - lg_cotrain - INFO - Phase 3 epoch 16: dev_macro_f1=0.5289, dev_err=38.39%, es_counter1=0, es_counter2=0
2026-02-28 10:16:15,021 - lg_cotrain - INFO - Phase 3 epoch 17: dev_macro_f1=0.5276, dev_err=37.50%, es_counter1=1, es_counter2=1
2026-02-28 10:16:16,026 - lg_cotrain - INFO - Phase 3 epoch 18: dev_macro_f1=0.5276, dev_err=37.05%, es_counter1=2, es_counter2=2
2026-02-28 10:16:17,041 - lg_cotrain - INFO - Phase 3 epoch 19: dev_macro_f1=0.5413, dev_err=35.71%, es_counter1=0, es_counter2=0
2026-02-28 10:16:18,029 - lg_cotrain - INFO - Phase 3 epoch 20: dev_macro_f1=0.5404, dev_err=36.16%, es_counter1=1, es_counter2=1
2026-02-28 10:16:19,023 - lg_cotrain - INFO - Phase 3 epoch 21: dev_macro_f1=0.5300, dev_err=37.95%, es_counter1=2, es_counter2=2
2026-02-28 10:16:20,011 - lg_cotrain - INFO - Phase 3 epoch 22: dev_macro_f1=0.5264, dev_err=38.39%, es_counter1=3, es_counter2=3
2026-02-28 10:16:21,005 - lg_cotrain - INFO - Phase 3 epoch 23: dev_macro_f1=0.5130, dev_err=39.29%, es_counter1=4, es_counter2=4
2026-02-28 10:16:21,998 - lg_cotrain - INFO - Phase 3 epoch 24: dev_macro_f1=0.4986, dev_err=41.96%, es_counter1=5, es_counter2=5
2026-02-28 10:16:22,991 - lg_cotrain - INFO - Phase 3 epoch 25: dev_macro_f1=0.5109, dev_err=41.96%, es_counter1=6, es_counter2=6
2026-02-28 10:16:23,986 - lg_cotrain - INFO - Phase 3 epoch 26: dev_macro_f1=0.4984, dev_err=41.96%, es_counter1=7, es_counter2=7
2026-02-28 10:16:23,986 - lg_cotrain - INFO - Early stopping at epoch 26
2026-02-28 10:16:24,000 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-28 10:16:26,249 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpy95yn706\kaikoura_earthquake_2016\5_set3\metrics.json
2026-02-28 10:16:26,250 - lg_cotrain - INFO - Test error rate: 37.24%, Test macro-F1: 0.5116, Test ECE: 0.2138
2026-02-28 10:16:26,261 - lg_cotrain - INFO - --- Trial 9/10 done: dev_macro_f1=0.5413 ---
2026-02-28 10:16:26,261 - lg_cotrain - INFO - --- Trial 10/10 ---
2026-02-28 10:16:26,795 - lg_cotrain - INFO - Starting LG-CoTrain: event=kaikoura_earthquake_2016, budget=5, seed_set=3
2026-02-28 10:16:26,812 - lg_cotrain - INFO - Detected 9 classes for event kaikoura_earthquake_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-28 10:16:26,818 - lg_cotrain - INFO - D_l1: 27, D_l2: 18, D_LG: 1491
2026-02-28 10:16:26,819 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-28 10:16:33,687 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1108, mean_prob2=0.1126
2026-02-28 10:16:39,659 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1158, mean_prob2=0.1124
2026-02-28 10:16:45,679 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1182, mean_prob2=0.1109
2026-02-28 10:16:51,659 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1170, mean_prob2=0.1114
2026-02-28 10:16:57,962 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1105, mean_prob2=0.1153
2026-02-28 10:17:04,667 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1135, mean_prob2=0.1220
2026-02-28 10:17:10,715 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1258, mean_prob2=0.1274
2026-02-28 10:17:10,715 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-28 10:17:11,813 - lg_cotrain - INFO - LR scheduler: total_steps_1=1516, warmup=286; total_steps_2=1516, warmup=286
2026-02-28 10:17:11,814 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1258, range=[0.0458, 0.2875]
2026-02-28 10:17:11,814 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1274, range=[0.0328, 0.3661]
2026-02-28 10:17:35,336 - lg_cotrain - INFO - Phase 2 epoch 1/14: loss1=0.2769, loss2=0.2508, dev_macro_f1=0.1716, dev_err=60.71%
2026-02-28 10:17:59,261 - lg_cotrain - INFO - Phase 2 epoch 2/14: loss1=0.1622, loss2=0.2197, dev_macro_f1=0.4882, dev_err=34.82%
2026-02-28 10:18:22,943 - lg_cotrain - INFO - Phase 2 epoch 3/14: loss1=0.0708, loss2=0.1705, dev_macro_f1=0.6158, dev_err=29.91%
2026-02-28 10:18:46,692 - lg_cotrain - INFO - Phase 2 epoch 4/14: loss1=0.0344, loss2=0.1519, dev_macro_f1=0.6199, dev_err=30.80%
2026-02-28 10:19:10,456 - lg_cotrain - INFO - Phase 2 epoch 5/14: loss1=0.0177, loss2=0.0959, dev_macro_f1=0.5650, dev_err=35.27%
2026-02-28 10:19:34,229 - lg_cotrain - INFO - Phase 2 epoch 6/14: loss1=0.0123, loss2=0.0440, dev_macro_f1=0.6048, dev_err=32.59%
2026-02-28 10:19:58,004 - lg_cotrain - INFO - Phase 2 epoch 7/14: loss1=0.0223, loss2=0.0259, dev_macro_f1=0.6205, dev_err=30.36%
2026-02-28 10:20:22,022 - lg_cotrain - INFO - Phase 2 epoch 8/14: loss1=0.0164, loss2=0.0139, dev_macro_f1=0.6132, dev_err=31.25%
2026-02-28 10:20:45,849 - lg_cotrain - INFO - Phase 2 epoch 9/14: loss1=0.0091, loss2=0.0122, dev_macro_f1=0.5968, dev_err=33.04%
2026-02-28 10:21:09,579 - lg_cotrain - INFO - Phase 2 epoch 10/14: loss1=0.0150, loss2=0.0113, dev_macro_f1=0.6004, dev_err=33.04%
2026-02-28 10:21:33,211 - lg_cotrain - INFO - Phase 2 epoch 11/14: loss1=0.0115, loss2=0.0073, dev_macro_f1=0.6065, dev_err=32.14%
2026-02-28 10:21:57,240 - lg_cotrain - INFO - Phase 2 epoch 12/14: loss1=0.0075, loss2=0.0060, dev_macro_f1=0.6045, dev_err=32.14%
2026-02-28 10:22:21,458 - lg_cotrain - INFO - Phase 2 epoch 13/14: loss1=0.0063, loss2=0.0059, dev_macro_f1=0.6245, dev_err=31.25%
2026-02-28 10:22:45,596 - lg_cotrain - INFO - Phase 2 epoch 14/14: loss1=0.0045, loss2=0.0049, dev_macro_f1=0.6257, dev_err=30.80%
2026-02-28 10:22:45,597 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-28 10:22:46,711 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.6022, dev_err=32.59%, es_counter1=0, es_counter2=0
2026-02-28 10:22:47,845 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.6068, dev_err=32.14%, es_counter1=0, es_counter2=0
2026-02-28 10:22:48,955 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.6042, dev_err=32.14%, es_counter1=1, es_counter2=1
2026-02-28 10:22:50,081 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.6070, dev_err=31.70%, es_counter1=0, es_counter2=0
2026-02-28 10:22:51,220 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.6062, dev_err=31.70%, es_counter1=1, es_counter2=1
2026-02-28 10:22:52,337 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.6062, dev_err=31.70%, es_counter1=2, es_counter2=2
2026-02-28 10:22:53,453 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.5958, dev_err=32.59%, es_counter1=3, es_counter2=3
2026-02-28 10:22:54,572 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.5897, dev_err=33.48%, es_counter1=4, es_counter2=4
2026-02-28 10:22:55,679 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.5902, dev_err=33.48%, es_counter1=5, es_counter2=5
2026-02-28 10:22:55,679 - lg_cotrain - INFO - Early stopping at epoch 9
2026-02-28 10:22:55,689 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-28 10:22:58,074 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmp_4pcx872\kaikoura_earthquake_2016\5_set3\metrics.json
2026-02-28 10:22:58,074 - lg_cotrain - INFO - Test error rate: 24.60%, Test macro-F1: 0.6836, Test ECE: 0.1870
2026-02-28 10:22:58,082 - lg_cotrain - INFO - --- Trial 10/10 done: dev_macro_f1=0.6070 ---
