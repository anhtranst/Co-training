2026-02-28 13:13:41,863 - lg_cotrain - INFO - === Optuna study: kaikoura_earthquake_2016 budget=50 seed=2 | target=10 trials, 0 replayed, 10 new ===
2026-02-28 13:13:41,863 - lg_cotrain - INFO - --- Trial 1/10 ---
2026-02-28 13:13:42,366 - lg_cotrain - INFO - Starting LG-CoTrain: event=kaikoura_earthquake_2016, budget=50, seed_set=2
2026-02-28 13:13:42,397 - lg_cotrain - INFO - Detected 9 classes for event kaikoura_earthquake_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-28 13:13:42,401 - lg_cotrain - INFO - D_l1: 209, D_l2: 208, D_LG: 1119
2026-02-28 13:13:42,403 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-28 13:13:51,127 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1173, mean_prob2=0.1165
2026-02-28 13:13:58,744 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1247, mean_prob2=0.1553
2026-02-28 13:14:06,536 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1165, mean_prob2=0.1885
2026-02-28 13:14:14,165 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1187, mean_prob2=0.2327
2026-02-28 13:14:21,756 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1235, mean_prob2=0.2747
2026-02-28 13:14:29,454 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1256, mean_prob2=0.2855
2026-02-28 13:14:37,153 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1442, mean_prob2=0.1488
2026-02-28 13:14:37,153 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-28 13:14:38,199 - lg_cotrain - INFO - LR scheduler: total_steps_1=4240, warmup=482; total_steps_2=4140, warmup=470
2026-02-28 13:14:38,200 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1442, range=[0.0165, 0.7515]
2026-02-28 13:14:38,200 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1488, range=[0.0064, 0.9152]
2026-02-28 13:14:59,521 - lg_cotrain - INFO - Phase 2 epoch 1/11: loss1=0.2708, loss2=0.2773, dev_macro_f1=0.3295, dev_err=44.64%
2026-02-28 13:15:21,067 - lg_cotrain - INFO - Phase 2 epoch 2/11: loss1=0.0940, loss2=0.2473, dev_macro_f1=0.4859, dev_err=36.16%
2026-02-28 13:15:42,630 - lg_cotrain - INFO - Phase 2 epoch 3/11: loss1=0.0476, loss2=0.3640, dev_macro_f1=0.5215, dev_err=34.38%
2026-02-28 13:16:04,095 - lg_cotrain - INFO - Phase 2 epoch 4/11: loss1=0.0804, loss2=0.4725, dev_macro_f1=0.3706, dev_err=43.75%
2026-02-28 13:16:25,467 - lg_cotrain - INFO - Phase 2 epoch 5/11: loss1=0.0658, loss2=0.3050, dev_macro_f1=0.4664, dev_err=37.05%
2026-02-28 13:16:47,222 - lg_cotrain - INFO - Phase 2 epoch 6/11: loss1=0.0588, loss2=0.3270, dev_macro_f1=0.5049, dev_err=35.27%
2026-02-28 13:17:08,795 - lg_cotrain - INFO - Phase 2 epoch 7/11: loss1=0.3827, loss2=0.1789, dev_macro_f1=0.5029, dev_err=35.71%
2026-02-28 13:17:30,120 - lg_cotrain - INFO - Phase 2 epoch 8/11: loss1=0.5728, loss2=0.1052, dev_macro_f1=0.5219, dev_err=33.48%
2026-02-28 13:17:51,483 - lg_cotrain - INFO - Phase 2 epoch 9/11: loss1=0.6357, loss2=0.0742, dev_macro_f1=0.5252, dev_err=35.27%
2026-02-28 13:18:13,061 - lg_cotrain - INFO - Phase 2 epoch 10/11: loss1=0.6910, loss2=0.1020, dev_macro_f1=0.5226, dev_err=33.48%
2026-02-28 13:18:34,595 - lg_cotrain - INFO - Phase 2 epoch 11/11: loss1=0.7312, loss2=0.0854, dev_macro_f1=0.4971, dev_err=36.16%
2026-02-28 13:18:34,595 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-28 13:18:38,639 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.5065, dev_err=37.05%, es_counter1=0, es_counter2=0
2026-02-28 13:18:42,531 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.4835, dev_err=46.88%, es_counter1=1, es_counter2=1
2026-02-28 13:18:46,464 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.5963, dev_err=30.80%, es_counter1=0, es_counter2=0
2026-02-28 13:18:50,401 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.6205, dev_err=33.48%, es_counter1=0, es_counter2=0
2026-02-28 13:18:54,307 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.6139, dev_err=33.04%, es_counter1=1, es_counter2=1
2026-02-28 13:18:58,237 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.6615, dev_err=30.36%, es_counter1=0, es_counter2=0
2026-02-28 13:19:02,120 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.6130, dev_err=33.04%, es_counter1=1, es_counter2=1
2026-02-28 13:19:06,036 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.6229, dev_err=33.04%, es_counter1=2, es_counter2=2
2026-02-28 13:19:09,926 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.6379, dev_err=32.59%, es_counter1=3, es_counter2=3
2026-02-28 13:19:13,802 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.6392, dev_err=32.14%, es_counter1=4, es_counter2=4
2026-02-28 13:19:17,717 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.6735, dev_err=30.36%, es_counter1=0, es_counter2=0
2026-02-28 13:19:21,610 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.6695, dev_err=30.36%, es_counter1=1, es_counter2=1
2026-02-28 13:19:25,499 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.6699, dev_err=30.36%, es_counter1=2, es_counter2=2
2026-02-28 13:19:29,380 - lg_cotrain - INFO - Phase 3 epoch 14: dev_macro_f1=0.6605, dev_err=30.80%, es_counter1=3, es_counter2=3
2026-02-28 13:19:33,288 - lg_cotrain - INFO - Phase 3 epoch 15: dev_macro_f1=0.6497, dev_err=31.70%, es_counter1=4, es_counter2=4
2026-02-28 13:19:37,198 - lg_cotrain - INFO - Phase 3 epoch 16: dev_macro_f1=0.6554, dev_err=31.25%, es_counter1=5, es_counter2=5
2026-02-28 13:19:41,096 - lg_cotrain - INFO - Phase 3 epoch 17: dev_macro_f1=0.6554, dev_err=31.25%, es_counter1=6, es_counter2=6
2026-02-28 13:19:45,008 - lg_cotrain - INFO - Phase 3 epoch 18: dev_macro_f1=0.6554, dev_err=31.25%, es_counter1=7, es_counter2=7
2026-02-28 13:19:48,894 - lg_cotrain - INFO - Phase 3 epoch 19: dev_macro_f1=0.6554, dev_err=31.25%, es_counter1=8, es_counter2=8
2026-02-28 13:19:52,859 - lg_cotrain - INFO - Phase 3 epoch 20: dev_macro_f1=0.6554, dev_err=31.25%, es_counter1=9, es_counter2=9
2026-02-28 13:19:52,859 - lg_cotrain - INFO - Early stopping at epoch 20
2026-02-28 13:19:52,868 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-28 13:19:55,492 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpq86f2acd\kaikoura_earthquake_2016\50_set2\metrics.json
2026-02-28 13:19:55,492 - lg_cotrain - INFO - Test error rate: 26.90%, Test macro-F1: 0.7097, Test ECE: 0.2108
2026-02-28 13:19:55,504 - lg_cotrain - INFO - --- Trial 1/10 done: dev_macro_f1=0.6735 ---
2026-02-28 13:19:55,504 - lg_cotrain - INFO - --- Trial 2/10 ---
2026-02-28 13:19:56,011 - lg_cotrain - INFO - Starting LG-CoTrain: event=kaikoura_earthquake_2016, budget=50, seed_set=2
2026-02-28 13:19:56,023 - lg_cotrain - INFO - Detected 9 classes for event kaikoura_earthquake_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-28 13:19:56,028 - lg_cotrain - INFO - D_l1: 209, D_l2: 208, D_LG: 1119
2026-02-28 13:19:56,030 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-28 13:20:03,127 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1203, mean_prob2=0.1525
2026-02-28 13:20:09,405 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1272, mean_prob2=0.1600
2026-02-28 13:20:15,552 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1319, mean_prob2=0.2623
2026-02-28 13:20:21,803 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1311, mean_prob2=0.3858
2026-02-28 13:20:27,992 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1271, mean_prob2=0.5571
2026-02-28 13:20:34,174 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1157, mean_prob2=0.5489
2026-02-28 13:20:40,436 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1122, mean_prob2=0.6292
2026-02-28 13:20:40,436 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-28 13:20:41,522 - lg_cotrain - INFO - LR scheduler: total_steps_1=1225, warmup=243; total_steps_2=1225, warmup=243
2026-02-28 13:20:41,522 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1122, range=[0.0394, 0.1368]
2026-02-28 13:20:41,523 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.6292, range=[0.0002, 0.9887]
2026-02-28 13:20:57,950 - lg_cotrain - INFO - Phase 2 epoch 1/15: loss1=1.1923, loss2=0.2261, dev_macro_f1=0.1957, dev_err=53.12%
2026-02-28 13:21:14,512 - lg_cotrain - INFO - Phase 2 epoch 2/15: loss1=0.1527, loss2=0.2504, dev_macro_f1=0.3502, dev_err=42.41%
2026-02-28 13:21:31,112 - lg_cotrain - INFO - Phase 2 epoch 3/15: loss1=0.0607, loss2=0.1751, dev_macro_f1=0.4090, dev_err=37.95%
2026-02-28 13:21:47,538 - lg_cotrain - INFO - Phase 2 epoch 4/15: loss1=0.0346, loss2=0.1616, dev_macro_f1=0.3960, dev_err=39.29%
2026-02-28 13:22:04,005 - lg_cotrain - INFO - Phase 2 epoch 5/15: loss1=0.0473, loss2=0.2246, dev_macro_f1=0.5272, dev_err=31.70%
2026-02-28 13:22:20,512 - lg_cotrain - INFO - Phase 2 epoch 6/15: loss1=0.0899, loss2=0.3671, dev_macro_f1=0.5020, dev_err=35.71%
2026-02-28 13:22:37,187 - lg_cotrain - INFO - Phase 2 epoch 7/15: loss1=0.1546, loss2=0.4823, dev_macro_f1=0.3836, dev_err=40.62%
2026-02-28 13:22:53,659 - lg_cotrain - INFO - Phase 2 epoch 8/15: loss1=0.1121, loss2=0.9803, dev_macro_f1=0.4109, dev_err=38.39%
2026-02-28 13:23:10,159 - lg_cotrain - INFO - Phase 2 epoch 9/15: loss1=0.0617, loss2=1.3800, dev_macro_f1=0.3587, dev_err=43.30%
2026-02-28 13:23:26,602 - lg_cotrain - INFO - Phase 2 epoch 10/15: loss1=0.0563, loss2=1.3545, dev_macro_f1=0.3698, dev_err=40.62%
2026-02-28 13:23:43,083 - lg_cotrain - INFO - Phase 2 epoch 11/15: loss1=0.0317, loss2=1.3545, dev_macro_f1=0.3981, dev_err=39.29%
2026-02-28 13:23:59,411 - lg_cotrain - INFO - Phase 2 epoch 12/15: loss1=0.0333, loss2=1.3714, dev_macro_f1=0.3887, dev_err=38.84%
2026-02-28 13:24:15,762 - lg_cotrain - INFO - Phase 2 epoch 13/15: loss1=0.0127, loss2=1.4826, dev_macro_f1=0.3990, dev_err=39.73%
2026-02-28 13:24:32,260 - lg_cotrain - INFO - Phase 2 epoch 14/15: loss1=0.0081, loss2=1.4953, dev_macro_f1=0.4037, dev_err=39.29%
2026-02-28 13:24:48,652 - lg_cotrain - INFO - Phase 2 epoch 15/15: loss1=0.0056, loss2=1.4792, dev_macro_f1=0.3987, dev_err=39.73%
2026-02-28 13:24:48,652 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-28 13:24:51,603 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.3610, dev_err=44.20%, es_counter1=0, es_counter2=0
2026-02-28 13:24:54,519 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.1464, dev_err=79.46%, es_counter1=1, es_counter2=1
2026-02-28 13:24:57,431 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.1786, dev_err=66.07%, es_counter1=2, es_counter2=2
2026-02-28 13:25:00,351 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.1619, dev_err=72.32%, es_counter1=3, es_counter2=3
2026-02-28 13:25:03,267 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.1343, dev_err=79.91%, es_counter1=4, es_counter2=4
2026-02-28 13:25:06,188 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.1183, dev_err=83.48%, es_counter1=5, es_counter2=5
2026-02-28 13:25:09,089 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.1770, dev_err=69.64%, es_counter1=6, es_counter2=6
2026-02-28 13:25:12,019 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.1790, dev_err=69.64%, es_counter1=7, es_counter2=7
2026-02-28 13:25:14,937 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.1649, dev_err=74.11%, es_counter1=8, es_counter2=8
2026-02-28 13:25:14,937 - lg_cotrain - INFO - Early stopping at epoch 9
2026-02-28 13:25:14,948 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-28 13:25:17,216 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpgdna19hv\kaikoura_earthquake_2016\50_set2\metrics.json
2026-02-28 13:25:17,216 - lg_cotrain - INFO - Test error rate: 46.21%, Test macro-F1: 0.3671, Test ECE: 0.2415
2026-02-28 13:25:17,228 - lg_cotrain - INFO - --- Trial 2/10 done: dev_macro_f1=0.3610 ---
2026-02-28 13:25:17,229 - lg_cotrain - INFO - --- Trial 3/10 ---
2026-02-28 13:25:17,743 - lg_cotrain - INFO - Starting LG-CoTrain: event=kaikoura_earthquake_2016, budget=50, seed_set=2
2026-02-28 13:25:17,758 - lg_cotrain - INFO - Detected 9 classes for event kaikoura_earthquake_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-28 13:25:17,765 - lg_cotrain - INFO - D_l1: 209, D_l2: 208, D_LG: 1119
2026-02-28 13:25:17,766 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-28 13:25:26,490 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1202, mean_prob2=0.1215
2026-02-28 13:25:34,171 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1198, mean_prob2=0.1152
2026-02-28 13:25:41,823 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1209, mean_prob2=0.1173
2026-02-28 13:25:49,484 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1206, mean_prob2=0.1214
2026-02-28 13:25:57,138 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1097, mean_prob2=0.1134
2026-02-28 13:26:04,834 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1052, mean_prob2=0.1210
2026-02-28 13:26:12,487 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1257, mean_prob2=0.1218
2026-02-28 13:26:12,487 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-28 13:26:13,552 - lg_cotrain - INFO - LR scheduler: total_steps_1=4240, warmup=149; total_steps_2=4140, warmup=146
2026-02-28 13:26:13,553 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1257, range=[0.0433, 0.1454]
2026-02-28 13:26:13,553 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1218, range=[0.0361, 0.1365]
2026-02-28 13:26:35,113 - lg_cotrain - INFO - Phase 2 epoch 1/11: loss1=0.1744, loss2=0.1837, dev_macro_f1=0.3724, dev_err=41.52%
2026-02-28 13:26:56,464 - lg_cotrain - INFO - Phase 2 epoch 2/11: loss1=0.0925, loss2=0.9895, dev_macro_f1=0.4593, dev_err=40.62%
2026-02-28 13:27:17,878 - lg_cotrain - INFO - Phase 2 epoch 3/11: loss1=0.0451, loss2=1.2560, dev_macro_f1=0.3963, dev_err=41.96%
2026-02-28 13:27:39,268 - lg_cotrain - INFO - Phase 2 epoch 4/11: loss1=0.0314, loss2=1.3516, dev_macro_f1=0.4156, dev_err=43.30%
2026-02-28 13:28:00,836 - lg_cotrain - INFO - Phase 2 epoch 5/11: loss1=0.0273, loss2=1.4424, dev_macro_f1=0.3715, dev_err=43.30%
2026-02-28 13:28:22,382 - lg_cotrain - INFO - Phase 2 epoch 6/11: loss1=0.0283, loss2=1.4684, dev_macro_f1=0.3792, dev_err=45.09%
2026-02-28 13:28:43,827 - lg_cotrain - INFO - Phase 2 epoch 7/11: loss1=0.0277, loss2=1.5084, dev_macro_f1=0.2851, dev_err=53.12%
2026-02-28 13:29:05,316 - lg_cotrain - INFO - Phase 2 epoch 8/11: loss1=0.0466, loss2=1.5180, dev_macro_f1=0.2900, dev_err=46.88%
2026-02-28 13:29:26,961 - lg_cotrain - INFO - Phase 2 epoch 9/11: loss1=0.0854, loss2=1.5350, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 13:29:48,419 - lg_cotrain - INFO - Phase 2 epoch 10/11: loss1=0.1195, loss2=1.4879, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 13:30:10,385 - lg_cotrain - INFO - Phase 2 epoch 11/11: loss1=0.1213, loss2=1.4379, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 13:30:10,385 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-28 13:30:14,526 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.0190, dev_err=90.62%, es_counter1=0, es_counter2=0
2026-02-28 13:30:18,462 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.0086, dev_err=95.98%, es_counter1=1, es_counter2=1
2026-02-28 13:30:22,438 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.0365, dev_err=80.36%, es_counter1=0, es_counter2=0
2026-02-28 13:30:26,355 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.0086, dev_err=95.98%, es_counter1=1, es_counter2=1
2026-02-28 13:30:30,297 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.0086, dev_err=95.98%, es_counter1=2, es_counter2=2
2026-02-28 13:30:34,256 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.0406, dev_err=77.68%, es_counter1=0, es_counter2=0
2026-02-28 13:30:38,182 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.0104, dev_err=95.09%, es_counter1=1, es_counter2=1
2026-02-28 13:30:42,132 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.0086, dev_err=95.98%, es_counter1=2, es_counter2=2
2026-02-28 13:30:46,053 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.0207, dev_err=89.73%, es_counter1=3, es_counter2=3
2026-02-28 13:30:49,986 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.0190, dev_err=90.62%, es_counter1=4, es_counter2=4
2026-02-28 13:30:49,986 - lg_cotrain - INFO - Early stopping at epoch 10
2026-02-28 13:30:50,001 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-28 13:30:52,628 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmp6rdbkef4\kaikoura_earthquake_2016\50_set2\metrics.json
2026-02-28 13:30:52,628 - lg_cotrain - INFO - Test error rate: 77.47%, Test macro-F1: 0.0409, Test ECE: 0.0940
2026-02-28 13:30:52,641 - lg_cotrain - INFO - --- Trial 3/10 done: dev_macro_f1=0.0406 ---
2026-02-28 13:30:52,642 - lg_cotrain - INFO - --- Trial 4/10 ---
2026-02-28 13:30:53,189 - lg_cotrain - INFO - Starting LG-CoTrain: event=kaikoura_earthquake_2016, budget=50, seed_set=2
2026-02-28 13:30:53,200 - lg_cotrain - INFO - Detected 9 classes for event kaikoura_earthquake_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-28 13:30:53,204 - lg_cotrain - INFO - D_l1: 209, D_l2: 208, D_LG: 1119
2026-02-28 13:30:53,205 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-28 13:31:00,010 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1293, mean_prob2=0.1332
2026-02-28 13:31:05,799 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1545, mean_prob2=0.2199
2026-02-28 13:31:11,560 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.2167, mean_prob2=0.3210
2026-02-28 13:31:17,351 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.3554, mean_prob2=0.4346
2026-02-28 13:31:23,164 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.5013, mean_prob2=0.5227
2026-02-28 13:31:28,988 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.5039, mean_prob2=0.5759
2026-02-28 13:31:35,122 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.5521, mean_prob2=0.6415
2026-02-28 13:31:35,123 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-28 13:31:36,145 - lg_cotrain - INFO - LR scheduler: total_steps_1=724, warmup=109; total_steps_2=724, warmup=109
2026-02-28 13:31:36,145 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.5521, range=[0.0007, 0.9811]
2026-02-28 13:31:36,146 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.6415, range=[0.0007, 0.9906]
2026-02-28 13:31:51,249 - lg_cotrain - INFO - Phase 2 epoch 1/18: loss1=1.2664, loss2=1.1291, dev_macro_f1=0.1601, dev_err=59.38%
2026-02-28 13:32:06,325 - lg_cotrain - INFO - Phase 2 epoch 2/18: loss1=0.2063, loss2=0.8467, dev_macro_f1=0.2152, dev_err=50.45%
2026-02-28 13:32:21,432 - lg_cotrain - INFO - Phase 2 epoch 3/18: loss1=0.1044, loss2=0.3767, dev_macro_f1=0.3436, dev_err=41.07%
2026-02-28 13:32:36,572 - lg_cotrain - INFO - Phase 2 epoch 4/18: loss1=0.0586, loss2=0.2154, dev_macro_f1=0.4491, dev_err=37.05%
2026-02-28 13:32:52,007 - lg_cotrain - INFO - Phase 2 epoch 5/18: loss1=0.0383, loss2=0.1600, dev_macro_f1=0.4655, dev_err=37.05%
2026-02-28 13:33:07,591 - lg_cotrain - INFO - Phase 2 epoch 6/18: loss1=0.0291, loss2=0.1202, dev_macro_f1=0.5052, dev_err=34.38%
2026-02-28 13:33:23,048 - lg_cotrain - INFO - Phase 2 epoch 7/18: loss1=0.0503, loss2=0.1374, dev_macro_f1=0.4782, dev_err=37.05%
2026-02-28 13:33:38,153 - lg_cotrain - INFO - Phase 2 epoch 8/18: loss1=0.0692, loss2=0.1193, dev_macro_f1=0.4922, dev_err=35.27%
2026-02-28 13:33:53,205 - lg_cotrain - INFO - Phase 2 epoch 9/18: loss1=0.0851, loss2=0.1035, dev_macro_f1=0.4773, dev_err=36.61%
2026-02-28 13:34:08,538 - lg_cotrain - INFO - Phase 2 epoch 10/18: loss1=0.0654, loss2=0.1727, dev_macro_f1=0.5200, dev_err=36.61%
2026-02-28 13:34:23,679 - lg_cotrain - INFO - Phase 2 epoch 11/18: loss1=0.0367, loss2=0.0852, dev_macro_f1=0.5416, dev_err=34.38%
2026-02-28 13:34:38,837 - lg_cotrain - INFO - Phase 2 epoch 12/18: loss1=0.0455, loss2=0.0753, dev_macro_f1=0.5422, dev_err=34.82%
2026-02-28 13:34:54,388 - lg_cotrain - INFO - Phase 2 epoch 13/18: loss1=0.0728, loss2=0.0685, dev_macro_f1=0.5302, dev_err=36.16%
2026-02-28 13:35:09,621 - lg_cotrain - INFO - Phase 2 epoch 14/18: loss1=0.0843, loss2=0.0475, dev_macro_f1=0.4964, dev_err=36.61%
2026-02-28 13:35:24,718 - lg_cotrain - INFO - Phase 2 epoch 15/18: loss1=0.0679, loss2=0.0533, dev_macro_f1=0.6011, dev_err=31.70%
2026-02-28 13:35:39,734 - lg_cotrain - INFO - Phase 2 epoch 16/18: loss1=0.0793, loss2=0.0377, dev_macro_f1=0.5869, dev_err=33.93%
2026-02-28 13:35:54,850 - lg_cotrain - INFO - Phase 2 epoch 17/18: loss1=0.0625, loss2=0.0595, dev_macro_f1=0.5723, dev_err=34.82%
2026-02-28 13:36:09,822 - lg_cotrain - INFO - Phase 2 epoch 18/18: loss1=0.0413, loss2=0.0333, dev_macro_f1=0.5527, dev_err=35.71%
2026-02-28 13:36:09,824 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-28 13:36:12,553 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.5662, dev_err=36.16%, es_counter1=0, es_counter2=0
2026-02-28 13:36:15,250 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.5944, dev_err=32.14%, es_counter1=0, es_counter2=0
2026-02-28 13:36:17,947 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.5950, dev_err=31.70%, es_counter1=0, es_counter2=0
2026-02-28 13:36:20,632 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.6304, dev_err=29.46%, es_counter1=0, es_counter2=0
2026-02-28 13:36:23,326 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.6490, dev_err=28.12%, es_counter1=0, es_counter2=0
2026-02-28 13:36:26,002 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.6113, dev_err=32.14%, es_counter1=1, es_counter2=1
2026-02-28 13:36:28,772 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.6341, dev_err=30.36%, es_counter1=2, es_counter2=2
2026-02-28 13:36:31,781 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.6135, dev_err=32.59%, es_counter1=3, es_counter2=3
2026-02-28 13:36:34,563 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.6220, dev_err=30.80%, es_counter1=4, es_counter2=4
2026-02-28 13:36:34,564 - lg_cotrain - INFO - Early stopping at epoch 9
2026-02-28 13:36:34,574 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-28 13:36:36,765 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmp5kfc7upl\kaikoura_earthquake_2016\50_set2\metrics.json
2026-02-28 13:36:36,765 - lg_cotrain - INFO - Test error rate: 27.13%, Test macro-F1: 0.6521, Test ECE: 0.0971
2026-02-28 13:36:36,776 - lg_cotrain - INFO - --- Trial 4/10 done: dev_macro_f1=0.6490 ---
2026-02-28 13:36:36,777 - lg_cotrain - INFO - --- Trial 5/10 ---
2026-02-28 13:36:37,262 - lg_cotrain - INFO - Starting LG-CoTrain: event=kaikoura_earthquake_2016, budget=50, seed_set=2
2026-02-28 13:36:37,273 - lg_cotrain - INFO - Detected 9 classes for event kaikoura_earthquake_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-28 13:36:37,278 - lg_cotrain - INFO - D_l1: 209, D_l2: 208, D_LG: 1119
2026-02-28 13:36:37,279 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-28 13:36:43,994 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1216, mean_prob2=0.1237
2026-02-28 13:36:49,695 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1237, mean_prob2=0.1291
2026-02-28 13:36:55,505 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1283, mean_prob2=0.1366
2026-02-28 13:37:01,300 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1381, mean_prob2=0.1466
2026-02-28 13:37:07,438 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1442, mean_prob2=0.1523
2026-02-28 13:37:13,660 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1477, mean_prob2=0.1656
2026-02-28 13:37:19,786 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1519, mean_prob2=0.1737
2026-02-28 13:37:19,786 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-28 13:37:20,816 - lg_cotrain - INFO - LR scheduler: total_steps_1=508, warmup=9; total_steps_2=508, warmup=9
2026-02-28 13:37:20,817 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1519, range=[0.0418, 0.3191]
2026-02-28 13:37:20,817 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1737, range=[0.0354, 0.3682]
2026-02-28 13:37:35,921 - lg_cotrain - INFO - Phase 2 epoch 1/6: loss1=0.3441, loss2=0.3113, dev_macro_f1=0.1320, dev_err=62.05%
2026-02-28 13:37:50,949 - lg_cotrain - INFO - Phase 2 epoch 2/6: loss1=0.2030, loss2=0.3436, dev_macro_f1=0.1866, dev_err=54.91%
2026-02-28 13:38:05,967 - lg_cotrain - INFO - Phase 2 epoch 3/6: loss1=0.1390, loss2=0.3190, dev_macro_f1=0.2308, dev_err=48.21%
2026-02-28 13:38:20,994 - lg_cotrain - INFO - Phase 2 epoch 4/6: loss1=0.0987, loss2=0.2654, dev_macro_f1=0.2423, dev_err=47.77%
2026-02-28 13:38:36,246 - lg_cotrain - INFO - Phase 2 epoch 5/6: loss1=0.0697, loss2=0.2215, dev_macro_f1=0.2775, dev_err=47.32%
2026-02-28 13:38:51,351 - lg_cotrain - INFO - Phase 2 epoch 6/6: loss1=0.0507, loss2=0.1884, dev_macro_f1=0.3184, dev_err=44.64%
2026-02-28 13:38:51,352 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-28 13:38:54,045 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.3768, dev_err=46.43%, es_counter1=0, es_counter2=0
2026-02-28 13:38:56,735 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.4559, dev_err=36.16%, es_counter1=0, es_counter2=0
2026-02-28 13:38:59,479 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.5180, dev_err=33.04%, es_counter1=0, es_counter2=0
2026-02-28 13:39:02,249 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.5561, dev_err=30.80%, es_counter1=0, es_counter2=0
2026-02-28 13:39:04,952 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.5987, dev_err=30.36%, es_counter1=0, es_counter2=0
2026-02-28 13:39:07,666 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.6480, dev_err=26.79%, es_counter1=0, es_counter2=0
2026-02-28 13:39:10,344 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.6425, dev_err=26.34%, es_counter1=1, es_counter2=1
2026-02-28 13:39:13,091 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.6320, dev_err=28.57%, es_counter1=2, es_counter2=2
2026-02-28 13:39:15,853 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.6499, dev_err=27.23%, es_counter1=0, es_counter2=0
2026-02-28 13:39:18,523 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.6483, dev_err=27.23%, es_counter1=1, es_counter2=1
2026-02-28 13:39:21,212 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.6445, dev_err=27.68%, es_counter1=2, es_counter2=2
2026-02-28 13:39:23,885 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.6459, dev_err=27.68%, es_counter1=3, es_counter2=3
2026-02-28 13:39:26,596 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.6391, dev_err=28.12%, es_counter1=4, es_counter2=4
2026-02-28 13:39:29,293 - lg_cotrain - INFO - Phase 3 epoch 14: dev_macro_f1=0.6325, dev_err=28.12%, es_counter1=5, es_counter2=5
2026-02-28 13:39:29,293 - lg_cotrain - INFO - Early stopping at epoch 14
2026-02-28 13:39:29,307 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-28 13:39:31,505 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmps9mljbsx\kaikoura_earthquake_2016\50_set2\metrics.json
2026-02-28 13:39:31,505 - lg_cotrain - INFO - Test error rate: 26.21%, Test macro-F1: 0.6576, Test ECE: 0.0800
2026-02-28 13:39:31,516 - lg_cotrain - INFO - --- Trial 5/10 done: dev_macro_f1=0.6499 ---
2026-02-28 13:39:31,516 - lg_cotrain - INFO - --- Trial 6/10 ---
2026-02-28 13:39:32,025 - lg_cotrain - INFO - Starting LG-CoTrain: event=kaikoura_earthquake_2016, budget=50, seed_set=2
2026-02-28 13:39:32,039 - lg_cotrain - INFO - Detected 9 classes for event kaikoura_earthquake_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-28 13:39:32,043 - lg_cotrain - INFO - D_l1: 209, D_l2: 208, D_LG: 1119
2026-02-28 13:39:32,044 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-28 13:39:40,661 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1428, mean_prob2=0.1192
2026-02-28 13:39:48,326 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.2054, mean_prob2=0.1977
2026-02-28 13:39:55,946 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.3258, mean_prob2=0.4213
2026-02-28 13:40:03,582 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.4824, mean_prob2=0.5515
2026-02-28 13:40:11,198 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.5425, mean_prob2=0.6271
2026-02-28 13:40:18,877 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.5786, mean_prob2=0.6305
2026-02-28 13:40:26,564 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.5933, mean_prob2=0.6588
2026-02-28 13:40:26,565 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-28 13:40:27,565 - lg_cotrain - INFO - LR scheduler: total_steps_1=3960, warmup=187; total_steps_2=3860, warmup=182
2026-02-28 13:40:27,566 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.5933, range=[0.0008, 0.9755]
2026-02-28 13:40:27,566 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.6588, range=[0.0009, 0.9847]
2026-02-28 13:40:48,992 - lg_cotrain - INFO - Phase 2 epoch 1/9: loss1=1.0035, loss2=0.9786, dev_macro_f1=0.3639, dev_err=39.73%
2026-02-28 13:41:10,320 - lg_cotrain - INFO - Phase 2 epoch 2/9: loss1=0.0737, loss2=0.3789, dev_macro_f1=0.4774, dev_err=34.82%
2026-02-28 13:41:31,601 - lg_cotrain - INFO - Phase 2 epoch 3/9: loss1=0.0474, loss2=0.2117, dev_macro_f1=0.5434, dev_err=33.48%
2026-02-28 13:41:52,954 - lg_cotrain - INFO - Phase 2 epoch 4/9: loss1=0.0761, loss2=0.1649, dev_macro_f1=0.5612, dev_err=32.59%
2026-02-28 13:42:14,688 - lg_cotrain - INFO - Phase 2 epoch 5/9: loss1=0.0443, loss2=0.0827, dev_macro_f1=0.5439, dev_err=33.93%
2026-02-28 13:42:36,603 - lg_cotrain - INFO - Phase 2 epoch 6/9: loss1=0.0840, loss2=0.0381, dev_macro_f1=0.5676, dev_err=33.48%
2026-02-28 13:42:58,239 - lg_cotrain - INFO - Phase 2 epoch 7/9: loss1=0.0361, loss2=0.0328, dev_macro_f1=0.5718, dev_err=32.59%
2026-02-28 13:43:19,846 - lg_cotrain - INFO - Phase 2 epoch 8/9: loss1=0.0218, loss2=0.0147, dev_macro_f1=0.5908, dev_err=31.70%
2026-02-28 13:43:41,471 - lg_cotrain - INFO - Phase 2 epoch 9/9: loss1=0.0176, loss2=0.0199, dev_macro_f1=0.5886, dev_err=33.04%
2026-02-28 13:43:41,471 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-28 13:43:45,443 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.6422, dev_err=29.46%, es_counter1=0, es_counter2=0
2026-02-28 13:43:49,313 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.5910, dev_err=31.25%, es_counter1=1, es_counter2=1
2026-02-28 13:43:53,200 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.6692, dev_err=26.79%, es_counter1=0, es_counter2=0
2026-02-28 13:43:57,237 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.6721, dev_err=27.23%, es_counter1=0, es_counter2=0
2026-02-28 13:44:01,131 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.6740, dev_err=26.79%, es_counter1=0, es_counter2=0
2026-02-28 13:44:04,979 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.6718, dev_err=27.23%, es_counter1=1, es_counter2=1
2026-02-28 13:44:08,880 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.6754, dev_err=27.23%, es_counter1=0, es_counter2=0
2026-02-28 13:44:12,768 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.6764, dev_err=26.79%, es_counter1=0, es_counter2=0
2026-02-28 13:44:16,627 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.6741, dev_err=27.23%, es_counter1=1, es_counter2=1
2026-02-28 13:44:20,518 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.6750, dev_err=27.23%, es_counter1=2, es_counter2=2
2026-02-28 13:44:24,417 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.6750, dev_err=27.23%, es_counter1=3, es_counter2=3
2026-02-28 13:44:28,282 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.6751, dev_err=27.23%, es_counter1=4, es_counter2=4
2026-02-28 13:44:32,251 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.6751, dev_err=27.23%, es_counter1=5, es_counter2=5
2026-02-28 13:44:36,130 - lg_cotrain - INFO - Phase 3 epoch 14: dev_macro_f1=0.6751, dev_err=27.23%, es_counter1=6, es_counter2=6
2026-02-28 13:44:36,131 - lg_cotrain - INFO - Early stopping at epoch 14
2026-02-28 13:44:36,141 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-28 13:44:38,726 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpvypvw0ac\kaikoura_earthquake_2016\50_set2\metrics.json
2026-02-28 13:44:38,726 - lg_cotrain - INFO - Test error rate: 26.21%, Test macro-F1: 0.6862, Test ECE: 0.1107
2026-02-28 13:44:38,737 - lg_cotrain - INFO - --- Trial 6/10 done: dev_macro_f1=0.6764 ---
2026-02-28 13:44:38,737 - lg_cotrain - INFO - --- Trial 7/10 ---
2026-02-28 13:44:39,233 - lg_cotrain - INFO - Starting LG-CoTrain: event=kaikoura_earthquake_2016, budget=50, seed_set=2
2026-02-28 13:44:39,244 - lg_cotrain - INFO - Detected 9 classes for event kaikoura_earthquake_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-28 13:44:39,248 - lg_cotrain - INFO - D_l1: 209, D_l2: 208, D_LG: 1119
2026-02-28 13:44:39,249 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-28 13:44:46,820 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1222, mean_prob2=0.1178
2026-02-28 13:44:53,411 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.0716, mean_prob2=0.1063
2026-02-28 13:44:59,999 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1178, mean_prob2=0.2359
2026-02-28 13:45:06,624 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1123, mean_prob2=0.1739
2026-02-28 13:45:13,341 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1169, mean_prob2=0.2199
2026-02-28 13:45:19,992 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1209, mean_prob2=0.2562
2026-02-28 13:45:26,662 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1145, mean_prob2=0.4415
2026-02-28 13:45:26,664 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-28 13:45:27,679 - lg_cotrain - INFO - LR scheduler: total_steps_1=2590, warmup=556; total_steps_2=2490, warmup=534
2026-02-28 13:45:27,680 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1145, range=[0.0378, 0.1444]
2026-02-28 13:45:27,680 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.4415, range=[0.0007, 0.9573]
2026-02-28 13:45:45,804 - lg_cotrain - INFO - Phase 2 epoch 1/17: loss1=0.8013, loss2=0.2249, dev_macro_f1=0.2204, dev_err=50.00%
2026-02-28 13:46:04,010 - lg_cotrain - INFO - Phase 2 epoch 2/17: loss1=0.1730, loss2=0.1984, dev_macro_f1=0.3045, dev_err=45.54%
2026-02-28 13:46:22,159 - lg_cotrain - INFO - Phase 2 epoch 3/17: loss1=0.0635, loss2=0.1992, dev_macro_f1=0.4261, dev_err=38.84%
2026-02-28 13:46:40,321 - lg_cotrain - INFO - Phase 2 epoch 4/17: loss1=0.0562, loss2=0.2133, dev_macro_f1=0.5104, dev_err=33.48%
2026-02-28 13:46:58,427 - lg_cotrain - INFO - Phase 2 epoch 5/17: loss1=0.0385, loss2=0.2036, dev_macro_f1=0.4714, dev_err=37.50%
2026-02-28 13:47:16,511 - lg_cotrain - INFO - Phase 2 epoch 6/17: loss1=0.1113, loss2=0.3561, dev_macro_f1=0.4827, dev_err=36.61%
2026-02-28 13:47:34,642 - lg_cotrain - INFO - Phase 2 epoch 7/17: loss1=0.1573, loss2=0.4423, dev_macro_f1=0.4616, dev_err=37.50%
2026-02-28 13:47:53,205 - lg_cotrain - INFO - Phase 2 epoch 8/17: loss1=0.6550, loss2=0.6029, dev_macro_f1=0.1945, dev_err=54.46%
2026-02-28 13:48:11,634 - lg_cotrain - INFO - Phase 2 epoch 9/17: loss1=0.5473, loss2=1.2662, dev_macro_f1=0.1095, dev_err=69.64%
2026-02-28 13:48:29,929 - lg_cotrain - INFO - Phase 2 epoch 10/17: loss1=0.4650, loss2=1.1921, dev_macro_f1=0.1156, dev_err=65.18%
2026-02-28 13:48:48,315 - lg_cotrain - INFO - Phase 2 epoch 11/17: loss1=0.3880, loss2=1.1269, dev_macro_f1=0.1022, dev_err=70.09%
2026-02-28 13:49:06,479 - lg_cotrain - INFO - Phase 2 epoch 12/17: loss1=0.3398, loss2=1.0720, dev_macro_f1=0.1022, dev_err=70.09%
2026-02-28 13:49:24,496 - lg_cotrain - INFO - Phase 2 epoch 13/17: loss1=0.3044, loss2=1.0437, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 13:49:42,553 - lg_cotrain - INFO - Phase 2 epoch 14/17: loss1=0.2751, loss2=1.0067, dev_macro_f1=0.1025, dev_err=70.09%
2026-02-28 13:50:00,523 - lg_cotrain - INFO - Phase 2 epoch 15/17: loss1=0.2513, loss2=0.9881, dev_macro_f1=0.1119, dev_err=65.62%
2026-02-28 13:50:18,451 - lg_cotrain - INFO - Phase 2 epoch 16/17: loss1=0.2333, loss2=0.9534, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 13:50:36,545 - lg_cotrain - INFO - Phase 2 epoch 17/17: loss1=0.2155, loss2=0.9306, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 13:50:36,545 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-28 13:50:39,860 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.0335, dev_err=89.29%, es_counter1=0, es_counter2=0
2026-02-28 13:50:43,149 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.0207, dev_err=89.73%, es_counter1=1, es_counter2=1
2026-02-28 13:50:46,413 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.0335, dev_err=89.29%, es_counter1=2, es_counter2=2
2026-02-28 13:50:49,691 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.0970, dev_err=75.00%, es_counter1=0, es_counter2=0
2026-02-28 13:50:52,946 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.0970, dev_err=75.00%, es_counter1=1, es_counter2=1
2026-02-28 13:50:56,192 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.0335, dev_err=89.29%, es_counter1=2, es_counter2=2
2026-02-28 13:50:59,410 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.0956, dev_err=75.00%, es_counter1=3, es_counter2=3
2026-02-28 13:51:02,653 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.0459, dev_err=84.38%, es_counter1=4, es_counter2=4
2026-02-28 13:51:02,653 - lg_cotrain - INFO - Early stopping at epoch 8
2026-02-28 13:51:02,666 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-28 13:51:05,070 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpp85wx2qc\kaikoura_earthquake_2016\50_set2\metrics.json
2026-02-28 13:51:05,071 - lg_cotrain - INFO - Test error rate: 76.55%, Test macro-F1: 0.0896, Test ECE: 0.1158
2026-02-28 13:51:05,082 - lg_cotrain - INFO - --- Trial 7/10 done: dev_macro_f1=0.0970 ---
2026-02-28 13:51:05,082 - lg_cotrain - INFO - --- Trial 8/10 ---
2026-02-28 13:51:05,580 - lg_cotrain - INFO - Starting LG-CoTrain: event=kaikoura_earthquake_2016, budget=50, seed_set=2
2026-02-28 13:51:05,594 - lg_cotrain - INFO - Detected 9 classes for event kaikoura_earthquake_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-28 13:51:05,600 - lg_cotrain - INFO - D_l1: 209, D_l2: 208, D_LG: 1119
2026-02-28 13:51:05,601 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-28 13:51:14,276 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1249, mean_prob2=0.1148
2026-02-28 13:51:22,007 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1187, mean_prob2=0.1158
2026-02-28 13:51:29,685 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1045, mean_prob2=0.1109
2026-02-28 13:51:37,444 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1132, mean_prob2=0.1212
2026-02-28 13:51:45,050 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1224, mean_prob2=0.1190
2026-02-28 13:51:52,710 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1150, mean_prob2=0.1192
2026-02-28 13:52:00,338 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1212, mean_prob2=0.1310
2026-02-28 13:52:00,339 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-28 13:52:01,358 - lg_cotrain - INFO - LR scheduler: total_steps_1=5220, warmup=1067; total_steps_2=5120, warmup=1047
2026-02-28 13:52:01,358 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1212, range=[0.0511, 0.1368]
2026-02-28 13:52:01,358 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1310, range=[0.0314, 0.1748]
2026-02-28 13:52:22,690 - lg_cotrain - INFO - Phase 2 epoch 1/18: loss1=0.2219, loss2=0.2148, dev_macro_f1=0.2557, dev_err=48.21%
2026-02-28 13:52:44,139 - lg_cotrain - INFO - Phase 2 epoch 2/18: loss1=0.0773, loss2=0.2348, dev_macro_f1=0.3744, dev_err=41.52%
2026-02-28 13:53:05,561 - lg_cotrain - INFO - Phase 2 epoch 3/18: loss1=0.0512, loss2=0.3436, dev_macro_f1=0.4846, dev_err=36.16%
2026-02-28 13:53:26,957 - lg_cotrain - INFO - Phase 2 epoch 4/18: loss1=0.0953, loss2=0.4397, dev_macro_f1=0.2062, dev_err=56.25%
2026-02-28 13:53:48,429 - lg_cotrain - INFO - Phase 2 epoch 5/18: loss1=0.2348, loss2=0.6777, dev_macro_f1=0.2377, dev_err=56.70%
2026-02-28 13:54:09,787 - lg_cotrain - INFO - Phase 2 epoch 6/18: loss1=0.2656, loss2=1.2653, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 13:54:31,075 - lg_cotrain - INFO - Phase 2 epoch 7/18: loss1=0.2108, loss2=1.2524, dev_macro_f1=0.0365, dev_err=80.36%
2026-02-28 13:54:52,488 - lg_cotrain - INFO - Phase 2 epoch 8/18: loss1=0.1612, loss2=1.1766, dev_macro_f1=0.0278, dev_err=85.71%
2026-02-28 13:55:13,884 - lg_cotrain - INFO - Phase 2 epoch 9/18: loss1=0.1322, loss2=1.1304, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 13:55:35,370 - lg_cotrain - INFO - Phase 2 epoch 10/18: loss1=0.1124, loss2=1.0676, dev_macro_f1=0.0278, dev_err=85.71%
2026-02-28 13:55:56,843 - lg_cotrain - INFO - Phase 2 epoch 11/18: loss1=0.1005, loss2=1.0224, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 13:56:18,403 - lg_cotrain - INFO - Phase 2 epoch 12/18: loss1=0.0939, loss2=0.9797, dev_macro_f1=0.0278, dev_err=85.71%
2026-02-28 13:56:40,088 - lg_cotrain - INFO - Phase 2 epoch 13/18: loss1=0.0894, loss2=0.9501, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 13:57:01,517 - lg_cotrain - INFO - Phase 2 epoch 14/18: loss1=0.0842, loss2=0.9192, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 13:57:23,233 - lg_cotrain - INFO - Phase 2 epoch 15/18: loss1=0.0820, loss2=0.8989, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 13:57:44,676 - lg_cotrain - INFO - Phase 2 epoch 16/18: loss1=0.0783, loss2=0.8766, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 13:58:06,656 - lg_cotrain - INFO - Phase 2 epoch 17/18: loss1=0.0771, loss2=0.8588, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 13:58:28,192 - lg_cotrain - INFO - Phase 2 epoch 18/18: loss1=0.0767, loss2=0.8400, dev_macro_f1=0.0406, dev_err=77.68%
2026-02-28 13:58:28,192 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-28 13:58:32,091 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.0365, dev_err=80.36%, es_counter1=0, es_counter2=0
2026-02-28 13:58:36,058 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.0365, dev_err=80.36%, es_counter1=1, es_counter2=1
2026-02-28 13:58:40,070 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.0207, dev_err=89.73%, es_counter1=2, es_counter2=2
2026-02-28 13:58:44,005 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.0086, dev_err=95.98%, es_counter1=3, es_counter2=3
2026-02-28 13:58:47,913 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.0278, dev_err=85.71%, es_counter1=4, es_counter2=4
2026-02-28 13:58:51,825 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.0278, dev_err=85.71%, es_counter1=5, es_counter2=5
2026-02-28 13:58:55,728 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.0086, dev_err=95.98%, es_counter1=6, es_counter2=6
2026-02-28 13:58:59,661 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.0104, dev_err=95.09%, es_counter1=7, es_counter2=7
2026-02-28 13:59:03,647 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.0406, dev_err=77.68%, es_counter1=0, es_counter2=0
2026-02-28 13:59:07,625 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.0365, dev_err=80.36%, es_counter1=1, es_counter2=1
2026-02-28 13:59:11,537 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.0278, dev_err=85.71%, es_counter1=2, es_counter2=2
2026-02-28 13:59:15,479 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.0365, dev_err=80.36%, es_counter1=3, es_counter2=3
2026-02-28 13:59:19,412 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.0278, dev_err=85.71%, es_counter1=4, es_counter2=4
2026-02-28 13:59:23,287 - lg_cotrain - INFO - Phase 3 epoch 14: dev_macro_f1=0.0104, dev_err=95.09%, es_counter1=5, es_counter2=5
2026-02-28 13:59:27,159 - lg_cotrain - INFO - Phase 3 epoch 15: dev_macro_f1=0.0086, dev_err=95.98%, es_counter1=6, es_counter2=6
2026-02-28 13:59:31,093 - lg_cotrain - INFO - Phase 3 epoch 16: dev_macro_f1=0.0406, dev_err=77.68%, es_counter1=7, es_counter2=7
2026-02-28 13:59:35,035 - lg_cotrain - INFO - Phase 3 epoch 17: dev_macro_f1=0.0278, dev_err=85.71%, es_counter1=8, es_counter2=8
2026-02-28 13:59:35,035 - lg_cotrain - INFO - Early stopping at epoch 17
2026-02-28 13:59:35,044 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-28 13:59:37,674 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpnob07wix\kaikoura_earthquake_2016\50_set2\metrics.json
2026-02-28 13:59:37,674 - lg_cotrain - INFO - Test error rate: 77.47%, Test macro-F1: 0.0409, Test ECE: 0.0801
2026-02-28 13:59:37,686 - lg_cotrain - INFO - --- Trial 8/10 done: dev_macro_f1=0.0406 ---
2026-02-28 13:59:37,687 - lg_cotrain - INFO - --- Trial 9/10 ---
2026-02-28 13:59:38,199 - lg_cotrain - INFO - Starting LG-CoTrain: event=kaikoura_earthquake_2016, budget=50, seed_set=2
2026-02-28 13:59:38,215 - lg_cotrain - INFO - Detected 9 classes for event kaikoura_earthquake_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-28 13:59:38,222 - lg_cotrain - INFO - D_l1: 209, D_l2: 208, D_LG: 1119
2026-02-28 13:59:38,222 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-28 13:59:45,483 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1174, mean_prob2=0.1362
2026-02-28 13:59:51,649 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1636, mean_prob2=0.2707
2026-02-28 13:59:57,944 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.2945, mean_prob2=0.4255
2026-02-28 14:00:04,245 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.4757, mean_prob2=0.5430
2026-02-28 14:00:10,495 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.5414, mean_prob2=0.6348
2026-02-28 14:00:16,909 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.5751, mean_prob2=0.6592
2026-02-28 14:00:23,324 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.5989, mean_prob2=0.6393
2026-02-28 14:00:23,324 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-28 14:00:24,315 - lg_cotrain - INFO - LR scheduler: total_steps_1=945, warmup=203; total_steps_2=945, warmup=203
2026-02-28 14:00:24,316 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.5989, range=[0.0005, 0.9895]
2026-02-28 14:00:24,316 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.6393, range=[0.0004, 0.9886]
2026-02-28 14:00:40,907 - lg_cotrain - INFO - Phase 2 epoch 1/7: loss1=1.2351, loss2=1.2100, dev_macro_f1=0.1580, dev_err=58.48%
2026-02-28 14:00:57,470 - lg_cotrain - INFO - Phase 2 epoch 2/7: loss1=0.1813, loss2=0.8897, dev_macro_f1=0.2312, dev_err=47.77%
2026-02-28 14:01:13,909 - lg_cotrain - INFO - Phase 2 epoch 3/7: loss1=0.0848, loss2=0.3665, dev_macro_f1=0.4258, dev_err=37.05%
2026-02-28 14:01:30,540 - lg_cotrain - INFO - Phase 2 epoch 4/7: loss1=0.0469, loss2=0.1722, dev_macro_f1=0.4452, dev_err=37.05%
2026-02-28 14:01:47,183 - lg_cotrain - INFO - Phase 2 epoch 5/7: loss1=0.0312, loss2=0.1709, dev_macro_f1=0.5252, dev_err=34.38%
2026-02-28 14:02:03,863 - lg_cotrain - INFO - Phase 2 epoch 6/7: loss1=0.0663, loss2=0.1787, dev_macro_f1=0.5135, dev_err=34.82%
2026-02-28 14:02:20,520 - lg_cotrain - INFO - Phase 2 epoch 7/7: loss1=0.1036, loss2=0.1433, dev_macro_f1=0.5142, dev_err=34.82%
2026-02-28 14:02:20,520 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-28 14:02:23,714 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.5435, dev_err=39.73%, es_counter1=0, es_counter2=0
2026-02-28 14:02:26,732 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.6287, dev_err=30.80%, es_counter1=0, es_counter2=0
2026-02-28 14:02:29,673 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.6366, dev_err=28.12%, es_counter1=0, es_counter2=0
2026-02-28 14:02:32,640 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.6449, dev_err=27.68%, es_counter1=0, es_counter2=0
2026-02-28 14:02:35,591 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.6545, dev_err=28.12%, es_counter1=0, es_counter2=0
2026-02-28 14:02:38,583 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.6634, dev_err=27.68%, es_counter1=0, es_counter2=0
2026-02-28 14:02:41,535 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.6598, dev_err=28.12%, es_counter1=1, es_counter2=1
2026-02-28 14:02:44,463 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.6543, dev_err=30.80%, es_counter1=2, es_counter2=2
2026-02-28 14:02:47,391 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.6473, dev_err=28.12%, es_counter1=3, es_counter2=3
2026-02-28 14:02:50,317 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.6211, dev_err=29.91%, es_counter1=4, es_counter2=4
2026-02-28 14:02:53,327 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.6364, dev_err=30.36%, es_counter1=5, es_counter2=5
2026-02-28 14:02:56,294 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.6572, dev_err=30.80%, es_counter1=6, es_counter2=6
2026-02-28 14:02:59,324 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.6196, dev_err=32.59%, es_counter1=7, es_counter2=7
2026-02-28 14:03:02,269 - lg_cotrain - INFO - Phase 3 epoch 14: dev_macro_f1=0.6685, dev_err=29.02%, es_counter1=0, es_counter2=0
2026-02-28 14:03:05,312 - lg_cotrain - INFO - Phase 3 epoch 15: dev_macro_f1=0.6381, dev_err=29.02%, es_counter1=1, es_counter2=1
2026-02-28 14:03:08,388 - lg_cotrain - INFO - Phase 3 epoch 16: dev_macro_f1=0.6314, dev_err=30.36%, es_counter1=2, es_counter2=2
2026-02-28 14:03:11,332 - lg_cotrain - INFO - Phase 3 epoch 17: dev_macro_f1=0.6199, dev_err=30.36%, es_counter1=3, es_counter2=3
2026-02-28 14:03:14,292 - lg_cotrain - INFO - Phase 3 epoch 18: dev_macro_f1=0.6892, dev_err=27.23%, es_counter1=0, es_counter2=0
2026-02-28 14:03:17,214 - lg_cotrain - INFO - Phase 3 epoch 19: dev_macro_f1=0.6605, dev_err=30.36%, es_counter1=1, es_counter2=1
2026-02-28 14:03:20,152 - lg_cotrain - INFO - Phase 3 epoch 20: dev_macro_f1=0.6031, dev_err=31.25%, es_counter1=2, es_counter2=2
2026-02-28 14:03:23,072 - lg_cotrain - INFO - Phase 3 epoch 21: dev_macro_f1=0.6145, dev_err=32.14%, es_counter1=3, es_counter2=3
2026-02-28 14:03:26,004 - lg_cotrain - INFO - Phase 3 epoch 22: dev_macro_f1=0.6380, dev_err=32.14%, es_counter1=4, es_counter2=4
2026-02-28 14:03:28,936 - lg_cotrain - INFO - Phase 3 epoch 23: dev_macro_f1=0.6702, dev_err=29.46%, es_counter1=5, es_counter2=5
2026-02-28 14:03:31,868 - lg_cotrain - INFO - Phase 3 epoch 24: dev_macro_f1=0.6506, dev_err=30.80%, es_counter1=6, es_counter2=6
2026-02-28 14:03:34,786 - lg_cotrain - INFO - Phase 3 epoch 25: dev_macro_f1=0.6251, dev_err=31.25%, es_counter1=7, es_counter2=7
2026-02-28 14:03:37,700 - lg_cotrain - INFO - Phase 3 epoch 26: dev_macro_f1=0.6313, dev_err=29.91%, es_counter1=8, es_counter2=8
2026-02-28 14:03:37,700 - lg_cotrain - INFO - Early stopping at epoch 26
2026-02-28 14:03:37,710 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-28 14:03:39,974 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpoapghir0\kaikoura_earthquake_2016\50_set2\metrics.json
2026-02-28 14:03:39,975 - lg_cotrain - INFO - Test error rate: 25.98%, Test macro-F1: 0.6828, Test ECE: 0.1139
2026-02-28 14:03:39,984 - lg_cotrain - INFO - --- Trial 9/10 done: dev_macro_f1=0.6892 ---
2026-02-28 14:03:39,985 - lg_cotrain - INFO - --- Trial 10/10 ---
2026-02-28 14:03:40,501 - lg_cotrain - INFO - Starting LG-CoTrain: event=kaikoura_earthquake_2016, budget=50, seed_set=2
2026-02-28 14:03:40,512 - lg_cotrain - INFO - Detected 9 classes for event kaikoura_earthquake_2016: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-28 14:03:40,515 - lg_cotrain - INFO - D_l1: 209, D_l2: 208, D_LG: 1119
2026-02-28 14:03:40,516 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-28 14:03:47,306 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1242, mean_prob2=0.1306
2026-02-28 14:03:53,048 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1372, mean_prob2=0.1598
2026-02-28 14:03:58,792 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1614, mean_prob2=0.1977
2026-02-28 14:04:04,549 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1888, mean_prob2=0.2836
2026-02-28 14:04:10,289 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.2338, mean_prob2=0.3722
2026-02-28 14:04:16,061 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.2900, mean_prob2=0.4398
2026-02-28 14:04:21,825 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.3540, mean_prob2=0.4960
2026-02-28 14:04:21,826 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-28 14:04:22,835 - lg_cotrain - INFO - LR scheduler: total_steps_1=742, warmup=91; total_steps_2=742, warmup=91
2026-02-28 14:04:22,836 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.3540, range=[0.0087, 0.8095]
2026-02-28 14:04:22,836 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.4960, range=[0.0041, 0.9223]
2026-02-28 14:04:38,075 - lg_cotrain - INFO - Phase 2 epoch 1/19: loss1=1.0135, loss2=0.7465, dev_macro_f1=0.1263, dev_err=62.05%
2026-02-28 14:04:53,108 - lg_cotrain - INFO - Phase 2 epoch 2/19: loss1=0.2235, loss2=0.6481, dev_macro_f1=0.2046, dev_err=51.79%
2026-02-28 14:05:08,085 - lg_cotrain - INFO - Phase 2 epoch 3/19: loss1=0.1566, loss2=0.4186, dev_macro_f1=0.2282, dev_err=47.77%
2026-02-28 14:05:23,031 - lg_cotrain - INFO - Phase 2 epoch 4/19: loss1=0.1056, loss2=0.2417, dev_macro_f1=0.3690, dev_err=40.62%
2026-02-28 14:05:37,979 - lg_cotrain - INFO - Phase 2 epoch 5/19: loss1=0.0577, loss2=0.1524, dev_macro_f1=0.4452, dev_err=37.50%
2026-02-28 14:05:52,916 - lg_cotrain - INFO - Phase 2 epoch 6/19: loss1=0.0337, loss2=0.1232, dev_macro_f1=0.4384, dev_err=37.95%
2026-02-28 14:06:07,897 - lg_cotrain - INFO - Phase 2 epoch 7/19: loss1=0.0296, loss2=0.0850, dev_macro_f1=0.4680, dev_err=37.50%
2026-02-28 14:06:22,887 - lg_cotrain - INFO - Phase 2 epoch 8/19: loss1=0.0251, loss2=0.0964, dev_macro_f1=0.4635, dev_err=36.16%
2026-02-28 14:06:37,963 - lg_cotrain - INFO - Phase 2 epoch 9/19: loss1=0.0230, loss2=0.0507, dev_macro_f1=0.5347, dev_err=33.93%
2026-02-28 14:06:53,119 - lg_cotrain - INFO - Phase 2 epoch 10/19: loss1=0.0195, loss2=0.0267, dev_macro_f1=0.5471, dev_err=35.27%
2026-02-28 14:07:08,372 - lg_cotrain - INFO - Phase 2 epoch 11/19: loss1=0.0264, loss2=0.0201, dev_macro_f1=0.5569, dev_err=34.38%
2026-02-28 14:07:23,612 - lg_cotrain - INFO - Phase 2 epoch 12/19: loss1=0.0247, loss2=0.0160, dev_macro_f1=0.5518, dev_err=33.93%
2026-02-28 14:07:38,802 - lg_cotrain - INFO - Phase 2 epoch 13/19: loss1=0.0215, loss2=0.0203, dev_macro_f1=0.5396, dev_err=35.27%
2026-02-28 14:07:53,815 - lg_cotrain - INFO - Phase 2 epoch 14/19: loss1=0.0451, loss2=0.0129, dev_macro_f1=0.5871, dev_err=33.04%
2026-02-28 14:08:08,748 - lg_cotrain - INFO - Phase 2 epoch 15/19: loss1=0.0370, loss2=0.0190, dev_macro_f1=0.5451, dev_err=35.27%
2026-02-28 14:08:23,627 - lg_cotrain - INFO - Phase 2 epoch 16/19: loss1=0.0251, loss2=0.0126, dev_macro_f1=0.5734, dev_err=34.38%
2026-02-28 14:08:38,647 - lg_cotrain - INFO - Phase 2 epoch 17/19: loss1=0.0195, loss2=0.0104, dev_macro_f1=0.6269, dev_err=31.25%
2026-02-28 14:08:53,575 - lg_cotrain - INFO - Phase 2 epoch 18/19: loss1=0.0146, loss2=0.0093, dev_macro_f1=0.6237, dev_err=31.25%
2026-02-28 14:09:08,477 - lg_cotrain - INFO - Phase 2 epoch 19/19: loss1=0.0155, loss2=0.0058, dev_macro_f1=0.6197, dev_err=31.25%
2026-02-28 14:09:08,477 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-28 14:09:11,299 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.5873, dev_err=34.82%, es_counter1=0, es_counter2=0
2026-02-28 14:09:13,971 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.6459, dev_err=28.57%, es_counter1=0, es_counter2=0
2026-02-28 14:09:16,648 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.6654, dev_err=27.23%, es_counter1=0, es_counter2=0
2026-02-28 14:09:19,326 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.6773, dev_err=24.55%, es_counter1=0, es_counter2=0
2026-02-28 14:09:22,010 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.6776, dev_err=25.00%, es_counter1=0, es_counter2=0
2026-02-28 14:09:24,670 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.6683, dev_err=27.23%, es_counter1=1, es_counter2=1
2026-02-28 14:09:27,371 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.6688, dev_err=27.23%, es_counter1=2, es_counter2=2
2026-02-28 14:09:30,092 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.6553, dev_err=28.12%, es_counter1=3, es_counter2=3
2026-02-28 14:09:32,866 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.6472, dev_err=28.57%, es_counter1=4, es_counter2=4
2026-02-28 14:09:35,540 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.6329, dev_err=30.80%, es_counter1=5, es_counter2=5
2026-02-28 14:09:38,221 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.6358, dev_err=30.80%, es_counter1=6, es_counter2=6
2026-02-28 14:09:40,881 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.6368, dev_err=29.91%, es_counter1=7, es_counter2=7
2026-02-28 14:09:43,593 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.6431, dev_err=29.46%, es_counter1=8, es_counter2=8
2026-02-28 14:09:46,288 - lg_cotrain - INFO - Phase 3 epoch 14: dev_macro_f1=0.6488, dev_err=29.02%, es_counter1=9, es_counter2=9
2026-02-28 14:09:46,288 - lg_cotrain - INFO - Early stopping at epoch 14
2026-02-28 14:09:46,300 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-28 14:09:48,415 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmphanezofa\kaikoura_earthquake_2016\50_set2\metrics.json
2026-02-28 14:09:48,415 - lg_cotrain - INFO - Test error rate: 26.21%, Test macro-F1: 0.6737, Test ECE: 0.0650
2026-02-28 14:09:48,427 - lg_cotrain - INFO - --- Trial 10/10 done: dev_macro_f1=0.6776 ---
