2026-02-22 11:37:55,909 - lg_cotrain - INFO - === Optuna study: california_wildfires_2018 budget=50 seed=2 | target=10 trials, 0 replayed, 10 new ===
2026-02-22 11:37:55,910 - lg_cotrain - INFO - --- Trial 1/10 ---
2026-02-22 11:37:56,452 - lg_cotrain - INFO - Starting LG-CoTrain: event=california_wildfires_2018, budget=50, seed_set=2
2026-02-22 11:37:56,513 - lg_cotrain - INFO - Detected 10 classes for event california_wildfires_2018: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'missing_or_found_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-22 11:37:56,521 - lg_cotrain - INFO - D_l1: 250, D_l2: 250, D_LG: 4663
2026-02-22 11:37:56,523 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-22 11:38:17,657 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1120, mean_prob2=0.1100
2026-02-22 11:38:37,884 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1326, mean_prob2=0.1419
2026-02-22 11:38:58,216 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1550, mean_prob2=0.1803
2026-02-22 11:39:18,593 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.2010, mean_prob2=0.2226
2026-02-22 11:39:39,211 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.2433, mean_prob2=0.2579
2026-02-22 11:39:59,414 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.2925, mean_prob2=0.3488
2026-02-22 11:40:19,719 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.3400, mean_prob2=0.4085
2026-02-22 11:40:19,720 - lg_cotrain - INFO - Phase 1 done. lambda1: mean=0.3079, range=[0.0280, 0.7512]
2026-02-22 11:40:19,720 - lg_cotrain - INFO - Phase 1 done. lambda2: mean=0.1190, range=[0.0000, 0.2768]
2026-02-22 11:40:19,721 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-22 11:40:20,743 - lg_cotrain - INFO - LR scheduler: total_steps_1=4812, warmup=360; total_steps_2=4812, warmup=360
2026-02-22 11:41:33,972 - lg_cotrain - INFO - Phase 2 epoch 1/11: loss1=0.1551, loss2=0.3966, dev_macro_f1=0.4155, dev_err=32.18%
2026-02-22 11:42:47,714 - lg_cotrain - INFO - Phase 2 epoch 2/11: loss1=0.0757, loss2=0.2113, dev_macro_f1=0.5523, dev_err=26.60%
2026-02-22 11:44:02,935 - lg_cotrain - INFO - Phase 2 epoch 3/11: loss1=0.0320, loss2=0.1362, dev_macro_f1=0.5861, dev_err=25.66%
2026-02-22 11:45:19,685 - lg_cotrain - INFO - Phase 2 epoch 4/11: loss1=0.0270, loss2=0.1023, dev_macro_f1=0.6054, dev_err=25.53%
2026-02-22 11:46:33,717 - lg_cotrain - INFO - Phase 2 epoch 5/11: loss1=0.0208, loss2=0.0614, dev_macro_f1=0.6059, dev_err=26.20%
2026-02-22 11:47:47,630 - lg_cotrain - INFO - Phase 2 epoch 6/11: loss1=0.0178, loss2=0.0388, dev_macro_f1=0.6122, dev_err=25.80%
2026-02-22 11:49:01,151 - lg_cotrain - INFO - Phase 2 epoch 7/11: loss1=0.0163, loss2=0.0377, dev_macro_f1=0.5927, dev_err=27.53%
2026-02-22 11:50:14,331 - lg_cotrain - INFO - Phase 2 epoch 8/11: loss1=0.0175, loss2=0.0129, dev_macro_f1=0.6011, dev_err=27.26%
2026-02-22 11:51:28,261 - lg_cotrain - INFO - Phase 2 epoch 9/11: loss1=0.0119, loss2=0.0084, dev_macro_f1=0.6030, dev_err=27.39%
2026-02-22 11:52:41,529 - lg_cotrain - INFO - Phase 2 epoch 10/11: loss1=0.0098, loss2=0.0060, dev_macro_f1=0.6046, dev_err=26.99%
2026-02-22 11:53:55,042 - lg_cotrain - INFO - Phase 2 epoch 11/11: loss1=0.0103, loss2=0.0052, dev_macro_f1=0.6104, dev_err=26.86%
2026-02-22 11:53:55,042 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-22 11:54:00,582 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.5047, dev_err=47.07%, es_counter1=0, es_counter2=0
2026-02-22 11:54:06,115 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.6361, dev_err=27.93%, es_counter1=0, es_counter2=0
2026-02-22 11:54:11,660 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.6315, dev_err=31.25%, es_counter1=1, es_counter2=1
2026-02-22 11:54:17,276 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.6118, dev_err=31.25%, es_counter1=2, es_counter2=2
2026-02-22 11:54:22,849 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.6321, dev_err=29.92%, es_counter1=3, es_counter2=3
2026-02-22 11:54:28,398 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.6252, dev_err=30.85%, es_counter1=4, es_counter2=4
2026-02-22 11:54:33,892 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.6202, dev_err=31.12%, es_counter1=5, es_counter2=5
2026-02-22 11:54:39,393 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.6183, dev_err=31.38%, es_counter1=6, es_counter2=6
2026-02-22 11:54:44,978 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.6161, dev_err=31.12%, es_counter1=7, es_counter2=7
2026-02-22 11:54:44,979 - lg_cotrain - INFO - Early stopping at epoch 9
2026-02-22 11:54:44,989 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-22 11:54:52,866 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmprl219um_\california_wildfires_2018\50_set2\metrics.json
2026-02-22 11:54:52,866 - lg_cotrain - INFO - Test error rate: 25.74%, Test macro-F1: 0.6699, Test ECE: 0.0711
2026-02-22 11:54:52,875 - lg_cotrain - INFO - --- Trial 1/10 done: dev_macro_f1=0.6361 ---
2026-02-22 11:54:52,875 - lg_cotrain - INFO - --- Trial 2/10 ---
2026-02-22 11:54:53,448 - lg_cotrain - INFO - Starting LG-CoTrain: event=california_wildfires_2018, budget=50, seed_set=2
2026-02-22 11:54:53,482 - lg_cotrain - INFO - Detected 10 classes for event california_wildfires_2018: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'missing_or_found_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-22 11:54:53,489 - lg_cotrain - INFO - D_l1: 250, D_l2: 250, D_LG: 4663
2026-02-22 11:54:53,490 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-22 11:55:17,187 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.0883, mean_prob2=0.1227
2026-02-22 11:55:40,538 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.0900, mean_prob2=0.1393
2026-02-22 11:56:03,531 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.0812, mean_prob2=0.1087
2026-02-22 11:56:26,161 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1170, mean_prob2=0.1230
2026-02-22 11:56:49,379 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1041, mean_prob2=0.1038
2026-02-22 11:57:12,520 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.0935, mean_prob2=0.0781
2026-02-22 11:57:35,627 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1051, mean_prob2=0.0804
2026-02-22 11:57:35,627 - lg_cotrain - INFO - Phase 1 done. lambda1: mean=0.1357, range=[0.1232, 0.1808]
2026-02-22 11:57:35,627 - lg_cotrain - INFO - Phase 1 done. lambda2: mean=0.0542, range=[0.0425, 0.0717]
2026-02-22 11:57:35,627 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-22 11:57:36,657 - lg_cotrain - INFO - LR scheduler: total_steps_1=12528, warmup=357; total_steps_2=12528, warmup=357
2026-02-22 11:59:06,034 - lg_cotrain - INFO - Phase 2 epoch 1/16: loss1=0.1017, loss2=0.2693, dev_macro_f1=0.0302, dev_err=82.18%
2026-02-22 12:00:35,936 - lg_cotrain - INFO - Phase 2 epoch 2/16: loss1=0.1150, loss2=0.3166, dev_macro_f1=0.0302, dev_err=82.18%
2026-02-22 12:02:07,175 - lg_cotrain - INFO - Phase 2 epoch 3/16: loss1=0.1113, loss2=0.3384, dev_macro_f1=0.0302, dev_err=82.18%
2026-02-22 12:03:38,002 - lg_cotrain - INFO - Phase 2 epoch 4/16: loss1=0.1227, loss2=0.3613, dev_macro_f1=0.0302, dev_err=82.18%
2026-02-22 12:05:08,716 - lg_cotrain - INFO - Phase 2 epoch 5/16: loss1=0.1259, loss2=0.3645, dev_macro_f1=0.0302, dev_err=82.18%
2026-02-22 12:06:38,487 - lg_cotrain - INFO - Phase 2 epoch 6/16: loss1=0.1315, loss2=0.3645, dev_macro_f1=0.0302, dev_err=82.18%
2026-02-22 12:08:08,087 - lg_cotrain - INFO - Phase 2 epoch 7/16: loss1=0.1350, loss2=0.3616, dev_macro_f1=0.0302, dev_err=82.18%
2026-02-22 12:09:41,137 - lg_cotrain - INFO - Phase 2 epoch 8/16: loss1=0.1375, loss2=0.3739, dev_macro_f1=0.0302, dev_err=82.18%
2026-02-22 12:11:13,276 - lg_cotrain - INFO - Phase 2 epoch 9/16: loss1=0.1402, loss2=0.3636, dev_macro_f1=0.0302, dev_err=82.18%
2026-02-22 12:12:45,408 - lg_cotrain - INFO - Phase 2 epoch 10/16: loss1=0.1416, loss2=0.3572, dev_macro_f1=0.0302, dev_err=82.18%
2026-02-22 12:14:16,605 - lg_cotrain - INFO - Phase 2 epoch 11/16: loss1=0.1428, loss2=0.3540, dev_macro_f1=0.0302, dev_err=82.18%
2026-02-22 12:15:43,420 - lg_cotrain - INFO - Phase 2 epoch 12/16: loss1=0.1439, loss2=0.3508, dev_macro_f1=0.0302, dev_err=82.18%
2026-02-22 12:17:11,964 - lg_cotrain - INFO - Phase 2 epoch 13/16: loss1=0.1427, loss2=0.3485, dev_macro_f1=0.0302, dev_err=82.18%
2026-02-22 12:18:44,842 - lg_cotrain - INFO - Phase 2 epoch 14/16: loss1=0.1438, loss2=0.3468, dev_macro_f1=0.0302, dev_err=82.18%
2026-02-22 12:20:17,739 - lg_cotrain - INFO - Phase 2 epoch 15/16: loss1=0.1461, loss2=0.3442, dev_macro_f1=0.0302, dev_err=82.18%
2026-02-22 12:21:50,883 - lg_cotrain - INFO - Phase 2 epoch 16/16: loss1=0.1476, loss2=0.3407, dev_macro_f1=0.0302, dev_err=82.18%
2026-02-22 12:21:50,883 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-22 12:21:57,779 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.0419, dev_err=73.54%, es_counter1=0, es_counter2=0
2026-02-22 12:22:04,653 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.0120, dev_err=93.62%, es_counter1=1, es_counter2=1
2026-02-22 12:22:11,515 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.0302, dev_err=82.18%, es_counter1=2, es_counter2=2
2026-02-22 12:22:18,380 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.0419, dev_err=73.54%, es_counter1=3, es_counter2=3
2026-02-22 12:22:25,244 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.0302, dev_err=82.18%, es_counter1=4, es_counter2=4
2026-02-22 12:22:32,117 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.0302, dev_err=82.18%, es_counter1=5, es_counter2=5
2026-02-22 12:22:39,010 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.0021, dev_err=98.94%, es_counter1=6, es_counter2=6
2026-02-22 12:22:45,875 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.0419, dev_err=73.54%, es_counter1=7, es_counter2=7
2026-02-22 12:22:52,725 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.0419, dev_err=73.54%, es_counter1=8, es_counter2=8
2026-02-22 12:22:59,584 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.0247, dev_err=85.90%, es_counter1=9, es_counter2=9
2026-02-22 12:22:59,584 - lg_cotrain - INFO - Early stopping at epoch 10
2026-02-22 12:22:59,595 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-22 12:23:08,667 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpoz381bdj\california_wildfires_2018\50_set2\metrics.json
2026-02-22 12:23:08,667 - lg_cotrain - INFO - Test error rate: 73.65%, Test macro-F1: 0.0417, Test ECE: 0.1327
2026-02-22 12:23:08,679 - lg_cotrain - INFO - --- Trial 2/10 done: dev_macro_f1=0.0419 ---
2026-02-22 12:23:08,680 - lg_cotrain - INFO - --- Trial 3/10 ---
2026-02-22 12:23:09,255 - lg_cotrain - INFO - Starting LG-CoTrain: event=california_wildfires_2018, budget=50, seed_set=2
2026-02-22 12:23:09,295 - lg_cotrain - INFO - Detected 10 classes for event california_wildfires_2018: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'missing_or_found_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-22 12:23:09,305 - lg_cotrain - INFO - D_l1: 250, D_l2: 250, D_LG: 4663
2026-02-22 12:23:09,307 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-22 12:23:32,009 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1162, mean_prob2=0.1083
2026-02-22 12:23:53,959 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1399, mean_prob2=0.1414
2026-02-22 12:24:15,814 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1744, mean_prob2=0.1909
2026-02-22 12:24:37,692 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.2313, mean_prob2=0.2420
2026-02-22 12:24:59,680 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.2848, mean_prob2=0.3087
2026-02-22 12:25:21,537 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.3573, mean_prob2=0.3809
2026-02-22 12:25:43,371 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.3795, mean_prob2=0.4512
2026-02-22 12:25:43,371 - lg_cotrain - INFO - Phase 1 done. lambda1: mean=0.3594, range=[0.0300, 0.7729]
2026-02-22 12:25:43,372 - lg_cotrain - INFO - Phase 1 done. lambda2: mean=0.1234, range=[0.0000, 0.2892]
2026-02-22 12:25:43,372 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-22 12:25:44,375 - lg_cotrain - INFO - LR scheduler: total_steps_1=3936, warmup=746; total_steps_2=3936, warmup=746
2026-02-22 12:27:03,079 - lg_cotrain - INFO - Phase 2 epoch 1/8: loss1=0.1832, loss2=0.5486, dev_macro_f1=0.3872, dev_err=32.58%
2026-02-22 12:28:21,344 - lg_cotrain - INFO - Phase 2 epoch 2/8: loss1=0.0764, loss2=0.2355, dev_macro_f1=0.5433, dev_err=27.79%
2026-02-22 12:29:39,788 - lg_cotrain - INFO - Phase 2 epoch 3/8: loss1=0.0390, loss2=0.1843, dev_macro_f1=0.5495, dev_err=27.53%
2026-02-22 12:30:54,855 - lg_cotrain - INFO - Phase 2 epoch 4/8: loss1=0.0366, loss2=0.1205, dev_macro_f1=0.5668, dev_err=26.86%
2026-02-22 12:32:09,266 - lg_cotrain - INFO - Phase 2 epoch 5/8: loss1=0.0194, loss2=0.0718, dev_macro_f1=0.5822, dev_err=27.13%
2026-02-22 12:33:23,617 - lg_cotrain - INFO - Phase 2 epoch 6/8: loss1=0.0130, loss2=0.0399, dev_macro_f1=0.5894, dev_err=26.86%
2026-02-22 12:34:38,798 - lg_cotrain - INFO - Phase 2 epoch 7/8: loss1=0.0230, loss2=0.0294, dev_macro_f1=0.6090, dev_err=26.46%
