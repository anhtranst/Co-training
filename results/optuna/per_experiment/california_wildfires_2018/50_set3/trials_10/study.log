2026-02-23 11:50:18,137 - lg_cotrain - INFO - === Optuna study: california_wildfires_2018 budget=50 seed=3 | target=10 trials, 0 replayed, 10 new ===
2026-02-23 11:50:18,137 - lg_cotrain - INFO - --- Trial 1/10 ---
2026-02-23 11:50:18,735 - lg_cotrain - INFO - Starting LG-CoTrain: event=california_wildfires_2018, budget=50, seed_set=3
2026-02-23 11:50:18,791 - lg_cotrain - INFO - Detected 10 classes for event california_wildfires_2018: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'missing_or_found_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 11:50:18,802 - lg_cotrain - INFO - D_l1: 250, D_l2: 250, D_LG: 4663
2026-02-23 11:50:18,803 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 11:50:48,974 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1040, mean_prob2=0.1099
2026-02-23 11:51:18,307 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1096, mean_prob2=0.0988
2026-02-23 11:51:47,257 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1788, mean_prob2=0.1454
2026-02-23 11:52:16,223 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.2011, mean_prob2=0.2795
2026-02-23 11:52:45,586 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.2290, mean_prob2=0.3940
2026-02-23 11:53:14,664 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.3521, mean_prob2=0.4785
2026-02-23 11:53:43,609 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.3962, mean_prob2=0.4977
2026-02-23 11:53:43,609 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 11:53:44,601 - lg_cotrain - INFO - LR scheduler: total_steps_1=1495, warmup=331; total_steps_2=1495, warmup=331
2026-02-23 11:53:44,601 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.3962, range=[0.0016, 0.9067]
2026-02-23 11:53:44,601 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.4977, range=[0.0012, 0.9754]
2026-02-23 11:54:53,856 - lg_cotrain - INFO - Phase 2 epoch 1/15: loss1=0.9000, loss2=0.6304, dev_macro_f1=0.3591, dev_err=35.51%
2026-02-23 11:56:02,428 - lg_cotrain - INFO - Phase 2 epoch 2/15: loss1=0.0905, loss2=0.2284, dev_macro_f1=0.5367, dev_err=30.59%
2026-02-23 11:57:10,986 - lg_cotrain - INFO - Phase 2 epoch 3/15: loss1=0.0558, loss2=0.1721, dev_macro_f1=0.5350, dev_err=29.39%
2026-02-23 11:58:19,272 - lg_cotrain - INFO - Phase 2 epoch 4/15: loss1=0.0642, loss2=0.2000, dev_macro_f1=0.5849, dev_err=26.73%
2026-02-23 11:59:27,933 - lg_cotrain - INFO - Phase 2 epoch 5/15: loss1=0.1091, loss2=0.1856, dev_macro_f1=0.5433, dev_err=27.66%
2026-02-23 12:00:36,601 - lg_cotrain - INFO - Phase 2 epoch 6/15: loss1=0.0842, loss2=0.2436, dev_macro_f1=0.5274, dev_err=30.45%
2026-02-23 12:01:44,959 - lg_cotrain - INFO - Phase 2 epoch 7/15: loss1=0.0614, loss2=0.2383, dev_macro_f1=0.5359, dev_err=27.66%
2026-02-23 12:02:53,295 - lg_cotrain - INFO - Phase 2 epoch 8/15: loss1=0.0389, loss2=0.1593, dev_macro_f1=0.5611, dev_err=27.93%
2026-02-23 12:04:01,663 - lg_cotrain - INFO - Phase 2 epoch 9/15: loss1=0.0220, loss2=0.0888, dev_macro_f1=0.6003, dev_err=26.33%
2026-02-23 12:05:10,179 - lg_cotrain - INFO - Phase 2 epoch 10/15: loss1=0.0228, loss2=0.0956, dev_macro_f1=0.5925, dev_err=26.46%
2026-02-23 12:06:18,500 - lg_cotrain - INFO - Phase 2 epoch 11/15: loss1=0.0142, loss2=0.0816, dev_macro_f1=0.5935, dev_err=26.86%
2026-02-23 12:07:26,473 - lg_cotrain - INFO - Phase 2 epoch 12/15: loss1=0.0116, loss2=0.0800, dev_macro_f1=0.5826, dev_err=26.46%
2026-02-23 12:08:34,751 - lg_cotrain - INFO - Phase 2 epoch 13/15: loss1=0.0119, loss2=0.0465, dev_macro_f1=0.5890, dev_err=26.99%
2026-02-23 12:09:43,169 - lg_cotrain - INFO - Phase 2 epoch 14/15: loss1=0.0099, loss2=0.0240, dev_macro_f1=0.5991, dev_err=26.33%
2026-02-23 12:10:51,675 - lg_cotrain - INFO - Phase 2 epoch 15/15: loss1=0.0129, loss2=0.0145, dev_macro_f1=0.5920, dev_err=26.99%
2026-02-23 12:10:51,676 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 12:10:56,595 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.5845, dev_err=32.58%, es_counter1=0, es_counter2=0
2026-02-23 12:11:00,974 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.5838, dev_err=35.90%, es_counter1=1, es_counter2=1
2026-02-23 12:11:05,381 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.5738, dev_err=31.52%, es_counter1=2, es_counter2=2
2026-02-23 12:11:09,919 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.5681, dev_err=32.58%, es_counter1=3, es_counter2=3
2026-02-23 12:11:14,390 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.5851, dev_err=37.37%, es_counter1=0, es_counter2=0
2026-02-23 12:11:18,961 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.5804, dev_err=35.51%, es_counter1=1, es_counter2=1
2026-02-23 12:11:23,380 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.6038, dev_err=33.38%, es_counter1=0, es_counter2=0
2026-02-23 12:11:27,926 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.5994, dev_err=32.45%, es_counter1=1, es_counter2=1
2026-02-23 12:11:32,381 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.5964, dev_err=34.44%, es_counter1=2, es_counter2=2
2026-02-23 12:11:36,993 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.6151, dev_err=32.71%, es_counter1=0, es_counter2=0
2026-02-23 12:11:41,699 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.6104, dev_err=33.51%, es_counter1=1, es_counter2=1
2026-02-23 12:11:46,140 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.6156, dev_err=33.64%, es_counter1=0, es_counter2=0
2026-02-23 12:11:50,814 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.6235, dev_err=31.65%, es_counter1=0, es_counter2=0
2026-02-23 12:11:55,579 - lg_cotrain - INFO - Phase 3 epoch 14: dev_macro_f1=0.6134, dev_err=31.91%, es_counter1=1, es_counter2=1
2026-02-23 12:12:00,131 - lg_cotrain - INFO - Phase 3 epoch 15: dev_macro_f1=0.6026, dev_err=33.24%, es_counter1=2, es_counter2=2
2026-02-23 12:12:04,645 - lg_cotrain - INFO - Phase 3 epoch 16: dev_macro_f1=0.5976, dev_err=34.04%, es_counter1=3, es_counter2=3
2026-02-23 12:12:09,117 - lg_cotrain - INFO - Phase 3 epoch 17: dev_macro_f1=0.5922, dev_err=34.44%, es_counter1=4, es_counter2=4
2026-02-23 12:12:13,598 - lg_cotrain - INFO - Phase 3 epoch 18: dev_macro_f1=0.5920, dev_err=34.57%, es_counter1=5, es_counter2=5
2026-02-23 12:12:18,032 - lg_cotrain - INFO - Phase 3 epoch 19: dev_macro_f1=0.5988, dev_err=34.04%, es_counter1=6, es_counter2=6
2026-02-23 12:12:18,032 - lg_cotrain - INFO - Early stopping at epoch 19
2026-02-23 12:12:18,042 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 12:12:26,972 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmp59dttm0u\california_wildfires_2018\50_set3\metrics.json
2026-02-23 12:12:26,972 - lg_cotrain - INFO - Test error rate: 32.44%, Test macro-F1: 0.6092, Test ECE: 0.1489
2026-02-23 12:12:26,984 - lg_cotrain - INFO - --- Trial 1/10 done: dev_macro_f1=0.6235 ---
2026-02-23 12:12:26,984 - lg_cotrain - INFO - --- Trial 2/10 ---
2026-02-23 12:12:27,545 - lg_cotrain - INFO - Starting LG-CoTrain: event=california_wildfires_2018, budget=50, seed_set=3
2026-02-23 12:12:27,579 - lg_cotrain - INFO - Detected 10 classes for event california_wildfires_2018: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'missing_or_found_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 12:12:27,589 - lg_cotrain - INFO - D_l1: 250, D_l2: 250, D_LG: 4663
2026-02-23 12:12:27,590 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 12:12:58,478 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1027, mean_prob2=0.1175
2026-02-23 12:13:28,260 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1359, mean_prob2=0.1495
2026-02-23 12:13:57,922 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1726, mean_prob2=0.2174
2026-02-23 12:14:27,788 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.2525, mean_prob2=0.2989
2026-02-23 12:14:57,117 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.3498, mean_prob2=0.3941
2026-02-23 12:15:26,948 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.3907, mean_prob2=0.4663
2026-02-23 12:15:56,581 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.4574, mean_prob2=0.5142
2026-02-23 12:15:56,581 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 12:15:57,662 - lg_cotrain - INFO - LR scheduler: total_steps_1=3136, warmup=398; total_steps_2=3136, warmup=398
2026-02-23 12:15:57,662 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.4574, range=[0.0026, 0.9316]
2026-02-23 12:15:57,662 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.5142, range=[0.0027, 0.9652]
2026-02-23 12:17:10,750 - lg_cotrain - INFO - Phase 2 epoch 1/16: loss1=0.8546, loss2=0.6812, dev_macro_f1=0.4066, dev_err=32.71%
2026-02-23 12:18:23,160 - lg_cotrain - INFO - Phase 2 epoch 2/16: loss1=0.0950, loss2=0.2417, dev_macro_f1=0.4992, dev_err=28.19%
2026-02-23 12:19:35,648 - lg_cotrain - INFO - Phase 2 epoch 3/16: loss1=0.0671, loss2=0.1825, dev_macro_f1=0.5559, dev_err=26.46%
2026-02-23 12:20:48,155 - lg_cotrain - INFO - Phase 2 epoch 4/16: loss1=0.0483, loss2=0.1461, dev_macro_f1=0.5593, dev_err=27.26%
2026-02-23 12:22:00,634 - lg_cotrain - INFO - Phase 2 epoch 5/16: loss1=0.0334, loss2=0.1041, dev_macro_f1=0.6055, dev_err=26.60%
2026-02-23 12:23:13,348 - lg_cotrain - INFO - Phase 2 epoch 6/16: loss1=0.0377, loss2=0.1007, dev_macro_f1=0.5836, dev_err=26.20%
2026-02-23 12:24:25,972 - lg_cotrain - INFO - Phase 2 epoch 7/16: loss1=0.0288, loss2=0.0412, dev_macro_f1=0.5937, dev_err=25.80%
2026-02-23 12:25:38,514 - lg_cotrain - INFO - Phase 2 epoch 8/16: loss1=0.0292, loss2=0.0224, dev_macro_f1=0.6177, dev_err=25.66%
2026-02-23 12:26:51,051 - lg_cotrain - INFO - Phase 2 epoch 9/16: loss1=0.0234, loss2=0.0131, dev_macro_f1=0.6330, dev_err=25.00%
2026-02-23 12:28:03,591 - lg_cotrain - INFO - Phase 2 epoch 10/16: loss1=0.0135, loss2=0.0101, dev_macro_f1=0.6247, dev_err=25.66%
2026-02-23 12:29:16,059 - lg_cotrain - INFO - Phase 2 epoch 11/16: loss1=0.0143, loss2=0.0118, dev_macro_f1=0.6030, dev_err=26.46%
2026-02-23 12:30:28,592 - lg_cotrain - INFO - Phase 2 epoch 12/16: loss1=0.0089, loss2=0.0075, dev_macro_f1=0.6099, dev_err=26.33%
2026-02-23 12:31:41,200 - lg_cotrain - INFO - Phase 2 epoch 13/16: loss1=0.0073, loss2=0.0149, dev_macro_f1=0.6147, dev_err=26.60%
2026-02-23 12:32:54,214 - lg_cotrain - INFO - Phase 2 epoch 14/16: loss1=0.0057, loss2=0.0186, dev_macro_f1=0.6101, dev_err=26.46%
2026-02-23 12:34:06,960 - lg_cotrain - INFO - Phase 2 epoch 15/16: loss1=0.0053, loss2=0.0101, dev_macro_f1=0.6237, dev_err=26.20%
2026-02-23 12:35:19,960 - lg_cotrain - INFO - Phase 2 epoch 16/16: loss1=0.0046, loss2=0.0035, dev_macro_f1=0.6062, dev_err=26.73%
2026-02-23 12:35:19,960 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 12:35:25,562 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.4580, dev_err=52.93%, es_counter1=0, es_counter2=0
2026-02-23 12:35:30,716 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.5842, dev_err=33.64%, es_counter1=0, es_counter2=0
2026-02-23 12:35:35,855 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.6270, dev_err=28.86%, es_counter1=0, es_counter2=0
2026-02-23 12:35:41,102 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.6076, dev_err=30.59%, es_counter1=1, es_counter2=1
2026-02-23 12:35:46,189 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.6358, dev_err=29.12%, es_counter1=0, es_counter2=0
2026-02-23 12:35:51,278 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.6334, dev_err=29.26%, es_counter1=1, es_counter2=1
2026-02-23 12:35:56,117 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.6292, dev_err=29.26%, es_counter1=2, es_counter2=2
2026-02-23 12:36:01,021 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.6304, dev_err=29.39%, es_counter1=3, es_counter2=3
2026-02-23 12:36:05,978 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.6317, dev_err=29.26%, es_counter1=4, es_counter2=4
2026-02-23 12:36:10,931 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.6267, dev_err=29.39%, es_counter1=5, es_counter2=5
2026-02-23 12:36:10,933 - lg_cotrain - INFO - Early stopping at epoch 10
2026-02-23 12:36:10,945 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 12:36:20,545 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmptacwunux\california_wildfires_2018\50_set3\metrics.json
2026-02-23 12:36:20,545 - lg_cotrain - INFO - Test error rate: 28.68%, Test macro-F1: 0.6573, Test ECE: 0.0858
2026-02-23 12:36:20,556 - lg_cotrain - INFO - --- Trial 2/10 done: dev_macro_f1=0.6358 ---
2026-02-23 12:36:20,557 - lg_cotrain - INFO - --- Trial 3/10 ---
2026-02-23 12:36:21,118 - lg_cotrain - INFO - Starting LG-CoTrain: event=california_wildfires_2018, budget=50, seed_set=3
2026-02-23 12:36:21,172 - lg_cotrain - INFO - Detected 10 classes for event california_wildfires_2018: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'missing_or_found_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 12:36:21,178 - lg_cotrain - INFO - D_l1: 250, D_l2: 250, D_LG: 4663
2026-02-23 12:36:21,179 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 12:36:59,033 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1369, mean_prob2=0.1535
2026-02-23 12:37:35,880 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.2381, mean_prob2=0.2056
2026-02-23 12:38:12,674 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.3743, mean_prob2=0.3521
2026-02-23 12:38:49,381 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.4732, mean_prob2=0.4300
2026-02-23 12:39:26,176 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.4882, mean_prob2=0.4345
2026-02-23 12:40:03,080 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.4721, mean_prob2=0.5444
2026-02-23 12:40:39,696 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.3626, mean_prob2=0.4557
2026-02-23 12:40:39,697 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 12:40:40,714 - lg_cotrain - INFO - LR scheduler: total_steps_1=11945, warmup=1807; total_steps_2=11945, warmup=1807
2026-02-23 12:40:40,714 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.3626, range=[0.0003, 0.9911]
2026-02-23 12:40:40,714 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.4557, range=[0.0005, 0.9850]
2026-02-23 12:42:16,528 - lg_cotrain - INFO - Phase 2 epoch 1/15: loss1=0.5457, loss2=0.4381, dev_macro_f1=0.5086, dev_err=33.78%
2026-02-23 12:43:51,808 - lg_cotrain - INFO - Phase 2 epoch 2/15: loss1=0.0720, loss2=0.3156, dev_macro_f1=0.5463, dev_err=29.39%
2026-02-23 12:45:27,195 - lg_cotrain - INFO - Phase 2 epoch 3/15: loss1=0.0879, loss2=0.3382, dev_macro_f1=0.5180, dev_err=30.72%
2026-02-23 12:47:05,886 - lg_cotrain - INFO - Phase 2 epoch 4/15: loss1=0.3431, loss2=0.5708, dev_macro_f1=0.4087, dev_err=35.64%
2026-02-23 12:48:41,665 - lg_cotrain - INFO - Phase 2 epoch 5/15: loss1=0.6714, loss2=0.3777, dev_macro_f1=0.5123, dev_err=29.26%
2026-02-23 12:50:13,195 - lg_cotrain - INFO - Phase 2 epoch 6/15: loss1=0.7105, loss2=0.2432, dev_macro_f1=0.5224, dev_err=39.63%
2026-02-23 12:51:40,969 - lg_cotrain - INFO - Phase 2 epoch 7/15: loss1=0.7060, loss2=0.2673, dev_macro_f1=0.4136, dev_err=35.64%
2026-02-23 12:53:14,207 - lg_cotrain - INFO - Phase 2 epoch 8/15: loss1=0.7226, loss2=0.1735, dev_macro_f1=0.5691, dev_err=27.93%
2026-02-23 12:54:46,756 - lg_cotrain - INFO - Phase 2 epoch 9/15: loss1=0.7615, loss2=0.1331, dev_macro_f1=0.5574, dev_err=28.86%
2026-02-23 12:56:16,230 - lg_cotrain - INFO - Phase 2 epoch 10/15: loss1=0.7960, loss2=0.0853, dev_macro_f1=0.6037, dev_err=28.86%
2026-02-23 12:57:43,876 - lg_cotrain - INFO - Phase 2 epoch 11/15: loss1=0.8265, loss2=0.0790, dev_macro_f1=0.5440, dev_err=30.72%
2026-02-23 12:59:11,098 - lg_cotrain - INFO - Phase 2 epoch 12/15: loss1=0.8572, loss2=0.0636, dev_macro_f1=0.5418, dev_err=30.32%
2026-02-23 13:00:38,092 - lg_cotrain - INFO - Phase 2 epoch 13/15: loss1=0.8858, loss2=0.0515, dev_macro_f1=0.6279, dev_err=27.26%
2026-02-23 13:02:04,713 - lg_cotrain - INFO - Phase 2 epoch 14/15: loss1=0.9145, loss2=0.0333, dev_macro_f1=0.6729, dev_err=26.06%
2026-02-23 13:03:31,408 - lg_cotrain - INFO - Phase 2 epoch 15/15: loss1=0.9385, loss2=0.0271, dev_macro_f1=0.5997, dev_err=29.26%
2026-02-23 13:03:31,408 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 13:03:37,858 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.5674, dev_err=30.98%, es_counter1=0, es_counter2=0
2026-02-23 13:03:44,239 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.5321, dev_err=33.64%, es_counter1=1, es_counter2=1
2026-02-23 13:03:50,622 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.5246, dev_err=37.23%, es_counter1=2, es_counter2=2
2026-02-23 13:03:57,002 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.5641, dev_err=35.37%, es_counter1=3, es_counter2=3
2026-02-23 13:04:03,363 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.5589, dev_err=39.49%, es_counter1=4, es_counter2=4
2026-02-23 13:04:09,809 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.5755, dev_err=34.44%, es_counter1=0, es_counter2=0
2026-02-23 13:04:16,215 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.5793, dev_err=35.24%, es_counter1=0, es_counter2=0
2026-02-23 13:04:22,587 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.5544, dev_err=37.50%, es_counter1=1, es_counter2=1
2026-02-23 13:04:28,959 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.5613, dev_err=37.77%, es_counter1=2, es_counter2=2
2026-02-23 13:04:35,362 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.5828, dev_err=34.97%, es_counter1=0, es_counter2=0
2026-02-23 13:04:41,748 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.5501, dev_err=38.30%, es_counter1=1, es_counter2=1
2026-02-23 13:04:48,160 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.5828, dev_err=35.11%, es_counter1=2, es_counter2=2
2026-02-23 13:04:54,558 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.5807, dev_err=34.71%, es_counter1=3, es_counter2=3
2026-02-23 13:05:00,996 - lg_cotrain - INFO - Phase 3 epoch 14: dev_macro_f1=0.5845, dev_err=35.24%, es_counter1=0, es_counter2=0
2026-02-23 13:05:07,391 - lg_cotrain - INFO - Phase 3 epoch 15: dev_macro_f1=0.5643, dev_err=36.57%, es_counter1=1, es_counter2=1
2026-02-23 13:05:13,791 - lg_cotrain - INFO - Phase 3 epoch 16: dev_macro_f1=0.5774, dev_err=36.17%, es_counter1=2, es_counter2=2
2026-02-23 13:05:20,212 - lg_cotrain - INFO - Phase 3 epoch 17: dev_macro_f1=0.6046, dev_err=33.24%, es_counter1=0, es_counter2=0
2026-02-23 13:05:26,604 - lg_cotrain - INFO - Phase 3 epoch 18: dev_macro_f1=0.5773, dev_err=35.77%, es_counter1=1, es_counter2=1
2026-02-23 13:05:32,976 - lg_cotrain - INFO - Phase 3 epoch 19: dev_macro_f1=0.5680, dev_err=34.71%, es_counter1=2, es_counter2=2
2026-02-23 13:05:39,347 - lg_cotrain - INFO - Phase 3 epoch 20: dev_macro_f1=0.5634, dev_err=36.44%, es_counter1=3, es_counter2=3
2026-02-23 13:05:45,726 - lg_cotrain - INFO - Phase 3 epoch 21: dev_macro_f1=0.5743, dev_err=36.17%, es_counter1=4, es_counter2=4
2026-02-23 13:05:51,951 - lg_cotrain - INFO - Phase 3 epoch 22: dev_macro_f1=0.5737, dev_err=36.17%, es_counter1=5, es_counter2=5
2026-02-23 13:05:51,951 - lg_cotrain - INFO - Early stopping at epoch 22
2026-02-23 13:05:51,963 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 13:05:59,562 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpamgvnpok\california_wildfires_2018\50_set3\metrics.json
2026-02-23 13:05:59,562 - lg_cotrain - INFO - Test error rate: 36.82%, Test macro-F1: 0.5573, Test ECE: 0.1540
2026-02-23 13:05:59,574 - lg_cotrain - INFO - --- Trial 3/10 done: dev_macro_f1=0.6046 ---
2026-02-23 13:05:59,574 - lg_cotrain - INFO - --- Trial 4/10 ---
2026-02-23 13:06:00,138 - lg_cotrain - INFO - Starting LG-CoTrain: event=california_wildfires_2018, budget=50, seed_set=3
2026-02-23 13:06:00,169 - lg_cotrain - INFO - Detected 10 classes for event california_wildfires_2018: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'missing_or_found_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 13:06:00,177 - lg_cotrain - INFO - D_l1: 250, D_l2: 250, D_LG: 4663
2026-02-23 13:06:00,179 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 13:06:20,299 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1018, mean_prob2=0.1278
2026-02-23 13:06:39,097 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1152, mean_prob2=0.1463
2026-02-23 13:06:57,566 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1473, mean_prob2=0.1852
2026-02-23 13:07:16,397 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1894, mean_prob2=0.2295
2026-02-23 13:07:35,380 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.2377, mean_prob2=0.3147
2026-02-23 13:07:54,037 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.3157, mean_prob2=0.3595
2026-02-23 13:08:12,602 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.3878, mean_prob2=0.4243
2026-02-23 13:08:12,602 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 13:08:13,612 - lg_cotrain - INFO - LR scheduler: total_steps_1=3644, warmup=363; total_steps_2=3644, warmup=363
2026-02-23 13:08:13,613 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.3878, range=[0.0052, 0.8844]
2026-02-23 13:08:13,613 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.4243, range=[0.0058, 0.9235]
2026-02-23 13:09:20,698 - lg_cotrain - INFO - Phase 2 epoch 1/7: loss1=0.5912, loss2=0.5041, dev_macro_f1=0.4203, dev_err=31.91%
2026-02-23 13:10:29,767 - lg_cotrain - INFO - Phase 2 epoch 2/7: loss1=0.0870, loss2=0.2246, dev_macro_f1=0.5875, dev_err=26.33%
2026-02-23 13:11:40,569 - lg_cotrain - INFO - Phase 2 epoch 3/7: loss1=0.0483, loss2=0.1461, dev_macro_f1=0.5751, dev_err=27.13%
2026-02-23 13:12:49,471 - lg_cotrain - INFO - Phase 2 epoch 4/7: loss1=0.0352, loss2=0.0963, dev_macro_f1=0.5942, dev_err=26.33%
2026-02-23 13:13:56,780 - lg_cotrain - INFO - Phase 2 epoch 5/7: loss1=0.0213, loss2=0.0532, dev_macro_f1=0.6002, dev_err=27.26%
2026-02-23 13:15:07,323 - lg_cotrain - INFO - Phase 2 epoch 6/7: loss1=0.0180, loss2=0.0406, dev_macro_f1=0.6121, dev_err=25.53%
2026-02-23 13:16:15,039 - lg_cotrain - INFO - Phase 2 epoch 7/7: loss1=0.0149, loss2=0.0302, dev_macro_f1=0.6074, dev_err=26.46%
2026-02-23 13:16:15,039 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 13:16:20,234 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.6225, dev_err=29.12%, es_counter1=0, es_counter2=0
2026-02-23 13:16:25,329 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.5942, dev_err=32.71%, es_counter1=1, es_counter2=1
2026-02-23 13:16:30,401 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.6114, dev_err=31.65%, es_counter1=2, es_counter2=2
2026-02-23 13:16:35,487 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.6200, dev_err=31.52%, es_counter1=3, es_counter2=3
2026-02-23 13:16:40,445 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.6199, dev_err=31.78%, es_counter1=4, es_counter2=4
2026-02-23 13:16:45,480 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.6137, dev_err=32.45%, es_counter1=5, es_counter2=5
2026-02-23 13:16:50,764 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.6209, dev_err=31.65%, es_counter1=6, es_counter2=6
2026-02-23 13:16:50,764 - lg_cotrain - INFO - Early stopping at epoch 7
2026-02-23 13:16:50,774 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 13:16:58,781 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpzfgkfifl\california_wildfires_2018\50_set3\metrics.json
2026-02-23 13:16:58,782 - lg_cotrain - INFO - Test error rate: 27.45%, Test macro-F1: 0.6447, Test ECE: 0.0827
2026-02-23 13:16:58,794 - lg_cotrain - INFO - --- Trial 4/10 done: dev_macro_f1=0.6225 ---
2026-02-23 13:16:58,794 - lg_cotrain - INFO - --- Trial 5/10 ---
2026-02-23 13:16:59,363 - lg_cotrain - INFO - Starting LG-CoTrain: event=california_wildfires_2018, budget=50, seed_set=3
2026-02-23 13:16:59,398 - lg_cotrain - INFO - Detected 10 classes for event california_wildfires_2018: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'missing_or_found_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 13:16:59,405 - lg_cotrain - INFO - D_l1: 250, D_l2: 250, D_LG: 4663
2026-02-23 13:16:59,406 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 13:17:17,522 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1050, mean_prob2=0.1055
2026-02-23 13:17:35,281 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1088, mean_prob2=0.0986
2026-02-23 13:17:52,777 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1589, mean_prob2=0.0983
2026-02-23 13:18:09,730 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1742, mean_prob2=0.2737
2026-02-23 13:18:27,718 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.2870, mean_prob2=0.2978
2026-02-23 13:18:44,489 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.4044, mean_prob2=0.4684
2026-02-23 13:19:01,095 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.4741, mean_prob2=0.4072
2026-02-23 13:19:01,095 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 13:19:02,146 - lg_cotrain - INFO - LR scheduler: total_steps_1=1860, warmup=29; total_steps_2=1860, warmup=29
2026-02-23 13:19:02,147 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.4741, range=[0.0009, 0.9632]
2026-02-23 13:19:02,147 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.4072, range=[0.0010, 0.9679]
2026-02-23 13:19:59,634 - lg_cotrain - INFO - Phase 2 epoch 1/20: loss1=0.4747, loss2=0.4538, dev_macro_f1=0.5066, dev_err=32.18%
2026-02-23 13:20:56,808 - lg_cotrain - INFO - Phase 2 epoch 2/20: loss1=0.1831, loss2=0.3389, dev_macro_f1=0.5061, dev_err=29.92%
2026-02-23 13:21:55,017 - lg_cotrain - INFO - Phase 2 epoch 3/20: loss1=0.5003, loss2=0.2466, dev_macro_f1=0.4698, dev_err=31.25%
2026-02-23 13:22:52,331 - lg_cotrain - INFO - Phase 2 epoch 4/20: loss1=0.7735, loss2=0.2123, dev_macro_f1=0.5259, dev_err=33.11%
2026-02-23 13:23:54,348 - lg_cotrain - INFO - Phase 2 epoch 5/20: loss1=0.8285, loss2=0.2163, dev_macro_f1=0.5355, dev_err=31.65%
2026-02-23 13:24:50,344 - lg_cotrain - INFO - Phase 2 epoch 6/20: loss1=0.8575, loss2=0.1605, dev_macro_f1=0.5344, dev_err=29.26%
2026-02-23 13:25:47,652 - lg_cotrain - INFO - Phase 2 epoch 7/20: loss1=0.8919, loss2=0.1230, dev_macro_f1=0.5430, dev_err=29.65%
2026-02-23 13:26:44,921 - lg_cotrain - INFO - Phase 2 epoch 8/20: loss1=0.9282, loss2=0.0723, dev_macro_f1=0.5711, dev_err=28.19%
2026-02-23 13:27:47,349 - lg_cotrain - INFO - Phase 2 epoch 9/20: loss1=0.9621, loss2=0.0552, dev_macro_f1=0.6041, dev_err=28.32%
2026-02-23 13:28:51,465 - lg_cotrain - INFO - Phase 2 epoch 10/20: loss1=0.9887, loss2=0.0427, dev_macro_f1=0.5533, dev_err=29.65%
2026-02-23 13:29:50,305 - lg_cotrain - INFO - Phase 2 epoch 11/20: loss1=1.0125, loss2=0.0362, dev_macro_f1=0.5730, dev_err=29.39%
2026-02-23 13:30:45,811 - lg_cotrain - INFO - Phase 2 epoch 12/20: loss1=1.0465, loss2=0.0247, dev_macro_f1=0.5750, dev_err=28.19%
2026-02-23 13:31:41,459 - lg_cotrain - INFO - Phase 2 epoch 13/20: loss1=1.0724, loss2=0.0171, dev_macro_f1=0.5925, dev_err=28.86%
2026-02-23 13:32:36,773 - lg_cotrain - INFO - Phase 2 epoch 14/20: loss1=1.0922, loss2=0.0145, dev_macro_f1=0.5954, dev_err=28.86%
2026-02-23 13:33:34,593 - lg_cotrain - INFO - Phase 2 epoch 15/20: loss1=1.1157, loss2=0.0166, dev_macro_f1=0.6143, dev_err=26.99%
2026-02-23 13:34:31,478 - lg_cotrain - INFO - Phase 2 epoch 16/20: loss1=1.1336, loss2=0.0118, dev_macro_f1=0.6081, dev_err=28.06%
2026-02-23 13:35:26,748 - lg_cotrain - INFO - Phase 2 epoch 17/20: loss1=1.1508, loss2=0.0095, dev_macro_f1=0.6005, dev_err=28.72%
2026-02-23 13:36:22,832 - lg_cotrain - INFO - Phase 2 epoch 18/20: loss1=1.1701, loss2=0.0091, dev_macro_f1=0.6022, dev_err=27.79%
2026-02-23 13:37:20,613 - lg_cotrain - INFO - Phase 2 epoch 19/20: loss1=1.1868, loss2=0.0083, dev_macro_f1=0.5931, dev_err=29.12%
2026-02-23 13:38:15,001 - lg_cotrain - INFO - Phase 2 epoch 20/20: loss1=1.2049, loss2=0.0068, dev_macro_f1=0.5981, dev_err=28.86%
2026-02-23 13:38:15,001 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 13:38:19,155 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.5347, dev_err=39.36%, es_counter1=0, es_counter2=0
2026-02-23 13:38:23,267 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.5162, dev_err=39.89%, es_counter1=1, es_counter2=1
2026-02-23 13:38:27,413 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.5287, dev_err=38.16%, es_counter1=2, es_counter2=2
2026-02-23 13:38:31,576 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.5623, dev_err=35.90%, es_counter1=0, es_counter2=0
2026-02-23 13:38:35,867 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.5531, dev_err=35.37%, es_counter1=1, es_counter2=1
2026-02-23 13:38:40,177 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.5513, dev_err=36.17%, es_counter1=2, es_counter2=2
2026-02-23 13:38:44,558 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.5342, dev_err=40.03%, es_counter1=3, es_counter2=3
2026-02-23 13:38:48,763 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.5138, dev_err=40.56%, es_counter1=4, es_counter2=4
2026-02-23 13:38:52,918 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.5343, dev_err=37.90%, es_counter1=5, es_counter2=5
2026-02-23 13:38:57,054 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.5293, dev_err=40.69%, es_counter1=6, es_counter2=6
2026-02-23 13:39:01,231 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.5451, dev_err=37.37%, es_counter1=7, es_counter2=7
2026-02-23 13:39:05,376 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.5328, dev_err=35.24%, es_counter1=8, es_counter2=8
2026-02-23 13:39:09,534 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.5279, dev_err=37.77%, es_counter1=9, es_counter2=9
2026-02-23 13:39:13,691 - lg_cotrain - INFO - Phase 3 epoch 14: dev_macro_f1=0.5416, dev_err=38.03%, es_counter1=10, es_counter2=10
2026-02-23 13:39:13,691 - lg_cotrain - INFO - Early stopping at epoch 14
2026-02-23 13:39:13,700 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 13:39:19,988 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpmhek7v86\california_wildfires_2018\50_set3\metrics.json
2026-02-23 13:39:19,989 - lg_cotrain - INFO - Test error rate: 33.33%, Test macro-F1: 0.5744, Test ECE: 0.2290
2026-02-23 13:39:19,999 - lg_cotrain - INFO - --- Trial 5/10 done: dev_macro_f1=0.5623 ---
2026-02-23 13:39:19,999 - lg_cotrain - INFO - --- Trial 6/10 ---
2026-02-23 13:39:20,546 - lg_cotrain - INFO - Starting LG-CoTrain: event=california_wildfires_2018, budget=50, seed_set=3
2026-02-23 13:39:20,581 - lg_cotrain - INFO - Detected 10 classes for event california_wildfires_2018: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'missing_or_found_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 13:39:20,587 - lg_cotrain - INFO - D_l1: 250, D_l2: 250, D_LG: 4663
2026-02-23 13:39:20,588 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 13:39:42,290 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1128, mean_prob2=0.1231
2026-02-23 13:40:03,017 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1479, mean_prob2=0.1529
2026-02-23 13:40:24,633 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1984, mean_prob2=0.1928
2026-02-23 13:40:45,225 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.2710, mean_prob2=0.2596
2026-02-23 13:41:06,028 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.3148, mean_prob2=0.3290
2026-02-23 13:41:26,374 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.4140, mean_prob2=0.4131
2026-02-23 13:41:46,860 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.4535, mean_prob2=0.4511
2026-02-23 13:41:46,861 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 13:41:47,997 - lg_cotrain - INFO - LR scheduler: total_steps_1=12528, warmup=2162; total_steps_2=12528, warmup=2162
2026-02-23 13:41:47,997 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.4535, range=[0.0030, 0.9330]
2026-02-23 13:41:47,997 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.4511, range=[0.0041, 0.9305]
2026-02-23 13:43:09,105 - lg_cotrain - INFO - Phase 2 epoch 1/16: loss1=0.8122, loss2=0.7698, dev_macro_f1=0.3285, dev_err=36.30%
2026-02-23 13:44:30,400 - lg_cotrain - INFO - Phase 2 epoch 2/16: loss1=0.1131, loss2=0.2991, dev_macro_f1=0.4860, dev_err=28.32%
2026-02-23 13:45:49,983 - lg_cotrain - INFO - Phase 2 epoch 3/16: loss1=0.0668, loss2=0.1623, dev_macro_f1=0.5586, dev_err=26.06%
2026-02-23 13:47:17,135 - lg_cotrain - INFO - Phase 2 epoch 4/16: loss1=0.0531, loss2=0.1367, dev_macro_f1=0.6061, dev_err=24.87%
2026-02-23 13:48:41,475 - lg_cotrain - INFO - Phase 2 epoch 5/16: loss1=0.0418, loss2=0.1002, dev_macro_f1=0.6057, dev_err=25.66%
2026-02-23 13:50:03,274 - lg_cotrain - INFO - Phase 2 epoch 6/16: loss1=0.0362, loss2=0.0614, dev_macro_f1=0.6164, dev_err=26.46%
2026-02-23 13:51:21,546 - lg_cotrain - INFO - Phase 2 epoch 7/16: loss1=0.0246, loss2=0.0546, dev_macro_f1=0.5910, dev_err=25.93%
2026-02-23 13:52:44,166 - lg_cotrain - INFO - Phase 2 epoch 8/16: loss1=0.0163, loss2=0.0382, dev_macro_f1=0.6195, dev_err=25.80%
2026-02-23 13:54:07,859 - lg_cotrain - INFO - Phase 2 epoch 9/16: loss1=0.0129, loss2=0.0266, dev_macro_f1=0.6247, dev_err=25.27%
2026-02-23 13:55:32,442 - lg_cotrain - INFO - Phase 2 epoch 10/16: loss1=0.0221, loss2=0.0211, dev_macro_f1=0.6221, dev_err=25.13%
2026-02-23 13:56:53,079 - lg_cotrain - INFO - Phase 2 epoch 11/16: loss1=0.0121, loss2=0.0236, dev_macro_f1=0.6119, dev_err=25.80%
2026-02-23 13:58:11,709 - lg_cotrain - INFO - Phase 2 epoch 12/16: loss1=0.0091, loss2=0.0150, dev_macro_f1=0.5996, dev_err=26.33%
2026-02-23 13:59:32,142 - lg_cotrain - INFO - Phase 2 epoch 13/16: loss1=0.0102, loss2=0.0068, dev_macro_f1=0.6142, dev_err=25.80%
2026-02-23 14:00:51,731 - lg_cotrain - INFO - Phase 2 epoch 14/16: loss1=0.0102, loss2=0.0046, dev_macro_f1=0.6170, dev_err=25.80%
2026-02-23 14:02:09,715 - lg_cotrain - INFO - Phase 2 epoch 15/16: loss1=0.0100, loss2=0.0097, dev_macro_f1=0.6037, dev_err=26.86%
2026-02-23 14:03:30,024 - lg_cotrain - INFO - Phase 2 epoch 16/16: loss1=0.0050, loss2=0.0048, dev_macro_f1=0.5971, dev_err=27.39%
2026-02-23 14:03:30,024 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 14:03:35,827 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.5375, dev_err=39.23%, es_counter1=0, es_counter2=0
2026-02-23 14:03:41,636 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.5974, dev_err=31.91%, es_counter1=0, es_counter2=0
2026-02-23 14:03:47,459 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.5921, dev_err=31.78%, es_counter1=1, es_counter2=1
2026-02-23 14:03:53,280 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.5866, dev_err=32.98%, es_counter1=2, es_counter2=2
2026-02-23 14:03:59,652 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.6158, dev_err=31.25%, es_counter1=0, es_counter2=0
2026-02-23 14:04:05,610 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.5958, dev_err=32.18%, es_counter1=1, es_counter2=1
2026-02-23 14:04:11,354 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.6136, dev_err=31.12%, es_counter1=2, es_counter2=2
2026-02-23 14:04:17,099 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.6143, dev_err=30.98%, es_counter1=3, es_counter2=3
2026-02-23 14:04:22,822 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.6079, dev_err=31.78%, es_counter1=4, es_counter2=4
2026-02-23 14:04:28,547 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.6054, dev_err=31.52%, es_counter1=5, es_counter2=5
2026-02-23 14:04:34,271 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.6045, dev_err=31.65%, es_counter1=6, es_counter2=6
2026-02-23 14:04:40,009 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.6028, dev_err=31.78%, es_counter1=7, es_counter2=7
2026-02-23 14:04:45,936 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.6046, dev_err=31.52%, es_counter1=8, es_counter2=8
2026-02-23 14:04:45,936 - lg_cotrain - INFO - Early stopping at epoch 13
2026-02-23 14:04:45,945 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 14:04:53,745 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmp_fzz4w0e\california_wildfires_2018\50_set3\metrics.json
2026-02-23 14:04:53,745 - lg_cotrain - INFO - Test error rate: 28.27%, Test macro-F1: 0.6533, Test ECE: 0.1250
2026-02-23 14:04:53,757 - lg_cotrain - INFO - --- Trial 6/10 done: dev_macro_f1=0.6158 ---
2026-02-23 14:04:53,757 - lg_cotrain - INFO - --- Trial 7/10 ---
2026-02-23 14:04:54,328 - lg_cotrain - INFO - Starting LG-CoTrain: event=california_wildfires_2018, budget=50, seed_set=3
2026-02-23 14:04:54,362 - lg_cotrain - INFO - Detected 10 classes for event california_wildfires_2018: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'missing_or_found_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 14:04:54,368 - lg_cotrain - INFO - D_l1: 250, D_l2: 250, D_LG: 4663
2026-02-23 14:04:54,369 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 14:05:14,017 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1047, mean_prob2=0.0944
2026-02-23 14:05:32,799 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1026, mean_prob2=0.0953
2026-02-23 14:05:51,389 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1075, mean_prob2=0.1078
2026-02-23 14:06:10,230 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1009, mean_prob2=0.1002
2026-02-23 14:06:28,913 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1034, mean_prob2=0.0999
2026-02-23 14:06:47,909 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1059, mean_prob2=0.0967
2026-02-23 14:07:07,641 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.0994, mean_prob2=0.1006
2026-02-23 14:07:07,641 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 14:07:08,690 - lg_cotrain - INFO - LR scheduler: total_steps_1=3352, warmup=563; total_steps_2=3352, warmup=563
2026-02-23 14:07:08,690 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.0994, range=[0.0813, 0.1161]
2026-02-23 14:07:08,690 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1006, range=[0.0873, 0.1152]
2026-02-23 14:08:17,045 - lg_cotrain - INFO - Phase 2 epoch 1/6: loss1=0.1198, loss2=0.1180, dev_macro_f1=0.4854, dev_err=30.72%
2026-02-23 14:09:26,663 - lg_cotrain - INFO - Phase 2 epoch 2/6: loss1=0.1055, loss2=1.1880, dev_macro_f1=0.0419, dev_err=73.54%
2026-02-23 14:10:40,533 - lg_cotrain - INFO - Phase 2 epoch 3/6: loss1=0.0778, loss2=1.0160, dev_macro_f1=0.0419, dev_err=73.54%
2026-02-23 14:11:48,227 - lg_cotrain - INFO - Phase 2 epoch 4/6: loss1=0.0583, loss2=0.9109, dev_macro_f1=0.0419, dev_err=73.54%
2026-02-23 14:12:56,513 - lg_cotrain - INFO - Phase 2 epoch 5/6: loss1=0.0564, loss2=0.8488, dev_macro_f1=0.0419, dev_err=73.54%
2026-02-23 14:14:03,906 - lg_cotrain - INFO - Phase 2 epoch 6/6: loss1=0.0593, loss2=0.8001, dev_macro_f1=0.0419, dev_err=73.54%
2026-02-23 14:14:03,906 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 14:14:09,376 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.0419, dev_err=73.54%, es_counter1=0, es_counter2=0
2026-02-23 14:14:14,839 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.0247, dev_err=85.90%, es_counter1=1, es_counter2=1
2026-02-23 14:14:20,253 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.0120, dev_err=93.62%, es_counter1=2, es_counter2=2
2026-02-23 14:14:25,336 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.0021, dev_err=98.94%, es_counter1=3, es_counter2=3
2026-02-23 14:14:30,287 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.0047, dev_err=97.61%, es_counter1=4, es_counter2=4
2026-02-23 14:14:35,250 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.0037, dev_err=98.14%, es_counter1=5, es_counter2=5
2026-02-23 14:14:35,250 - lg_cotrain - INFO - Early stopping at epoch 6
2026-02-23 14:14:35,262 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 14:14:42,353 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmplf0_wyr2\california_wildfires_2018\50_set3\metrics.json
2026-02-23 14:14:42,354 - lg_cotrain - INFO - Test error rate: 73.65%, Test macro-F1: 0.0417, Test ECE: 0.1003
2026-02-23 14:14:42,366 - lg_cotrain - INFO - --- Trial 7/10 done: dev_macro_f1=0.0419 ---
2026-02-23 14:14:42,366 - lg_cotrain - INFO - --- Trial 8/10 ---
2026-02-23 14:14:42,949 - lg_cotrain - INFO - Starting LG-CoTrain: event=california_wildfires_2018, budget=50, seed_set=3
2026-02-23 14:14:42,990 - lg_cotrain - INFO - Detected 10 classes for event california_wildfires_2018: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'missing_or_found_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 14:14:42,998 - lg_cotrain - INFO - D_l1: 250, D_l2: 250, D_LG: 4663
2026-02-23 14:14:42,999 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 14:15:04,679 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1151, mean_prob2=0.1449
2026-02-23 14:15:26,626 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.2415, mean_prob2=0.2128
2026-02-23 14:15:46,931 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.4431, mean_prob2=0.3490
2026-02-23 14:16:07,682 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.4914, mean_prob2=0.5027
2026-02-23 14:16:28,078 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.5761, mean_prob2=0.5020
2026-02-23 14:16:48,972 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.5405, mean_prob2=0.5444
2026-02-23 14:17:10,128 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.5263, mean_prob2=0.5664
2026-02-23 14:17:10,129 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 14:17:11,180 - lg_cotrain - INFO - LR scheduler: total_steps_1=6698, warmup=954; total_steps_2=6698, warmup=954
2026-02-23 14:17:11,180 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.5263, range=[0.0003, 0.9851]
2026-02-23 14:17:11,180 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.5664, range=[0.0007, 0.9853]
2026-02-23 14:18:31,219 - lg_cotrain - INFO - Phase 2 epoch 1/6: loss1=0.6250, loss2=0.5656, dev_macro_f1=0.5107, dev_err=34.04%
2026-02-23 14:19:53,583 - lg_cotrain - INFO - Phase 2 epoch 2/6: loss1=0.1192, loss2=0.3245, dev_macro_f1=0.5532, dev_err=30.19%
2026-02-23 14:21:18,276 - lg_cotrain - INFO - Phase 2 epoch 3/6: loss1=0.0725, loss2=0.2108, dev_macro_f1=0.5957, dev_err=26.73%
2026-02-23 14:22:38,498 - lg_cotrain - INFO - Phase 2 epoch 4/6: loss1=0.0471, loss2=0.1575, dev_macro_f1=0.5822, dev_err=28.19%
2026-02-23 14:24:00,594 - lg_cotrain - INFO - Phase 2 epoch 5/6: loss1=0.0521, loss2=0.0854, dev_macro_f1=0.6087, dev_err=26.20%
2026-02-23 14:25:26,081 - lg_cotrain - INFO - Phase 2 epoch 6/6: loss1=0.0335, loss2=0.0561, dev_macro_f1=0.5956, dev_err=26.60%
2026-02-23 14:25:26,081 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 14:25:32,615 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.6248, dev_err=28.86%, es_counter1=0, es_counter2=0
2026-02-23 14:25:39,431 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.6517, dev_err=26.33%, es_counter1=0, es_counter2=0
2026-02-23 14:25:45,651 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.6055, dev_err=33.11%, es_counter1=1, es_counter2=1
2026-02-23 14:25:52,316 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.6427, dev_err=28.19%, es_counter1=2, es_counter2=2
2026-02-23 14:25:58,138 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.6432, dev_err=28.72%, es_counter1=3, es_counter2=3
2026-02-23 14:26:04,964 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.6450, dev_err=28.19%, es_counter1=4, es_counter2=4
2026-02-23 14:26:11,115 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.6457, dev_err=27.93%, es_counter1=5, es_counter2=5
2026-02-23 14:26:17,037 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.6499, dev_err=27.93%, es_counter1=6, es_counter2=6
2026-02-23 14:26:17,037 - lg_cotrain - INFO - Early stopping at epoch 8
2026-02-23 14:26:17,049 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 14:26:25,059 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpk39mgqsj\california_wildfires_2018\50_set3\metrics.json
2026-02-23 14:26:25,059 - lg_cotrain - INFO - Test error rate: 27.38%, Test macro-F1: 0.6630, Test ECE: 0.0475
2026-02-23 14:26:25,069 - lg_cotrain - INFO - --- Trial 8/10 done: dev_macro_f1=0.6517 ---
2026-02-23 14:26:25,069 - lg_cotrain - INFO - --- Trial 9/10 ---
2026-02-23 14:26:25,688 - lg_cotrain - INFO - Starting LG-CoTrain: event=california_wildfires_2018, budget=50, seed_set=3
2026-02-23 14:26:25,730 - lg_cotrain - INFO - Detected 10 classes for event california_wildfires_2018: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'missing_or_found_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 14:26:25,742 - lg_cotrain - INFO - D_l1: 250, D_l2: 250, D_LG: 4663
2026-02-23 14:26:25,744 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 14:26:44,202 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1073, mean_prob2=0.1273
2026-02-23 14:27:02,759 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1052, mean_prob2=0.1305
2026-02-23 14:27:20,988 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1457, mean_prob2=0.1524
2026-02-23 14:27:39,277 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1845, mean_prob2=0.1877
2026-02-23 14:27:57,016 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.2184, mean_prob2=0.2372
2026-02-23 14:28:14,658 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.2673, mean_prob2=0.2625
2026-02-23 14:28:32,179 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.2906, mean_prob2=0.3433
2026-02-23 14:28:32,179 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 14:28:33,215 - lg_cotrain - INFO - LR scheduler: total_steps_1=3574, warmup=394; total_steps_2=3574, warmup=394
2026-02-23 14:28:33,215 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.2906, range=[0.0085, 0.7922]
2026-02-23 14:28:33,215 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.3433, range=[0.0081, 0.8671]
2026-02-23 14:29:40,460 - lg_cotrain - INFO - Phase 2 epoch 1/19: loss1=0.5984, loss2=0.4960, dev_macro_f1=0.3178, dev_err=36.57%
2026-02-23 14:30:43,563 - lg_cotrain - INFO - Phase 2 epoch 2/19: loss1=0.1057, loss2=0.2322, dev_macro_f1=0.4318, dev_err=30.05%
2026-02-23 14:31:47,780 - lg_cotrain - INFO - Phase 2 epoch 3/19: loss1=0.0563, loss2=0.1498, dev_macro_f1=0.4895, dev_err=28.59%
2026-02-23 14:32:53,966 - lg_cotrain - INFO - Phase 2 epoch 4/19: loss1=0.0411, loss2=0.1258, dev_macro_f1=0.5287, dev_err=29.26%
2026-02-23 14:34:04,834 - lg_cotrain - INFO - Phase 2 epoch 5/19: loss1=0.0284, loss2=0.0856, dev_macro_f1=0.6098, dev_err=26.73%
2026-02-23 14:35:10,689 - lg_cotrain - INFO - Phase 2 epoch 6/19: loss1=0.0297, loss2=0.0642, dev_macro_f1=0.5855, dev_err=26.99%
2026-02-23 14:36:09,986 - lg_cotrain - INFO - Phase 2 epoch 7/19: loss1=0.0238, loss2=0.0391, dev_macro_f1=0.6150, dev_err=25.80%
2026-02-23 14:37:11,896 - lg_cotrain - INFO - Phase 2 epoch 8/19: loss1=0.0181, loss2=0.0231, dev_macro_f1=0.6219, dev_err=25.13%
2026-02-23 14:38:11,297 - lg_cotrain - INFO - Phase 2 epoch 9/19: loss1=0.0107, loss2=0.0280, dev_macro_f1=0.6160, dev_err=25.40%
2026-02-23 14:39:11,617 - lg_cotrain - INFO - Phase 2 epoch 10/19: loss1=0.0165, loss2=0.0207, dev_macro_f1=0.6272, dev_err=25.13%
2026-02-23 14:40:14,751 - lg_cotrain - INFO - Phase 2 epoch 11/19: loss1=0.0157, loss2=0.0217, dev_macro_f1=0.6163, dev_err=25.66%
2026-02-23 14:41:14,656 - lg_cotrain - INFO - Phase 2 epoch 12/19: loss1=0.0168, loss2=0.0149, dev_macro_f1=0.5980, dev_err=26.73%
2026-02-23 14:42:22,443 - lg_cotrain - INFO - Phase 2 epoch 13/19: loss1=0.0111, loss2=0.0081, dev_macro_f1=0.6023, dev_err=26.86%
2026-02-23 14:43:32,780 - lg_cotrain - INFO - Phase 2 epoch 14/19: loss1=0.0113, loss2=0.0043, dev_macro_f1=0.6119, dev_err=26.20%
2026-02-23 14:44:42,319 - lg_cotrain - INFO - Phase 2 epoch 15/19: loss1=0.0142, loss2=0.0034, dev_macro_f1=0.6199, dev_err=25.66%
2026-02-23 14:45:52,505 - lg_cotrain - INFO - Phase 2 epoch 16/19: loss1=0.0115, loss2=0.0029, dev_macro_f1=0.6084, dev_err=26.46%
2026-02-23 14:47:01,456 - lg_cotrain - INFO - Phase 2 epoch 17/19: loss1=0.0083, loss2=0.0025, dev_macro_f1=0.6077, dev_err=26.60%
2026-02-23 14:48:00,813 - lg_cotrain - INFO - Phase 2 epoch 18/19: loss1=0.0089, loss2=0.0038, dev_macro_f1=0.6154, dev_err=25.80%
2026-02-23 14:49:01,351 - lg_cotrain - INFO - Phase 2 epoch 19/19: loss1=0.0072, loss2=0.0024, dev_macro_f1=0.6135, dev_err=26.33%
2026-02-23 14:49:01,351 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 14:49:05,802 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.5096, dev_err=45.35%, es_counter1=0, es_counter2=0
2026-02-23 14:49:10,302 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.5842, dev_err=38.30%, es_counter1=0, es_counter2=0
2026-02-23 14:49:14,881 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.6173, dev_err=30.05%, es_counter1=0, es_counter2=0
2026-02-23 14:49:19,349 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.6339, dev_err=29.26%, es_counter1=0, es_counter2=0
2026-02-23 14:49:23,812 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.6310, dev_err=30.05%, es_counter1=1, es_counter2=1
2026-02-23 14:49:28,461 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.6346, dev_err=30.32%, es_counter1=0, es_counter2=0
2026-02-23 14:49:32,950 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.6294, dev_err=30.19%, es_counter1=1, es_counter2=1
2026-02-23 14:49:37,401 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.6267, dev_err=30.59%, es_counter1=2, es_counter2=2
2026-02-23 14:49:41,921 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.6259, dev_err=30.59%, es_counter1=3, es_counter2=3
2026-02-23 14:49:46,772 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.6278, dev_err=30.45%, es_counter1=4, es_counter2=4
2026-02-23 14:49:51,868 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.6262, dev_err=30.72%, es_counter1=5, es_counter2=5
2026-02-23 14:49:51,868 - lg_cotrain - INFO - Early stopping at epoch 11
2026-02-23 14:49:51,877 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 14:49:58,605 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpvxo90_1l\california_wildfires_2018\50_set3\metrics.json
2026-02-23 14:49:58,605 - lg_cotrain - INFO - Test error rate: 28.27%, Test macro-F1: 0.6506, Test ECE: 0.0935
2026-02-23 14:49:58,616 - lg_cotrain - INFO - --- Trial 9/10 done: dev_macro_f1=0.6346 ---
2026-02-23 14:49:58,616 - lg_cotrain - INFO - --- Trial 10/10 ---
2026-02-23 14:49:59,209 - lg_cotrain - INFO - Starting LG-CoTrain: event=california_wildfires_2018, budget=50, seed_set=3
2026-02-23 14:49:59,253 - lg_cotrain - INFO - Detected 10 classes for event california_wildfires_2018: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'missing_or_found_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-23 14:49:59,262 - lg_cotrain - INFO - D_l1: 250, D_l2: 250, D_LG: 4663
2026-02-23 14:49:59,265 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-23 14:50:17,068 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1086, mean_prob2=0.1301
2026-02-23 14:50:34,327 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1157, mean_prob2=0.1296
2026-02-23 14:50:51,309 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1350, mean_prob2=0.1499
2026-02-23 14:51:09,647 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1666, mean_prob2=0.1787
2026-02-23 14:51:26,855 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1815, mean_prob2=0.2067
2026-02-23 14:51:45,890 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.2173, mean_prob2=0.2372
2026-02-23 14:52:03,101 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.2721, mean_prob2=0.2912
2026-02-23 14:52:03,101 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-23 14:52:04,132 - lg_cotrain - INFO - LR scheduler: total_steps_1=3720, warmup=467; total_steps_2=3720, warmup=467
2026-02-23 14:52:04,132 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.2721, range=[0.0133, 0.7082]
2026-02-23 14:52:04,134 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.2912, range=[0.0112, 0.7608]
2026-02-23 14:53:03,071 - lg_cotrain - INFO - Phase 2 epoch 1/20: loss1=0.5437, loss2=0.4920, dev_macro_f1=0.2737, dev_err=39.10%
2026-02-23 14:54:04,441 - lg_cotrain - INFO - Phase 2 epoch 2/20: loss1=0.1118, loss2=0.2397, dev_macro_f1=0.4267, dev_err=30.98%
2026-02-23 14:55:03,800 - lg_cotrain - INFO - Phase 2 epoch 3/20: loss1=0.0601, loss2=0.1545, dev_macro_f1=0.4866, dev_err=28.59%
2026-02-23 14:56:04,621 - lg_cotrain - INFO - Phase 2 epoch 4/20: loss1=0.0398, loss2=0.1316, dev_macro_f1=0.5406, dev_err=27.53%
2026-02-23 14:57:04,749 - lg_cotrain - INFO - Phase 2 epoch 5/20: loss1=0.0291, loss2=0.0852, dev_macro_f1=0.5984, dev_err=25.27%
2026-02-23 14:58:04,189 - lg_cotrain - INFO - Phase 2 epoch 6/20: loss1=0.0204, loss2=0.0529, dev_macro_f1=0.5740, dev_err=26.06%
2026-02-23 14:59:03,276 - lg_cotrain - INFO - Phase 2 epoch 7/20: loss1=0.0210, loss2=0.0360, dev_macro_f1=0.5997, dev_err=25.27%
2026-02-23 15:00:02,380 - lg_cotrain - INFO - Phase 2 epoch 8/20: loss1=0.0208, loss2=0.0275, dev_macro_f1=0.6039, dev_err=25.40%
2026-02-23 15:01:02,008 - lg_cotrain - INFO - Phase 2 epoch 9/20: loss1=0.0153, loss2=0.0318, dev_macro_f1=0.6242, dev_err=24.07%
2026-02-23 15:02:01,236 - lg_cotrain - INFO - Phase 2 epoch 10/20: loss1=0.0137, loss2=0.0185, dev_macro_f1=0.6182, dev_err=25.27%
2026-02-23 15:03:00,103 - lg_cotrain - INFO - Phase 2 epoch 11/20: loss1=0.0135, loss2=0.0122, dev_macro_f1=0.6098, dev_err=26.20%
2026-02-23 15:03:59,597 - lg_cotrain - INFO - Phase 2 epoch 12/20: loss1=0.0218, loss2=0.0241, dev_macro_f1=0.6153, dev_err=25.00%
2026-02-23 15:05:00,236 - lg_cotrain - INFO - Phase 2 epoch 13/20: loss1=0.0208, loss2=0.0245, dev_macro_f1=0.5990, dev_err=26.60%
2026-02-23 15:06:02,769 - lg_cotrain - INFO - Phase 2 epoch 14/20: loss1=0.0122, loss2=0.0102, dev_macro_f1=0.6048, dev_err=26.73%
2026-02-23 15:07:05,394 - lg_cotrain - INFO - Phase 2 epoch 15/20: loss1=0.0106, loss2=0.0050, dev_macro_f1=0.6073, dev_err=26.46%
2026-02-23 15:08:10,472 - lg_cotrain - INFO - Phase 2 epoch 16/20: loss1=0.0075, loss2=0.0037, dev_macro_f1=0.6032, dev_err=26.99%
2026-02-23 15:09:12,228 - lg_cotrain - INFO - Phase 2 epoch 17/20: loss1=0.0060, loss2=0.0036, dev_macro_f1=0.5964, dev_err=27.26%
2026-02-23 15:10:11,644 - lg_cotrain - INFO - Phase 2 epoch 18/20: loss1=0.0054, loss2=0.0029, dev_macro_f1=0.6022, dev_err=26.86%
2026-02-23 15:11:11,450 - lg_cotrain - INFO - Phase 2 epoch 19/20: loss1=0.0066, loss2=0.0041, dev_macro_f1=0.5998, dev_err=26.99%
2026-02-23 15:12:13,249 - lg_cotrain - INFO - Phase 2 epoch 20/20: loss1=0.0062, loss2=0.0026, dev_macro_f1=0.6032, dev_err=26.86%
2026-02-23 15:12:13,249 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-23 15:12:18,253 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.5469, dev_err=36.70%, es_counter1=0, es_counter2=0
2026-02-23 15:12:23,221 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.5885, dev_err=34.71%, es_counter1=0, es_counter2=0
2026-02-23 15:12:28,181 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.6052, dev_err=29.65%, es_counter1=0, es_counter2=0
2026-02-23 15:12:33,167 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.6165, dev_err=29.26%, es_counter1=0, es_counter2=0
2026-02-23 15:12:38,154 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.6363, dev_err=29.12%, es_counter1=0, es_counter2=0
2026-02-23 15:12:43,116 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.6315, dev_err=30.05%, es_counter1=1, es_counter2=1
2026-02-23 15:12:48,076 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.6316, dev_err=30.32%, es_counter1=2, es_counter2=2
2026-02-23 15:12:53,050 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.6382, dev_err=29.52%, es_counter1=0, es_counter2=0
2026-02-23 15:12:57,992 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.6286, dev_err=29.92%, es_counter1=1, es_counter2=1
2026-02-23 15:13:02,922 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.6323, dev_err=29.65%, es_counter1=2, es_counter2=2
2026-02-23 15:13:07,867 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.6318, dev_err=29.65%, es_counter1=3, es_counter2=3
2026-02-23 15:13:12,817 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.6318, dev_err=29.65%, es_counter1=4, es_counter2=4
2026-02-23 15:13:17,757 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.6303, dev_err=29.92%, es_counter1=5, es_counter2=5
2026-02-23 15:13:17,757 - lg_cotrain - INFO - Early stopping at epoch 13
2026-02-23 15:13:17,770 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-23 15:13:25,052 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpg309sqnq\california_wildfires_2018\50_set3\metrics.json
2026-02-23 15:13:25,052 - lg_cotrain - INFO - Test error rate: 27.79%, Test macro-F1: 0.6534, Test ECE: 0.1213
2026-02-23 15:13:25,065 - lg_cotrain - INFO - --- Trial 10/10 done: dev_macro_f1=0.6382 ---
