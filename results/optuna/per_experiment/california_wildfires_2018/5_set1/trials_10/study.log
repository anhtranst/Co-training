2026-02-21 21:00:13,352 - lg_cotrain - INFO - === Optuna study: california_wildfires_2018 budget=5 seed=1 | target=10 trials, 0 replayed, 10 new ===
2026-02-21 21:00:13,353 - lg_cotrain - INFO - --- Trial 1/10 ---
2026-02-21 21:00:35,554 - lg_cotrain - INFO - Starting LG-CoTrain: event=california_wildfires_2018, budget=5, seed_set=1
2026-02-21 21:00:35,594 - lg_cotrain - INFO - Detected 10 classes for event california_wildfires_2018: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'missing_or_found_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-21 21:00:35,605 - lg_cotrain - INFO - D_l1: 30, D_l2: 20, D_LG: 5113
2026-02-21 21:00:35,607 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-21 21:00:53,751 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1104, mean_prob2=0.0828
2026-02-21 21:01:11,341 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.0994, mean_prob2=0.0868
2026-02-21 21:01:28,887 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1122, mean_prob2=0.1069
2026-02-21 21:01:46,248 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1033, mean_prob2=0.1224
2026-02-21 21:02:03,694 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.0829, mean_prob2=0.0915
2026-02-21 21:02:21,267 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1106, mean_prob2=0.1375
2026-02-21 21:02:38,994 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.0867, mean_prob2=0.1052
2026-02-21 21:02:38,995 - lg_cotrain - INFO - Phase 1 done. lambda1: mean=0.1389, range=[0.0818, 0.3023]
2026-02-21 21:02:38,995 - lg_cotrain - INFO - Phase 1 done. lambda2: mean=0.0562, range=[0.0184, 0.1892]
2026-02-21 21:02:38,995 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-21 21:02:39,967 - lg_cotrain - INFO - LR scheduler: total_steps_1=980, warmup=118; total_steps_2=980, warmup=118
2026-02-21 21:03:46,293 - lg_cotrain - INFO - Phase 2 epoch 1/11: loss1=0.0712, loss2=0.1839, dev_macro_f1=0.5181, dev_err=30.59%
2026-02-21 21:04:56,160 - lg_cotrain - INFO - Phase 2 epoch 2/11: loss1=0.1327, loss2=0.8874, dev_macro_f1=0.0302, dev_err=82.18%
2026-02-21 21:06:04,757 - lg_cotrain - INFO - Phase 2 epoch 3/11: loss1=0.0869, loss2=0.9352, dev_macro_f1=0.0302, dev_err=82.18%
2026-02-21 21:07:13,476 - lg_cotrain - INFO - Phase 2 epoch 4/11: loss1=0.0611, loss2=0.8549, dev_macro_f1=0.0302, dev_err=82.18%
2026-02-21 21:08:23,820 - lg_cotrain - INFO - Phase 2 epoch 5/11: loss1=0.0630, loss2=0.7987, dev_macro_f1=0.0302, dev_err=82.18%
2026-02-21 21:09:31,072 - lg_cotrain - INFO - Phase 2 epoch 6/11: loss1=0.0686, loss2=0.7530, dev_macro_f1=0.0302, dev_err=82.18%
2026-02-21 21:10:37,160 - lg_cotrain - INFO - Phase 2 epoch 7/11: loss1=0.0697, loss2=0.7176, dev_macro_f1=0.0419, dev_err=73.54%
2026-02-21 21:11:43,441 - lg_cotrain - INFO - Phase 2 epoch 8/11: loss1=0.0749, loss2=0.6887, dev_macro_f1=0.0302, dev_err=82.18%
2026-02-21 21:12:54,072 - lg_cotrain - INFO - Phase 2 epoch 9/11: loss1=0.0785, loss2=0.6614, dev_macro_f1=0.0302, dev_err=82.18%
2026-02-21 21:14:04,953 - lg_cotrain - INFO - Phase 2 epoch 10/11: loss1=0.0812, loss2=0.6399, dev_macro_f1=0.0419, dev_err=73.54%
2026-02-21 21:15:14,727 - lg_cotrain - INFO - Phase 2 epoch 11/11: loss1=0.0850, loss2=0.6209, dev_macro_f1=0.0419, dev_err=73.54%
2026-02-21 21:15:14,727 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-21 21:15:17,490 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.0419, dev_err=73.54%, es_counter1=0, es_counter2=0
2026-02-21 21:15:20,237 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.0419, dev_err=73.54%, es_counter1=1, es_counter2=1
2026-02-21 21:15:22,993 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.0419, dev_err=73.54%, es_counter1=2, es_counter2=2
2026-02-21 21:15:25,748 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.0419, dev_err=73.54%, es_counter1=3, es_counter2=3
2026-02-21 21:15:28,472 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.0419, dev_err=73.54%, es_counter1=4, es_counter2=4
2026-02-21 21:15:31,207 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.0419, dev_err=73.54%, es_counter1=5, es_counter2=5
2026-02-21 21:15:33,951 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.0419, dev_err=73.54%, es_counter1=6, es_counter2=6
2026-02-21 21:15:36,713 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.0419, dev_err=73.54%, es_counter1=7, es_counter2=7
2026-02-21 21:15:39,473 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.0419, dev_err=73.54%, es_counter1=8, es_counter2=8
2026-02-21 21:15:42,217 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.0419, dev_err=73.54%, es_counter1=9, es_counter2=9
2026-02-21 21:15:44,988 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.0108, dev_err=94.28%, es_counter1=10, es_counter2=10
2026-02-21 21:15:44,988 - lg_cotrain - INFO - Early stopping at epoch 11
2026-02-21 21:15:44,997 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-21 21:15:52,359 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpud_kl8e8\california_wildfires_2018\5_set1\metrics.json
2026-02-21 21:15:52,359 - lg_cotrain - INFO - Test error rate: 73.65%, Test macro-F1: 0.0417, Test ECE: 0.1554
2026-02-21 21:15:52,371 - lg_cotrain - INFO - --- Trial 1/10 done: dev_macro_f1=0.0419 ---
2026-02-21 21:15:52,372 - lg_cotrain - INFO - --- Trial 2/10 ---
2026-02-21 21:15:52,949 - lg_cotrain - INFO - Starting LG-CoTrain: event=california_wildfires_2018, budget=5, seed_set=1
2026-02-21 21:15:52,982 - lg_cotrain - INFO - Detected 10 classes for event california_wildfires_2018: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'missing_or_found_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-21 21:15:52,991 - lg_cotrain - INFO - D_l1: 30, D_l2: 20, D_LG: 5113
2026-02-21 21:15:52,993 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-21 21:16:12,685 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1118, mean_prob2=0.0838
2026-02-21 21:16:30,935 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1108, mean_prob2=0.0868
2026-02-21 21:16:48,735 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1018, mean_prob2=0.1005
2026-02-21 21:17:06,275 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.0997, mean_prob2=0.1150
2026-02-21 21:17:23,911 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1144, mean_prob2=0.1307
2026-02-21 21:17:41,920 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1011, mean_prob2=0.1139
2026-02-21 21:18:00,680 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1585, mean_prob2=0.1223
2026-02-21 21:18:00,681 - lg_cotrain - INFO - Phase 1 done. lambda1: mean=0.1523, range=[0.0736, 0.4018]
2026-02-21 21:18:00,681 - lg_cotrain - INFO - Phase 1 done. lambda2: mean=0.0665, range=[0.0191, 0.1774]
2026-02-21 21:18:00,682 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-21 21:18:01,843 - lg_cotrain - INFO - LR scheduler: total_steps_1=1540, warmup=101; total_steps_2=1540, warmup=101
2026-02-21 21:19:11,930 - lg_cotrain - INFO - Phase 2 epoch 1/18: loss1=0.0865, loss2=0.2014, dev_macro_f1=0.5126, dev_err=31.38%
2026-02-21 21:20:22,423 - lg_cotrain - INFO - Phase 2 epoch 2/18: loss1=0.0787, loss2=0.4781, dev_macro_f1=0.5023, dev_err=31.52%
2026-02-21 21:21:30,039 - lg_cotrain - INFO - Phase 2 epoch 3/18: loss1=0.2519, loss2=0.7741, dev_macro_f1=0.1084, dev_err=64.10%
2026-02-21 21:22:38,086 - lg_cotrain - INFO - Phase 2 epoch 4/18: loss1=0.1784, loss2=1.0978, dev_macro_f1=0.0419, dev_err=73.54%
2026-02-21 21:23:46,670 - lg_cotrain - INFO - Phase 2 epoch 5/18: loss1=0.1269, loss2=1.0836, dev_macro_f1=0.0419, dev_err=73.54%
2026-02-21 21:24:55,461 - lg_cotrain - INFO - Phase 2 epoch 6/18: loss1=0.1068, loss2=1.0110, dev_macro_f1=0.0419, dev_err=73.54%
2026-02-21 21:26:01,880 - lg_cotrain - INFO - Phase 2 epoch 7/18: loss1=0.0958, loss2=0.9592, dev_macro_f1=0.0419, dev_err=73.54%
2026-02-21 21:27:07,721 - lg_cotrain - INFO - Phase 2 epoch 8/18: loss1=0.0907, loss2=0.9075, dev_macro_f1=0.0419, dev_err=73.54%
2026-02-21 21:28:13,588 - lg_cotrain - INFO - Phase 2 epoch 9/18: loss1=0.0893, loss2=0.8671, dev_macro_f1=0.0419, dev_err=73.54%
2026-02-21 21:29:19,219 - lg_cotrain - INFO - Phase 2 epoch 10/18: loss1=0.0889, loss2=0.8325, dev_macro_f1=0.0419, dev_err=73.54%
2026-02-21 21:30:24,881 - lg_cotrain - INFO - Phase 2 epoch 11/18: loss1=0.0890, loss2=0.8069, dev_macro_f1=0.0419, dev_err=73.54%
2026-02-21 21:31:31,478 - lg_cotrain - INFO - Phase 2 epoch 12/18: loss1=0.0897, loss2=0.7820, dev_macro_f1=0.0419, dev_err=73.54%
2026-02-21 21:32:38,156 - lg_cotrain - INFO - Phase 2 epoch 13/18: loss1=0.0902, loss2=0.7625, dev_macro_f1=0.0302, dev_err=82.18%
2026-02-21 21:33:44,264 - lg_cotrain - INFO - Phase 2 epoch 14/18: loss1=0.0911, loss2=0.7432, dev_macro_f1=0.0419, dev_err=73.54%
2026-02-21 21:34:51,888 - lg_cotrain - INFO - Phase 2 epoch 15/18: loss1=0.0917, loss2=0.7234, dev_macro_f1=0.0419, dev_err=73.54%
2026-02-21 21:35:57,974 - lg_cotrain - INFO - Phase 2 epoch 16/18: loss1=0.0916, loss2=0.7077, dev_macro_f1=0.0419, dev_err=73.54%
2026-02-21 21:37:04,117 - lg_cotrain - INFO - Phase 2 epoch 17/18: loss1=0.0934, loss2=0.6932, dev_macro_f1=0.0419, dev_err=73.54%
2026-02-21 21:38:10,439 - lg_cotrain - INFO - Phase 2 epoch 18/18: loss1=0.0948, loss2=0.6793, dev_macro_f1=0.0419, dev_err=73.54%
2026-02-21 21:38:10,439 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-21 21:38:13,147 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.0419, dev_err=73.54%, es_counter1=0, es_counter2=0
2026-02-21 21:38:15,793 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.0419, dev_err=73.54%, es_counter1=1, es_counter2=1
2026-02-21 21:38:18,438 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.0419, dev_err=73.54%, es_counter1=2, es_counter2=2
2026-02-21 21:38:21,091 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.0419, dev_err=73.54%, es_counter1=3, es_counter2=3
2026-02-21 21:38:23,741 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.0419, dev_err=73.54%, es_counter1=4, es_counter2=4
2026-02-21 21:38:26,388 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.0419, dev_err=73.54%, es_counter1=5, es_counter2=5
2026-02-21 21:38:29,055 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.0419, dev_err=73.54%, es_counter1=6, es_counter2=6
2026-02-21 21:38:31,840 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.0419, dev_err=73.54%, es_counter1=7, es_counter2=7
2026-02-21 21:38:31,841 - lg_cotrain - INFO - Early stopping at epoch 8
2026-02-21 21:38:31,849 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-21 21:38:38,976 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmp12vqkjrf\california_wildfires_2018\5_set1\metrics.json
2026-02-21 21:38:38,976 - lg_cotrain - INFO - Test error rate: 73.65%, Test macro-F1: 0.0417, Test ECE: 0.2014
2026-02-21 21:38:38,988 - lg_cotrain - INFO - --- Trial 2/10 done: dev_macro_f1=0.0419 ---
2026-02-21 21:38:38,988 - lg_cotrain - INFO - --- Trial 3/10 ---
2026-02-21 21:38:39,539 - lg_cotrain - INFO - Starting LG-CoTrain: event=california_wildfires_2018, budget=5, seed_set=1
2026-02-21 21:38:39,577 - lg_cotrain - INFO - Detected 10 classes for event california_wildfires_2018: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'missing_or_found_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-21 21:38:39,585 - lg_cotrain - INFO - D_l1: 30, D_l2: 20, D_LG: 5113
2026-02-21 21:38:39,586 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-21 21:39:00,178 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.0726, mean_prob2=0.0826
2026-02-21 21:39:19,380 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.0798, mean_prob2=0.1116
2026-02-21 21:39:38,918 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1002, mean_prob2=0.0922
2026-02-21 21:39:58,204 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.0953, mean_prob2=0.0840
2026-02-21 21:40:17,311 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.0842, mean_prob2=0.0685
2026-02-21 21:40:36,484 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1108, mean_prob2=0.0777
2026-02-21 21:40:55,587 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1236, mean_prob2=0.1038
2026-02-21 21:40:55,588 - lg_cotrain - INFO - Phase 1 done. lambda1: mean=0.1387, range=[0.0861, 0.1973]
2026-02-21 21:40:55,589 - lg_cotrain - INFO - Phase 1 done. lambda2: mean=0.0412, range=[0.0266, 0.0975]
2026-02-21 21:40:55,589 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-21 21:40:56,550 - lg_cotrain - INFO - LR scheduler: total_steps_1=5640, warmup=800; total_steps_2=5640, warmup=800
2026-02-21 21:42:16,033 - lg_cotrain - INFO - Phase 2 epoch 1/17: loss1=0.0631, loss2=0.1874, dev_macro_f1=0.0302, dev_err=82.18%
2026-02-21 21:43:35,420 - lg_cotrain - INFO - Phase 2 epoch 2/17: loss1=0.1439, loss2=0.2962, dev_macro_f1=0.0302, dev_err=82.18%
2026-02-21 21:44:54,794 - lg_cotrain - INFO - Phase 2 epoch 3/17: loss1=0.1327, loss2=0.3389, dev_macro_f1=0.0302, dev_err=82.18%
2026-02-21 21:46:14,090 - lg_cotrain - INFO - Phase 2 epoch 4/17: loss1=0.1382, loss2=0.3540, dev_macro_f1=0.0419, dev_err=73.54%
2026-02-21 21:47:33,449 - lg_cotrain - INFO - Phase 2 epoch 5/17: loss1=0.1327, loss2=0.3512, dev_macro_f1=0.0302, dev_err=82.18%
2026-02-21 21:48:53,270 - lg_cotrain - INFO - Phase 2 epoch 6/17: loss1=0.1384, loss2=0.3536, dev_macro_f1=0.0419, dev_err=73.54%
2026-02-21 21:50:12,716 - lg_cotrain - INFO - Phase 2 epoch 7/17: loss1=0.1382, loss2=0.3580, dev_macro_f1=0.0302, dev_err=82.18%
2026-02-21 21:51:32,109 - lg_cotrain - INFO - Phase 2 epoch 8/17: loss1=0.1432, loss2=0.3563, dev_macro_f1=0.0302, dev_err=82.18%
2026-02-21 21:52:51,541 - lg_cotrain - INFO - Phase 2 epoch 9/17: loss1=0.1464, loss2=0.3517, dev_macro_f1=0.0302, dev_err=82.18%
2026-02-21 21:54:10,925 - lg_cotrain - INFO - Phase 2 epoch 10/17: loss1=0.1461, loss2=0.3466, dev_macro_f1=0.0302, dev_err=82.18%
2026-02-21 21:55:30,261 - lg_cotrain - INFO - Phase 2 epoch 11/17: loss1=0.1490, loss2=0.3427, dev_macro_f1=0.0419, dev_err=73.54%
2026-02-21 21:56:49,661 - lg_cotrain - INFO - Phase 2 epoch 12/17: loss1=0.1496, loss2=0.3406, dev_macro_f1=0.0302, dev_err=82.18%
2026-02-21 21:58:09,149 - lg_cotrain - INFO - Phase 2 epoch 13/17: loss1=0.1507, loss2=0.3378, dev_macro_f1=0.0302, dev_err=82.18%
2026-02-21 21:59:28,642 - lg_cotrain - INFO - Phase 2 epoch 14/17: loss1=0.1504, loss2=0.3355, dev_macro_f1=0.0302, dev_err=82.18%
2026-02-21 22:00:48,158 - lg_cotrain - INFO - Phase 2 epoch 15/17: loss1=0.1510, loss2=0.3316, dev_macro_f1=0.0302, dev_err=82.18%
2026-02-21 22:02:07,655 - lg_cotrain - INFO - Phase 2 epoch 16/17: loss1=0.1525, loss2=0.3298, dev_macro_f1=0.0302, dev_err=82.18%
2026-02-21 22:03:27,299 - lg_cotrain - INFO - Phase 2 epoch 17/17: loss1=0.1525, loss2=0.3261, dev_macro_f1=0.0302, dev_err=82.18%
2026-02-21 22:03:27,299 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-21 22:03:30,246 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.0302, dev_err=82.18%, es_counter1=0, es_counter2=0
2026-02-21 22:03:33,167 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.0302, dev_err=82.18%, es_counter1=1, es_counter2=1
2026-02-21 22:03:36,092 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.0302, dev_err=82.18%, es_counter1=2, es_counter2=2
2026-02-21 22:03:39,015 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.0302, dev_err=82.18%, es_counter1=3, es_counter2=3
2026-02-21 22:03:41,942 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.0302, dev_err=82.18%, es_counter1=4, es_counter2=4
2026-02-21 22:03:44,873 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.0302, dev_err=82.18%, es_counter1=5, es_counter2=5
2026-02-21 22:03:44,874 - lg_cotrain - INFO - Early stopping at epoch 6
2026-02-21 22:03:44,883 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-21 22:03:52,722 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmp2ureezrw\california_wildfires_2018\5_set1\metrics.json
2026-02-21 22:03:52,722 - lg_cotrain - INFO - Test error rate: 82.14%, Test macro-F1: 0.0303, Test ECE: 0.3126
2026-02-21 22:03:52,732 - lg_cotrain - INFO - --- Trial 3/10 done: dev_macro_f1=0.0302 ---
2026-02-21 22:03:52,732 - lg_cotrain - INFO - --- Trial 4/10 ---
2026-02-21 22:03:53,314 - lg_cotrain - INFO - Starting LG-CoTrain: event=california_wildfires_2018, budget=5, seed_set=1
2026-02-21 22:03:53,352 - lg_cotrain - INFO - Detected 10 classes for event california_wildfires_2018: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'missing_or_found_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-21 22:03:53,360 - lg_cotrain - INFO - D_l1: 30, D_l2: 20, D_LG: 5113
2026-02-21 22:03:53,361 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-21 22:04:13,511 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1094, mean_prob2=0.0900
2026-02-21 22:04:32,757 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1078, mean_prob2=0.0965
2026-02-21 22:04:51,923 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1076, mean_prob2=0.1079
2026-02-21 22:05:11,110 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1073, mean_prob2=0.1115
2026-02-21 22:05:30,442 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1038, mean_prob2=0.1131
2026-02-21 22:05:49,588 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1013, mean_prob2=0.1167
2026-02-21 22:06:08,736 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1053, mean_prob2=0.1246
2026-02-21 22:06:08,737 - lg_cotrain - INFO - Phase 1 done. lambda1: mean=0.1291, range=[0.0540, 0.2842]
2026-02-21 22:06:08,737 - lg_cotrain - INFO - Phase 1 done. lambda2: mean=0.0838, range=[0.0000, 0.2385]
2026-02-21 22:06:08,737 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-21 22:06:09,740 - lg_cotrain - INFO - LR scheduler: total_steps_1=6280, warmup=1251; total_steps_2=6280, warmup=1251
2026-02-21 22:07:28,867 - lg_cotrain - INFO - Phase 2 epoch 1/19: loss1=0.1297, loss2=0.2083, dev_macro_f1=0.3653, dev_err=33.24%
2026-02-21 22:08:47,990 - lg_cotrain - INFO - Phase 2 epoch 2/19: loss1=0.0611, loss2=0.1658, dev_macro_f1=0.5367, dev_err=28.99%
2026-02-21 22:10:07,322 - lg_cotrain - INFO - Phase 2 epoch 3/19: loss1=0.0344, loss2=0.2091, dev_macro_f1=0.5648, dev_err=28.86%
2026-02-21 22:11:26,882 - lg_cotrain - INFO - Phase 2 epoch 4/19: loss1=0.0562, loss2=0.1848, dev_macro_f1=0.5245, dev_err=28.06%
2026-02-21 22:12:47,690 - lg_cotrain - INFO - Phase 2 epoch 5/19: loss1=0.0458, loss2=0.1428, dev_macro_f1=0.5515, dev_err=27.79%
2026-02-21 22:14:08,016 - lg_cotrain - INFO - Phase 2 epoch 6/19: loss1=0.0361, loss2=0.0947, dev_macro_f1=0.5928, dev_err=26.46%
2026-02-21 22:15:28,396 - lg_cotrain - INFO - Phase 2 epoch 7/19: loss1=0.0248, loss2=0.0704, dev_macro_f1=0.5709, dev_err=28.32%
2026-02-21 22:16:48,710 - lg_cotrain - INFO - Phase 2 epoch 8/19: loss1=0.0150, loss2=0.0603, dev_macro_f1=0.5677, dev_err=27.53%
2026-02-21 22:18:09,250 - lg_cotrain - INFO - Phase 2 epoch 9/19: loss1=0.0164, loss2=0.0341, dev_macro_f1=0.5709, dev_err=27.93%
2026-02-21 22:19:29,469 - lg_cotrain - INFO - Phase 2 epoch 10/19: loss1=0.0258, loss2=0.0251, dev_macro_f1=0.5881, dev_err=27.39%
2026-02-21 22:20:52,739 - lg_cotrain - INFO - Phase 2 epoch 11/19: loss1=0.0173, loss2=0.0184, dev_macro_f1=0.5786, dev_err=28.06%
2026-02-21 22:22:17,326 - lg_cotrain - INFO - Phase 2 epoch 12/19: loss1=0.0143, loss2=0.0260, dev_macro_f1=0.5801, dev_err=27.93%
2026-02-21 22:23:42,837 - lg_cotrain - INFO - Phase 2 epoch 13/19: loss1=0.0095, loss2=0.0191, dev_macro_f1=0.5728, dev_err=27.66%
2026-02-21 22:25:06,388 - lg_cotrain - INFO - Phase 2 epoch 14/19: loss1=0.0054, loss2=0.0112, dev_macro_f1=0.5753, dev_err=27.93%
2026-02-21 22:26:26,623 - lg_cotrain - INFO - Phase 2 epoch 15/19: loss1=0.0038, loss2=0.0099, dev_macro_f1=0.5728, dev_err=27.79%
2026-02-21 22:27:46,768 - lg_cotrain - INFO - Phase 2 epoch 16/19: loss1=0.0040, loss2=0.0052, dev_macro_f1=0.5816, dev_err=27.66%
2026-02-21 22:29:07,026 - lg_cotrain - INFO - Phase 2 epoch 17/19: loss1=0.0037, loss2=0.0027, dev_macro_f1=0.5905, dev_err=28.19%
2026-02-21 22:30:27,527 - lg_cotrain - INFO - Phase 2 epoch 18/19: loss1=0.0038, loss2=0.0026, dev_macro_f1=0.5996, dev_err=28.06%
2026-02-21 22:31:47,746 - lg_cotrain - INFO - Phase 2 epoch 19/19: loss1=0.0035, loss2=0.0022, dev_macro_f1=0.5986, dev_err=28.19%
2026-02-21 22:31:47,746 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-21 22:31:50,739 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.6074, dev_err=27.93%, es_counter1=0, es_counter2=0
2026-02-21 22:31:53,773 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.6115, dev_err=27.79%, es_counter1=0, es_counter2=0
2026-02-21 22:31:56,776 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.6119, dev_err=27.79%, es_counter1=0, es_counter2=0
2026-02-21 22:31:59,774 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.6158, dev_err=27.39%, es_counter1=0, es_counter2=0
2026-02-21 22:32:02,756 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.6213, dev_err=27.26%, es_counter1=0, es_counter2=0
2026-02-21 22:32:05,740 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.6191, dev_err=27.39%, es_counter1=1, es_counter2=1
2026-02-21 22:32:08,767 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.6232, dev_err=27.39%, es_counter1=0, es_counter2=0
2026-02-21 22:32:11,780 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.6188, dev_err=27.26%, es_counter1=1, es_counter2=1
2026-02-21 22:32:14,781 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.6145, dev_err=27.39%, es_counter1=2, es_counter2=2
2026-02-21 22:32:17,778 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.6126, dev_err=27.53%, es_counter1=3, es_counter2=3
2026-02-21 22:32:20,797 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.6018, dev_err=28.19%, es_counter1=4, es_counter2=4
2026-02-21 22:32:23,795 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.5968, dev_err=28.59%, es_counter1=5, es_counter2=5
2026-02-21 22:32:23,795 - lg_cotrain - INFO - Early stopping at epoch 12
2026-02-21 22:32:23,804 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-21 22:32:31,682 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpkcbv_bwg\california_wildfires_2018\5_set1\metrics.json
2026-02-21 22:32:31,682 - lg_cotrain - INFO - Test error rate: 28.06%, Test macro-F1: 0.6018, Test ECE: 0.1834
2026-02-21 22:32:31,692 - lg_cotrain - INFO - --- Trial 4/10 done: dev_macro_f1=0.6232 ---
2026-02-21 22:32:31,692 - lg_cotrain - INFO - --- Trial 5/10 ---
2026-02-21 22:32:32,273 - lg_cotrain - INFO - Starting LG-CoTrain: event=california_wildfires_2018, budget=5, seed_set=1
2026-02-21 22:32:32,312 - lg_cotrain - INFO - Detected 10 classes for event california_wildfires_2018: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'missing_or_found_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-21 22:32:32,320 - lg_cotrain - INFO - D_l1: 30, D_l2: 20, D_LG: 5113
2026-02-21 22:32:32,320 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-21 22:32:54,628 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1076, mean_prob2=0.1020
2026-02-21 22:33:16,039 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1102, mean_prob2=0.1089
2026-02-21 22:33:38,137 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1120, mean_prob2=0.1191
2026-02-21 22:34:00,677 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1126, mean_prob2=0.1194
2026-02-21 22:34:23,162 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1096, mean_prob2=0.1127
2026-02-21 22:34:45,688 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1076, mean_prob2=0.1121
2026-02-21 22:35:08,171 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1192, mean_prob2=0.1313
2026-02-21 22:35:08,172 - lg_cotrain - INFO - Phase 1 done. lambda1: mean=0.1336, range=[0.0628, 0.2452]
2026-02-21 22:35:08,172 - lg_cotrain - INFO - Phase 1 done. lambda2: mean=0.0934, range=[0.0149, 0.2340]
2026-02-21 22:35:08,172 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-21 22:35:09,333 - lg_cotrain - INFO - LR scheduler: total_steps_1=12560, warmup=1988; total_steps_2=12460, warmup=1972
2026-02-21 22:36:46,900 - lg_cotrain - INFO - Phase 2 epoch 1/19: loss1=0.1296, loss2=0.1938, dev_macro_f1=0.4605, dev_err=29.52%
2026-02-21 22:38:24,745 - lg_cotrain - INFO - Phase 2 epoch 2/19: loss1=0.0597, loss2=0.1866, dev_macro_f1=0.5665, dev_err=27.26%
2026-02-21 22:40:01,249 - lg_cotrain - INFO - Phase 2 epoch 3/19: loss1=0.0577, loss2=0.2186, dev_macro_f1=0.5127, dev_err=28.32%
2026-02-21 22:41:36,364 - lg_cotrain - INFO - Phase 2 epoch 4/19: loss1=0.0493, loss2=0.1973, dev_macro_f1=0.5872, dev_err=26.33%
2026-02-21 22:43:13,818 - lg_cotrain - INFO - Phase 2 epoch 5/19: loss1=0.0284, loss2=0.1417, dev_macro_f1=0.5891, dev_err=25.80%
2026-02-21 22:44:53,873 - lg_cotrain - INFO - Phase 2 epoch 6/19: loss1=0.0401, loss2=0.1034, dev_macro_f1=0.5921, dev_err=26.20%
2026-02-21 22:46:31,578 - lg_cotrain - INFO - Phase 2 epoch 7/19: loss1=0.0393, loss2=0.0949, dev_macro_f1=0.5693, dev_err=27.79%
2026-02-21 22:48:08,133 - lg_cotrain - INFO - Phase 2 epoch 8/19: loss1=0.0270, loss2=0.0522, dev_macro_f1=0.5703, dev_err=27.13%
2026-02-21 22:49:46,206 - lg_cotrain - INFO - Phase 2 epoch 9/19: loss1=0.0183, loss2=0.0344, dev_macro_f1=0.5666, dev_err=26.99%
2026-02-21 22:51:23,268 - lg_cotrain - INFO - Phase 2 epoch 10/19: loss1=0.0201, loss2=0.0454, dev_macro_f1=0.6027, dev_err=25.93%
2026-02-21 22:52:59,568 - lg_cotrain - INFO - Phase 2 epoch 11/19: loss1=0.0103, loss2=0.0310, dev_macro_f1=0.5852, dev_err=26.46%
2026-02-21 22:54:34,902 - lg_cotrain - INFO - Phase 2 epoch 12/19: loss1=0.0132, loss2=0.0169, dev_macro_f1=0.5888, dev_err=26.86%
2026-02-21 22:56:11,738 - lg_cotrain - INFO - Phase 2 epoch 13/19: loss1=0.0143, loss2=0.0174, dev_macro_f1=0.5989, dev_err=26.20%
2026-02-21 22:57:47,890 - lg_cotrain - INFO - Phase 2 epoch 14/19: loss1=0.0056, loss2=0.0201, dev_macro_f1=0.5873, dev_err=26.99%
2026-02-21 22:59:28,543 - lg_cotrain - INFO - Phase 2 epoch 15/19: loss1=0.0073, loss2=0.0091, dev_macro_f1=0.5895, dev_err=26.99%
2026-02-21 23:01:08,207 - lg_cotrain - INFO - Phase 2 epoch 16/19: loss1=0.0027, loss2=0.0099, dev_macro_f1=0.6023, dev_err=26.06%
2026-02-21 23:02:46,195 - lg_cotrain - INFO - Phase 2 epoch 17/19: loss1=0.0032, loss2=0.0063, dev_macro_f1=0.5928, dev_err=26.20%
2026-02-21 23:04:23,870 - lg_cotrain - INFO - Phase 2 epoch 18/19: loss1=0.0020, loss2=0.0030, dev_macro_f1=0.5976, dev_err=25.93%
2026-02-21 23:06:04,379 - lg_cotrain - INFO - Phase 2 epoch 19/19: loss1=0.0028, loss2=0.0022, dev_macro_f1=0.5973, dev_err=26.46%
2026-02-21 23:06:04,379 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-21 23:06:07,838 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.6246, dev_err=26.06%, es_counter1=0, es_counter2=0
2026-02-21 23:06:11,287 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.5999, dev_err=26.99%, es_counter1=1, es_counter2=1
2026-02-21 23:06:14,758 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.5966, dev_err=27.13%, es_counter1=2, es_counter2=2
2026-02-21 23:06:18,234 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.5943, dev_err=27.93%, es_counter1=3, es_counter2=3
2026-02-21 23:06:21,690 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.5902, dev_err=28.46%, es_counter1=4, es_counter2=4
2026-02-21 23:06:25,145 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.5871, dev_err=28.72%, es_counter1=5, es_counter2=5
2026-02-21 23:06:28,615 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.5837, dev_err=29.12%, es_counter1=6, es_counter2=6
2026-02-21 23:06:32,064 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.5995, dev_err=28.59%, es_counter1=7, es_counter2=7
2026-02-21 23:06:35,541 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.6061, dev_err=28.72%, es_counter1=8, es_counter2=8
2026-02-21 23:06:35,541 - lg_cotrain - INFO - Early stopping at epoch 9
2026-02-21 23:06:35,552 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-21 23:06:44,594 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmp_fw4io8t\california_wildfires_2018\5_set1\metrics.json
2026-02-21 23:06:44,594 - lg_cotrain - INFO - Test error rate: 27.10%, Test macro-F1: 0.6006, Test ECE: 0.1934
2026-02-21 23:06:44,605 - lg_cotrain - INFO - --- Trial 5/10 done: dev_macro_f1=0.6246 ---
2026-02-21 23:06:44,606 - lg_cotrain - INFO - --- Trial 6/10 ---
2026-02-21 23:06:45,187 - lg_cotrain - INFO - Starting LG-CoTrain: event=california_wildfires_2018, budget=5, seed_set=1
2026-02-21 23:06:45,219 - lg_cotrain - INFO - Detected 10 classes for event california_wildfires_2018: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'missing_or_found_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-21 23:06:45,226 - lg_cotrain - INFO - D_l1: 30, D_l2: 20, D_LG: 5113
2026-02-21 23:06:45,228 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-21 23:07:04,658 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1114, mean_prob2=0.0834
2026-02-21 23:07:23,197 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1060, mean_prob2=0.0865
2026-02-21 23:07:40,753 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1075, mean_prob2=0.1010
2026-02-21 23:07:58,456 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1024, mean_prob2=0.1267
2026-02-21 23:08:16,414 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.0983, mean_prob2=0.1126
2026-02-21 23:08:34,372 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1314, mean_prob2=0.1295
2026-02-21 23:08:52,403 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1034, mean_prob2=0.1387
2026-02-21 23:08:52,404 - lg_cotrain - INFO - Phase 1 done. lambda1: mean=0.1440, range=[0.0772, 0.3472]
2026-02-21 23:08:52,404 - lg_cotrain - INFO - Phase 1 done. lambda2: mean=0.0612, range=[0.0000, 0.1958]
2026-02-21 23:08:52,404 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-21 23:08:53,409 - lg_cotrain - INFO - LR scheduler: total_steps_1=980, warmup=94; total_steps_2=980, warmup=94
2026-02-21 23:10:02,343 - lg_cotrain - INFO - Phase 2 epoch 1/11: loss1=0.0773, loss2=0.1850, dev_macro_f1=0.5380, dev_err=30.19%
2026-02-21 23:11:12,063 - lg_cotrain - INFO - Phase 2 epoch 2/11: loss1=0.1207, loss2=1.0392, dev_macro_f1=0.2627, dev_err=43.75%
2026-02-21 23:12:22,345 - lg_cotrain - INFO - Phase 2 epoch 3/11: loss1=0.1039, loss2=1.1823, dev_macro_f1=0.1069, dev_err=66.89%
2026-02-21 23:13:32,219 - lg_cotrain - INFO - Phase 2 epoch 4/11: loss1=0.0735, loss2=1.1082, dev_macro_f1=0.1114, dev_err=65.56%
2026-02-21 23:14:38,790 - lg_cotrain - INFO - Phase 2 epoch 5/11: loss1=0.0681, loss2=1.0413, dev_macro_f1=0.1097, dev_err=66.09%
2026-02-21 23:15:45,347 - lg_cotrain - INFO - Phase 2 epoch 6/11: loss1=0.0702, loss2=0.9933, dev_macro_f1=0.0892, dev_err=71.81%
2026-02-21 23:16:51,688 - lg_cotrain - INFO - Phase 2 epoch 7/11: loss1=0.0699, loss2=0.9468, dev_macro_f1=0.1110, dev_err=65.69%
2026-02-21 23:17:58,246 - lg_cotrain - INFO - Phase 2 epoch 8/11: loss1=0.0726, loss2=0.9102, dev_macro_f1=0.1110, dev_err=65.69%
2026-02-21 23:19:05,825 - lg_cotrain - INFO - Phase 2 epoch 9/11: loss1=0.0746, loss2=0.8734, dev_macro_f1=0.1118, dev_err=65.43%
2026-02-21 23:20:13,548 - lg_cotrain - INFO - Phase 2 epoch 10/11: loss1=0.0754, loss2=0.8469, dev_macro_f1=0.1129, dev_err=65.03%
