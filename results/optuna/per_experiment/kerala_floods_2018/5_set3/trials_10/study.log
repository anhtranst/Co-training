2026-02-28 17:56:50,454 - lg_cotrain - INFO - === Optuna study: kerala_floods_2018 budget=5 seed=3 | target=10 trials, 0 replayed, 10 new ===
2026-02-28 17:56:50,454 - lg_cotrain - INFO - --- Trial 1/10 ---
2026-02-28 17:56:51,027 - lg_cotrain - INFO - Starting LG-CoTrain: event=kerala_floods_2018, budget=5, seed_set=3
2026-02-28 17:56:51,090 - lg_cotrain - INFO - Detected 9 classes for event kerala_floods_2018: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-28 17:56:51,098 - lg_cotrain - INFO - D_l1: 27, D_l2: 18, D_LG: 5543
2026-02-28 17:56:51,100 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-28 17:57:11,826 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1084, mean_prob2=0.1056
2026-02-28 17:57:31,130 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1150, mean_prob2=0.1052
2026-02-28 17:57:50,495 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1194, mean_prob2=0.1032
2026-02-28 17:58:09,909 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1143, mean_prob2=0.0989
2026-02-28 17:58:29,474 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1013, mean_prob2=0.1016
2026-02-28 17:58:49,041 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1008, mean_prob2=0.1092
2026-02-28 17:59:08,426 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1044, mean_prob2=0.1087
2026-02-28 17:59:08,426 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-28 17:59:09,397 - lg_cotrain - INFO - LR scheduler: total_steps_1=5752, warmup=1205; total_steps_2=5752, warmup=1205
2026-02-28 17:59:09,397 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1044, range=[0.0221, 0.3298]
2026-02-28 17:59:09,397 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1087, range=[0.0582, 0.1916]
2026-02-28 18:00:27,880 - lg_cotrain - INFO - Phase 2 epoch 1/16: loss1=0.1364, loss2=0.1286, dev_macro_f1=0.5150, dev_err=29.48%
2026-02-28 18:01:47,210 - lg_cotrain - INFO - Phase 2 epoch 2/16: loss1=0.0623, loss2=0.3379, dev_macro_f1=0.4731, dev_err=32.80%
2026-02-28 18:03:06,597 - lg_cotrain - INFO - Phase 2 epoch 3/16: loss1=0.0719, loss2=0.4094, dev_macro_f1=0.4860, dev_err=31.70%
2026-02-28 18:04:25,927 - lg_cotrain - INFO - Phase 2 epoch 4/16: loss1=0.2297, loss2=0.6345, dev_macro_f1=0.0777, dev_err=46.19%
2026-02-28 18:05:45,883 - lg_cotrain - INFO - Phase 2 epoch 5/16: loss1=0.1593, loss2=1.1205, dev_macro_f1=0.0777, dev_err=46.19%
2026-02-28 18:07:10,511 - lg_cotrain - INFO - Phase 2 epoch 6/16: loss1=0.0756, loss2=1.0390, dev_macro_f1=0.0777, dev_err=46.19%
2026-02-28 18:08:35,382 - lg_cotrain - INFO - Phase 2 epoch 7/16: loss1=0.0309, loss2=0.9760, dev_macro_f1=0.0777, dev_err=46.19%
2026-02-28 18:10:00,190 - lg_cotrain - INFO - Phase 2 epoch 8/16: loss1=0.0139, loss2=0.9267, dev_macro_f1=0.0777, dev_err=46.19%
2026-02-28 18:11:24,939 - lg_cotrain - INFO - Phase 2 epoch 9/16: loss1=0.0106, loss2=0.8808, dev_macro_f1=0.0777, dev_err=46.19%
2026-02-28 18:12:48,018 - lg_cotrain - INFO - Phase 2 epoch 10/16: loss1=0.0097, loss2=0.8439, dev_macro_f1=0.0777, dev_err=46.19%
2026-02-28 18:14:08,542 - lg_cotrain - INFO - Phase 2 epoch 11/16: loss1=0.0082, loss2=0.8091, dev_macro_f1=0.0777, dev_err=46.19%
2026-02-28 18:15:27,526 - lg_cotrain - INFO - Phase 2 epoch 12/16: loss1=0.0075, loss2=0.7762, dev_macro_f1=0.0777, dev_err=46.19%
2026-02-28 18:16:46,561 - lg_cotrain - INFO - Phase 2 epoch 13/16: loss1=0.0068, loss2=0.7494, dev_macro_f1=0.0777, dev_err=46.19%
2026-02-28 18:18:06,016 - lg_cotrain - INFO - Phase 2 epoch 14/16: loss1=0.0063, loss2=0.7249, dev_macro_f1=0.0777, dev_err=46.19%
2026-02-28 18:19:25,776 - lg_cotrain - INFO - Phase 2 epoch 15/16: loss1=0.0058, loss2=0.7007, dev_macro_f1=0.0777, dev_err=46.19%
2026-02-28 18:20:45,074 - lg_cotrain - INFO - Phase 2 epoch 16/16: loss1=0.0055, loss2=0.6805, dev_macro_f1=0.0777, dev_err=46.19%
2026-02-28 18:20:45,076 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-28 18:20:48,045 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.0777, dev_err=46.19%, es_counter1=0, es_counter2=0
2026-02-28 18:20:50,958 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.0777, dev_err=46.19%, es_counter1=1, es_counter2=1
2026-02-28 18:20:53,861 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.0777, dev_err=46.19%, es_counter1=2, es_counter2=2
2026-02-28 18:20:56,889 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.0777, dev_err=46.19%, es_counter1=3, es_counter2=3
2026-02-28 18:20:59,802 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.0777, dev_err=46.19%, es_counter1=4, es_counter2=4
2026-02-28 18:20:59,802 - lg_cotrain - INFO - Early stopping at epoch 5
2026-02-28 18:20:59,813 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-28 18:21:07,659 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpdbgh2t7a\kerala_floods_2018\5_set3\metrics.json
2026-02-28 18:21:07,659 - lg_cotrain - INFO - Test error rate: 46.21%, Test macro-F1: 0.0777, Test ECE: 0.3565
2026-02-28 18:21:07,669 - lg_cotrain - INFO - --- Trial 1/10 done: dev_macro_f1=0.0777 ---
2026-02-28 18:21:07,669 - lg_cotrain - INFO - --- Trial 2/10 ---
2026-02-28 18:21:08,178 - lg_cotrain - INFO - Starting LG-CoTrain: event=kerala_floods_2018, budget=5, seed_set=3
2026-02-28 18:21:08,223 - lg_cotrain - INFO - Detected 9 classes for event kerala_floods_2018: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-28 18:21:08,231 - lg_cotrain - INFO - D_l1: 27, D_l2: 18, D_LG: 5543
2026-02-28 18:21:08,231 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-28 18:21:26,491 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1105, mean_prob2=0.1288
2026-02-28 18:21:44,039 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1113, mean_prob2=0.1277
2026-02-28 18:22:01,234 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1115, mean_prob2=0.1266
2026-02-28 18:22:18,276 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1121, mean_prob2=0.1260
2026-02-28 18:22:35,250 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1125, mean_prob2=0.1258
2026-02-28 18:22:52,300 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1129, mean_prob2=0.1262
2026-02-28 18:23:09,386 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1130, mean_prob2=0.1272
2026-02-28 18:23:09,386 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-28 18:23:10,458 - lg_cotrain - INFO - LR scheduler: total_steps_1=1318, warmup=15; total_steps_2=1318, warmup=15
2026-02-28 18:23:10,458 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1130, range=[0.0556, 0.1805]
2026-02-28 18:23:10,458 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1272, range=[0.0410, 0.2729]
2026-02-28 18:24:14,986 - lg_cotrain - INFO - Phase 2 epoch 1/14: loss1=0.1816, loss2=0.1834, dev_macro_f1=0.2007, dev_err=39.68%
2026-02-28 18:25:19,426 - lg_cotrain - INFO - Phase 2 epoch 2/14: loss1=0.1063, loss2=0.1993, dev_macro_f1=0.3382, dev_err=34.15%
2026-02-28 18:26:24,009 - lg_cotrain - INFO - Phase 2 epoch 3/14: loss1=0.0618, loss2=0.1612, dev_macro_f1=0.4221, dev_err=30.34%
2026-02-28 18:27:28,530 - lg_cotrain - INFO - Phase 2 epoch 4/14: loss1=0.0418, loss2=0.1331, dev_macro_f1=0.4628, dev_err=27.89%
2026-02-28 18:28:33,085 - lg_cotrain - INFO - Phase 2 epoch 5/14: loss1=0.0359, loss2=0.1063, dev_macro_f1=0.4799, dev_err=27.76%
2026-02-28 18:29:37,611 - lg_cotrain - INFO - Phase 2 epoch 6/14: loss1=0.0304, loss2=0.0888, dev_macro_f1=0.4866, dev_err=27.64%
2026-02-28 18:30:42,043 - lg_cotrain - INFO - Phase 2 epoch 7/14: loss1=0.0253, loss2=0.0749, dev_macro_f1=0.4894, dev_err=26.90%
2026-02-28 18:31:46,491 - lg_cotrain - INFO - Phase 2 epoch 8/14: loss1=0.0222, loss2=0.0636, dev_macro_f1=0.4856, dev_err=27.52%
2026-02-28 18:32:50,884 - lg_cotrain - INFO - Phase 2 epoch 9/14: loss1=0.0204, loss2=0.0552, dev_macro_f1=0.5062, dev_err=27.52%
2026-02-28 18:33:55,362 - lg_cotrain - INFO - Phase 2 epoch 10/14: loss1=0.0190, loss2=0.0470, dev_macro_f1=0.5226, dev_err=26.66%
2026-02-28 18:34:59,793 - lg_cotrain - INFO - Phase 2 epoch 11/14: loss1=0.0172, loss2=0.0453, dev_macro_f1=0.5134, dev_err=27.52%
2026-02-28 18:36:04,284 - lg_cotrain - INFO - Phase 2 epoch 12/14: loss1=0.0168, loss2=0.0399, dev_macro_f1=0.5338, dev_err=27.15%
2026-02-28 18:37:08,549 - lg_cotrain - INFO - Phase 2 epoch 13/14: loss1=0.0162, loss2=0.0367, dev_macro_f1=0.5315, dev_err=27.15%
2026-02-28 18:38:12,920 - lg_cotrain - INFO - Phase 2 epoch 14/14: loss1=0.0167, loss2=0.0335, dev_macro_f1=0.5304, dev_err=27.64%
2026-02-28 18:38:12,920 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-28 18:38:15,431 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.5308, dev_err=27.64%, es_counter1=0, es_counter2=0
2026-02-28 18:38:17,940 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.5319, dev_err=27.52%, es_counter1=0, es_counter2=0
2026-02-28 18:38:20,450 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.5352, dev_err=27.27%, es_counter1=0, es_counter2=0
2026-02-28 18:38:22,951 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.5343, dev_err=27.64%, es_counter1=1, es_counter2=1
2026-02-28 18:38:25,447 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.5349, dev_err=27.64%, es_counter1=2, es_counter2=2
2026-02-28 18:38:27,964 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.5359, dev_err=27.76%, es_counter1=0, es_counter2=0
2026-02-28 18:38:30,468 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.5385, dev_err=27.76%, es_counter1=0, es_counter2=0
2026-02-28 18:38:32,964 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.5316, dev_err=28.38%, es_counter1=1, es_counter2=1
2026-02-28 18:38:35,461 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.5300, dev_err=28.75%, es_counter1=2, es_counter2=2
2026-02-28 18:38:37,946 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.5341, dev_err=28.38%, es_counter1=3, es_counter2=3
2026-02-28 18:38:40,441 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.5316, dev_err=28.87%, es_counter1=4, es_counter2=4
2026-02-28 18:38:42,956 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.5293, dev_err=29.61%, es_counter1=5, es_counter2=5
2026-02-28 18:38:45,455 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.5295, dev_err=29.61%, es_counter1=6, es_counter2=6
2026-02-28 18:38:47,957 - lg_cotrain - INFO - Phase 3 epoch 14: dev_macro_f1=0.5299, dev_err=29.85%, es_counter1=7, es_counter2=7
2026-02-28 18:38:50,477 - lg_cotrain - INFO - Phase 3 epoch 15: dev_macro_f1=0.5669, dev_err=29.85%, es_counter1=0, es_counter2=0
2026-02-28 18:38:52,988 - lg_cotrain - INFO - Phase 3 epoch 16: dev_macro_f1=0.5672, dev_err=29.98%, es_counter1=0, es_counter2=0
2026-02-28 18:38:55,497 - lg_cotrain - INFO - Phase 3 epoch 17: dev_macro_f1=0.5707, dev_err=29.98%, es_counter1=0, es_counter2=0
2026-02-28 18:38:57,991 - lg_cotrain - INFO - Phase 3 epoch 18: dev_macro_f1=0.5675, dev_err=30.34%, es_counter1=1, es_counter2=1
2026-02-28 18:39:00,505 - lg_cotrain - INFO - Phase 3 epoch 19: dev_macro_f1=0.5615, dev_err=30.84%, es_counter1=2, es_counter2=2
2026-02-28 18:39:03,006 - lg_cotrain - INFO - Phase 3 epoch 20: dev_macro_f1=0.5627, dev_err=30.84%, es_counter1=3, es_counter2=3
2026-02-28 18:39:05,509 - lg_cotrain - INFO - Phase 3 epoch 21: dev_macro_f1=0.5621, dev_err=30.96%, es_counter1=4, es_counter2=4
2026-02-28 18:39:08,006 - lg_cotrain - INFO - Phase 3 epoch 22: dev_macro_f1=0.5584, dev_err=31.33%, es_counter1=5, es_counter2=5
2026-02-28 18:39:10,508 - lg_cotrain - INFO - Phase 3 epoch 23: dev_macro_f1=0.5593, dev_err=31.45%, es_counter1=6, es_counter2=6
2026-02-28 18:39:13,017 - lg_cotrain - INFO - Phase 3 epoch 24: dev_macro_f1=0.5570, dev_err=31.70%, es_counter1=7, es_counter2=7
2026-02-28 18:39:15,520 - lg_cotrain - INFO - Phase 3 epoch 25: dev_macro_f1=0.5533, dev_err=31.94%, es_counter1=8, es_counter2=8
2026-02-28 18:39:18,022 - lg_cotrain - INFO - Phase 3 epoch 26: dev_macro_f1=0.5521, dev_err=31.94%, es_counter1=9, es_counter2=9
2026-02-28 18:39:20,517 - lg_cotrain - INFO - Phase 3 epoch 27: dev_macro_f1=0.5521, dev_err=31.94%, es_counter1=10, es_counter2=10
2026-02-28 18:39:20,517 - lg_cotrain - INFO - Early stopping at epoch 27
2026-02-28 18:39:20,528 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-28 18:39:27,281 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmp_zii9l7c\kerala_floods_2018\5_set3\metrics.json
2026-02-28 18:39:27,282 - lg_cotrain - INFO - Test error rate: 31.80%, Test macro-F1: 0.4989, Test ECE: 0.1565
2026-02-28 18:39:27,292 - lg_cotrain - INFO - --- Trial 2/10 done: dev_macro_f1=0.5707 ---
2026-02-28 18:39:27,292 - lg_cotrain - INFO - --- Trial 3/10 ---
2026-02-28 18:39:27,823 - lg_cotrain - INFO - Starting LG-CoTrain: event=kerala_floods_2018, budget=5, seed_set=3
2026-02-28 18:39:27,862 - lg_cotrain - INFO - Detected 9 classes for event kerala_floods_2018: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-28 18:39:27,869 - lg_cotrain - INFO - D_l1: 27, D_l2: 18, D_LG: 5543
2026-02-28 18:39:27,870 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-28 18:39:49,380 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1067, mean_prob2=0.1298
2026-02-28 18:40:09,979 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1083, mean_prob2=0.1291
2026-02-28 18:40:30,619 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1098, mean_prob2=0.1287
2026-02-28 18:40:51,177 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1109, mean_prob2=0.1279
2026-02-28 18:41:11,736 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1101, mean_prob2=0.1279
2026-02-28 18:41:32,282 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1103, mean_prob2=0.1297
2026-02-28 18:41:52,905 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1132, mean_prob2=0.1311
2026-02-28 18:41:52,906 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-28 18:41:53,922 - lg_cotrain - INFO - LR scheduler: total_steps_1=9409, warmup=2382; total_steps_2=9309, warmup=2357
2026-02-28 18:41:53,922 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1132, range=[0.0586, 0.2041]
2026-02-28 18:41:53,923 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1311, range=[0.0360, 0.2896]
2026-02-28 18:43:24,512 - lg_cotrain - INFO - Phase 2 epoch 1/13: loss1=0.1956, loss2=0.1956, dev_macro_f1=0.1100, dev_err=43.61%
2026-02-28 18:44:55,252 - lg_cotrain - INFO - Phase 2 epoch 2/13: loss1=0.0962, loss2=0.1865, dev_macro_f1=0.3843, dev_err=31.70%
2026-02-28 18:46:25,972 - lg_cotrain - INFO - Phase 2 epoch 3/13: loss1=0.0541, loss2=0.1521, dev_macro_f1=0.4622, dev_err=28.75%
2026-02-28 18:47:56,603 - lg_cotrain - INFO - Phase 2 epoch 4/13: loss1=0.0318, loss2=0.1246, dev_macro_f1=0.4982, dev_err=27.89%
2026-02-28 18:49:27,276 - lg_cotrain - INFO - Phase 2 epoch 5/13: loss1=0.0242, loss2=0.0767, dev_macro_f1=0.5415, dev_err=26.90%
2026-02-28 18:50:58,167 - lg_cotrain - INFO - Phase 2 epoch 6/13: loss1=0.0163, loss2=0.0566, dev_macro_f1=0.5713, dev_err=25.68%
2026-02-28 18:52:29,034 - lg_cotrain - INFO - Phase 2 epoch 7/13: loss1=0.0127, loss2=0.0368, dev_macro_f1=0.5792, dev_err=25.92%
2026-02-28 18:53:59,863 - lg_cotrain - INFO - Phase 2 epoch 8/13: loss1=0.0097, loss2=0.0277, dev_macro_f1=0.5859, dev_err=26.41%
2026-02-28 18:55:30,670 - lg_cotrain - INFO - Phase 2 epoch 9/13: loss1=0.0081, loss2=0.0188, dev_macro_f1=0.5563, dev_err=27.15%
2026-02-28 18:57:01,454 - lg_cotrain - INFO - Phase 2 epoch 10/13: loss1=0.0071, loss2=0.0152, dev_macro_f1=0.5978, dev_err=25.55%
2026-02-28 18:58:32,193 - lg_cotrain - INFO - Phase 2 epoch 11/13: loss1=0.0070, loss2=0.0113, dev_macro_f1=0.5909, dev_err=26.54%
2026-02-28 19:00:02,989 - lg_cotrain - INFO - Phase 2 epoch 12/13: loss1=0.0070, loss2=0.0085, dev_macro_f1=0.6013, dev_err=26.41%
2026-02-28 19:01:33,596 - lg_cotrain - INFO - Phase 2 epoch 13/13: loss1=0.0079, loss2=0.0079, dev_macro_f1=0.6162, dev_err=26.04%
2026-02-28 19:01:33,596 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-28 19:01:36,717 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.6137, dev_err=26.17%, es_counter1=0, es_counter2=0
2026-02-28 19:01:39,814 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.6043, dev_err=26.66%, es_counter1=1, es_counter2=1
2026-02-28 19:01:42,916 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.6045, dev_err=26.78%, es_counter1=2, es_counter2=2
2026-02-28 19:01:46,025 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.6044, dev_err=27.03%, es_counter1=3, es_counter2=3
2026-02-28 19:01:49,141 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.6068, dev_err=26.90%, es_counter1=4, es_counter2=4
2026-02-28 19:01:52,259 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.6049, dev_err=27.03%, es_counter1=5, es_counter2=5
2026-02-28 19:01:55,388 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.6048, dev_err=27.15%, es_counter1=6, es_counter2=6
2026-02-28 19:01:58,503 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.6030, dev_err=27.52%, es_counter1=7, es_counter2=7
2026-02-28 19:02:01,619 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.6059, dev_err=27.27%, es_counter1=8, es_counter2=8
2026-02-28 19:02:04,735 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.6038, dev_err=27.76%, es_counter1=9, es_counter2=9
2026-02-28 19:02:04,735 - lg_cotrain - INFO - Early stopping at epoch 10
2026-02-28 19:02:04,743 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-28 19:02:13,006 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpzd0la4o6\kerala_floods_2018\5_set3\metrics.json
2026-02-28 19:02:13,007 - lg_cotrain - INFO - Test error rate: 28.89%, Test macro-F1: 0.5521, Test ECE: 0.2193
2026-02-28 19:02:13,017 - lg_cotrain - INFO - --- Trial 3/10 done: dev_macro_f1=0.6137 ---
2026-02-28 19:02:13,018 - lg_cotrain - INFO - --- Trial 4/10 ---
2026-02-28 19:02:13,589 - lg_cotrain - INFO - Starting LG-CoTrain: event=kerala_floods_2018, budget=5, seed_set=3
2026-02-28 19:02:13,636 - lg_cotrain - INFO - Detected 9 classes for event kerala_floods_2018: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-28 19:02:13,648 - lg_cotrain - INFO - D_l1: 27, D_l2: 18, D_LG: 5543
2026-02-28 19:02:13,650 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-28 19:02:31,581 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1114, mean_prob2=0.1226
2026-02-28 19:02:48,500 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1157, mean_prob2=0.1208
2026-02-28 19:03:05,406 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1120, mean_prob2=0.1233
2026-02-28 19:03:22,395 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1149, mean_prob2=0.1233
2026-02-28 19:03:39,347 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1187, mean_prob2=0.1295
2026-02-28 19:03:56,221 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1200, mean_prob2=0.1313
2026-02-28 19:04:13,168 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1237, mean_prob2=0.1270
2026-02-28 19:04:13,168 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-28 19:04:14,160 - lg_cotrain - INFO - LR scheduler: total_steps_1=1840, warmup=45; total_steps_2=1840, warmup=45
2026-02-28 19:04:14,160 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1237, range=[0.0504, 0.2913]
2026-02-28 19:04:14,161 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1270, range=[0.0258, 0.2825]
2026-02-28 19:05:18,208 - lg_cotrain - INFO - Phase 2 epoch 1/20: loss1=0.1555, loss2=0.1642, dev_macro_f1=0.4451, dev_err=30.59%
2026-02-28 19:06:22,451 - lg_cotrain - INFO - Phase 2 epoch 2/20: loss1=0.0551, loss2=0.1860, dev_macro_f1=0.5733, dev_err=25.31%
2026-02-28 19:07:26,731 - lg_cotrain - INFO - Phase 2 epoch 3/20: loss1=0.0293, loss2=0.1559, dev_macro_f1=0.5897, dev_err=26.41%
2026-02-28 19:08:30,899 - lg_cotrain - INFO - Phase 2 epoch 4/20: loss1=0.0184, loss2=0.1074, dev_macro_f1=0.6422, dev_err=25.43%
2026-02-28 19:09:37,631 - lg_cotrain - INFO - Phase 2 epoch 5/20: loss1=0.0154, loss2=0.0631, dev_macro_f1=0.6377, dev_err=25.68%
2026-02-28 19:10:42,282 - lg_cotrain - INFO - Phase 2 epoch 6/20: loss1=0.0180, loss2=0.0367, dev_macro_f1=0.6117, dev_err=26.66%
2026-02-28 19:11:47,081 - lg_cotrain - INFO - Phase 2 epoch 7/20: loss1=0.0144, loss2=0.0289, dev_macro_f1=0.6004, dev_err=27.40%
2026-02-28 19:12:51,565 - lg_cotrain - INFO - Phase 2 epoch 8/20: loss1=0.0137, loss2=0.0283, dev_macro_f1=0.6116, dev_err=27.03%
2026-02-28 19:13:56,089 - lg_cotrain - INFO - Phase 2 epoch 9/20: loss1=0.0164, loss2=0.0174, dev_macro_f1=0.5835, dev_err=27.64%
2026-02-28 19:15:00,590 - lg_cotrain - INFO - Phase 2 epoch 10/20: loss1=0.0123, loss2=0.0136, dev_macro_f1=0.5986, dev_err=27.76%
2026-02-28 19:16:05,068 - lg_cotrain - INFO - Phase 2 epoch 11/20: loss1=0.0068, loss2=0.0133, dev_macro_f1=0.6100, dev_err=27.40%
2026-02-28 19:17:09,407 - lg_cotrain - INFO - Phase 2 epoch 12/20: loss1=0.0044, loss2=0.0107, dev_macro_f1=0.6057, dev_err=27.40%
2026-02-28 19:18:13,678 - lg_cotrain - INFO - Phase 2 epoch 13/20: loss1=0.0052, loss2=0.0076, dev_macro_f1=0.6029, dev_err=27.76%
2026-02-28 19:19:17,841 - lg_cotrain - INFO - Phase 2 epoch 14/20: loss1=0.0031, loss2=0.0057, dev_macro_f1=0.6070, dev_err=27.27%
2026-02-28 19:20:22,273 - lg_cotrain - INFO - Phase 2 epoch 15/20: loss1=0.0034, loss2=0.0042, dev_macro_f1=0.6099, dev_err=27.40%
2026-02-28 19:21:26,710 - lg_cotrain - INFO - Phase 2 epoch 16/20: loss1=0.0035, loss2=0.0029, dev_macro_f1=0.6116, dev_err=26.90%
2026-02-28 19:22:31,322 - lg_cotrain - INFO - Phase 2 epoch 17/20: loss1=0.0044, loss2=0.0026, dev_macro_f1=0.6019, dev_err=27.76%
2026-02-28 19:23:36,393 - lg_cotrain - INFO - Phase 2 epoch 18/20: loss1=0.0046, loss2=0.0032, dev_macro_f1=0.6029, dev_err=27.27%
2026-02-28 19:24:42,835 - lg_cotrain - INFO - Phase 2 epoch 19/20: loss1=0.0047, loss2=0.0020, dev_macro_f1=0.6032, dev_err=27.15%
2026-02-28 19:25:47,741 - lg_cotrain - INFO - Phase 2 epoch 20/20: loss1=0.0041, loss2=0.0023, dev_macro_f1=0.6013, dev_err=27.27%
2026-02-28 19:25:47,741 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-28 19:25:50,289 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.6030, dev_err=27.15%, es_counter1=0, es_counter2=0
2026-02-28 19:25:52,812 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.5972, dev_err=27.64%, es_counter1=1, es_counter2=1
2026-02-28 19:25:55,326 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.5930, dev_err=27.89%, es_counter1=2, es_counter2=2
2026-02-28 19:25:57,822 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.5960, dev_err=27.76%, es_counter1=3, es_counter2=3
2026-02-28 19:26:00,330 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.5935, dev_err=28.01%, es_counter1=4, es_counter2=4
2026-02-28 19:26:02,831 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.6021, dev_err=28.01%, es_counter1=5, es_counter2=5
2026-02-28 19:26:02,832 - lg_cotrain - INFO - Early stopping at epoch 6
2026-02-28 19:26:02,848 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-28 19:26:09,620 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmp3uh_3t8k\kerala_floods_2018\5_set3\metrics.json
2026-02-28 19:26:09,620 - lg_cotrain - INFO - Test error rate: 28.95%, Test macro-F1: 0.5612, Test ECE: 0.2228
2026-02-28 19:26:09,630 - lg_cotrain - INFO - --- Trial 4/10 done: dev_macro_f1=0.6030 ---
2026-02-28 19:26:09,630 - lg_cotrain - INFO - --- Trial 5/10 ---
2026-02-28 19:26:10,193 - lg_cotrain - INFO - Starting LG-CoTrain: event=kerala_floods_2018, budget=5, seed_set=3
2026-02-28 19:26:10,240 - lg_cotrain - INFO - Detected 9 classes for event kerala_floods_2018: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-28 19:26:10,248 - lg_cotrain - INFO - D_l1: 27, D_l2: 18, D_LG: 5543
2026-02-28 19:26:10,250 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-28 19:26:31,838 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1045, mean_prob2=0.1297
2026-02-28 19:26:52,558 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1075, mean_prob2=0.1271
2026-02-28 19:27:13,465 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1110, mean_prob2=0.1255
2026-02-28 19:27:34,250 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1145, mean_prob2=0.1265
2026-02-28 19:27:55,011 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1168, mean_prob2=0.1277
2026-02-28 19:28:15,714 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1172, mean_prob2=0.1296
2026-02-28 19:28:36,707 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1188, mean_prob2=0.1280
2026-02-28 19:28:36,707 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-28 19:28:37,848 - lg_cotrain - INFO - LR scheduler: total_steps_1=7330, warmup=246; total_steps_2=7230, warmup=242
2026-02-28 19:28:37,848 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1188, range=[0.0405, 0.2942]
2026-02-28 19:28:37,848 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1280, range=[0.0332, 0.2715]
2026-02-28 19:30:09,048 - lg_cotrain - INFO - Phase 2 epoch 1/10: loss1=0.1297, loss2=0.1270, dev_macro_f1=0.5331, dev_err=28.13%
2026-02-28 19:31:41,403 - lg_cotrain - INFO - Phase 2 epoch 2/10: loss1=0.0469, loss2=0.1799, dev_macro_f1=0.5632, dev_err=26.29%
2026-02-28 19:33:14,440 - lg_cotrain - INFO - Phase 2 epoch 3/10: loss1=0.0256, loss2=0.1264, dev_macro_f1=0.6048, dev_err=26.29%
2026-02-28 19:34:49,663 - lg_cotrain - INFO - Phase 2 epoch 4/10: loss1=0.0140, loss2=0.0659, dev_macro_f1=0.6206, dev_err=26.54%
2026-02-28 19:36:21,184 - lg_cotrain - INFO - Phase 2 epoch 5/10: loss1=0.0157, loss2=0.0377, dev_macro_f1=0.6108, dev_err=26.90%
2026-02-28 19:37:52,683 - lg_cotrain - INFO - Phase 2 epoch 6/10: loss1=0.0091, loss2=0.0222, dev_macro_f1=0.6278, dev_err=26.41%
2026-02-28 19:39:24,085 - lg_cotrain - INFO - Phase 2 epoch 7/10: loss1=0.0047, loss2=0.0148, dev_macro_f1=0.5977, dev_err=26.90%
2026-02-28 19:40:55,429 - lg_cotrain - INFO - Phase 2 epoch 8/10: loss1=0.0040, loss2=0.0104, dev_macro_f1=0.6172, dev_err=26.66%
2026-02-28 19:42:27,676 - lg_cotrain - INFO - Phase 2 epoch 9/10: loss1=0.0040, loss2=0.0071, dev_macro_f1=0.6080, dev_err=26.66%
2026-02-28 19:44:00,997 - lg_cotrain - INFO - Phase 2 epoch 10/10: loss1=0.0030, loss2=0.0048, dev_macro_f1=0.6159, dev_err=26.54%
2026-02-28 19:44:00,997 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-28 19:44:04,226 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.6155, dev_err=26.66%, es_counter1=0, es_counter2=0
2026-02-28 19:44:07,354 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.6145, dev_err=26.78%, es_counter1=1, es_counter2=1
2026-02-28 19:44:10,472 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.6144, dev_err=26.90%, es_counter1=2, es_counter2=2
2026-02-28 19:44:13,615 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.6112, dev_err=27.15%, es_counter1=3, es_counter2=3
2026-02-28 19:44:16,749 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.6103, dev_err=27.15%, es_counter1=4, es_counter2=4
2026-02-28 19:44:19,894 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.6107, dev_err=27.27%, es_counter1=5, es_counter2=5
2026-02-28 19:44:23,105 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.6140, dev_err=27.15%, es_counter1=6, es_counter2=6
2026-02-28 19:44:23,105 - lg_cotrain - INFO - Early stopping at epoch 7
2026-02-28 19:44:23,116 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-28 19:44:31,542 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmp65tmupwm\kerala_floods_2018\5_set3\metrics.json
2026-02-28 19:44:31,542 - lg_cotrain - INFO - Test error rate: 29.33%, Test macro-F1: 0.5604, Test ECE: 0.2214
2026-02-28 19:44:31,554 - lg_cotrain - INFO - --- Trial 5/10 done: dev_macro_f1=0.6155 ---
2026-02-28 19:44:31,554 - lg_cotrain - INFO - --- Trial 6/10 ---
2026-02-28 19:44:32,075 - lg_cotrain - INFO - Starting LG-CoTrain: event=kerala_floods_2018, budget=5, seed_set=3
2026-02-28 19:44:32,126 - lg_cotrain - INFO - Detected 9 classes for event kerala_floods_2018: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-28 19:44:32,133 - lg_cotrain - INFO - D_l1: 27, D_l2: 18, D_LG: 5543
2026-02-28 19:44:32,135 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-28 19:44:50,531 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1067, mean_prob2=0.1067
2026-02-28 19:45:08,169 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1011, mean_prob2=0.1101
2026-02-28 19:45:25,650 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1221, mean_prob2=0.1158
2026-02-28 19:45:43,379 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1093, mean_prob2=0.1240
2026-02-28 19:46:01,194 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1186, mean_prob2=0.1419
2026-02-28 19:46:18,666 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1409, mean_prob2=0.1520
2026-02-28 19:46:35,756 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1305, mean_prob2=0.1565
2026-02-28 19:46:35,756 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-28 19:46:36,716 - lg_cotrain - INFO - LR scheduler: total_steps_1=1231, warmup=204; total_steps_2=1231, warmup=204
2026-02-28 19:46:36,717 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1305, range=[0.0277, 0.3884]
2026-02-28 19:46:36,717 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1565, range=[0.0181, 0.4639]
2026-02-28 19:47:47,049 - lg_cotrain - INFO - Phase 2 epoch 1/13: loss1=0.1914, loss2=0.1796, dev_macro_f1=0.4407, dev_err=30.22%
2026-02-28 19:48:55,252 - lg_cotrain - INFO - Phase 2 epoch 2/13: loss1=0.0671, loss2=0.2279, dev_macro_f1=0.5712, dev_err=25.43%
2026-02-28 19:50:01,577 - lg_cotrain - INFO - Phase 2 epoch 3/13: loss1=0.0632, loss2=0.2500, dev_macro_f1=0.4789, dev_err=29.73%
2026-02-28 19:51:06,496 - lg_cotrain - INFO - Phase 2 epoch 4/13: loss1=0.0552, loss2=0.2075, dev_macro_f1=0.5509, dev_err=28.13%
2026-02-28 19:52:11,181 - lg_cotrain - INFO - Phase 2 epoch 5/13: loss1=0.0393, loss2=0.1544, dev_macro_f1=0.5561, dev_err=29.12%
2026-02-28 19:53:15,837 - lg_cotrain - INFO - Phase 2 epoch 6/13: loss1=0.0303, loss2=0.0963, dev_macro_f1=0.5681, dev_err=28.50%
2026-02-28 19:54:20,494 - lg_cotrain - INFO - Phase 2 epoch 7/13: loss1=0.0265, loss2=0.0740, dev_macro_f1=0.5693, dev_err=29.73%
2026-02-28 19:55:25,124 - lg_cotrain - INFO - Phase 2 epoch 8/13: loss1=0.0247, loss2=0.0689, dev_macro_f1=0.5857, dev_err=27.89%
2026-02-28 19:56:29,756 - lg_cotrain - INFO - Phase 2 epoch 9/13: loss1=0.0214, loss2=0.0361, dev_macro_f1=0.5800, dev_err=28.26%
2026-02-28 19:57:34,441 - lg_cotrain - INFO - Phase 2 epoch 10/13: loss1=0.0140, loss2=0.0334, dev_macro_f1=0.5414, dev_err=30.10%
2026-02-28 19:58:39,063 - lg_cotrain - INFO - Phase 2 epoch 11/13: loss1=0.0070, loss2=0.0255, dev_macro_f1=0.5766, dev_err=28.38%
2026-02-28 19:59:43,716 - lg_cotrain - INFO - Phase 2 epoch 12/13: loss1=0.0078, loss2=0.0129, dev_macro_f1=0.5803, dev_err=28.38%
2026-02-28 20:00:48,501 - lg_cotrain - INFO - Phase 2 epoch 13/13: loss1=0.0051, loss2=0.0060, dev_macro_f1=0.5710, dev_err=29.24%
2026-02-28 20:00:48,501 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-28 20:00:51,038 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.5729, dev_err=28.99%, es_counter1=0, es_counter2=0
2026-02-28 20:00:53,565 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.5750, dev_err=28.75%, es_counter1=0, es_counter2=0
2026-02-28 20:00:56,081 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.5738, dev_err=28.87%, es_counter1=1, es_counter2=1
2026-02-28 20:00:58,593 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.5712, dev_err=29.12%, es_counter1=2, es_counter2=2
2026-02-28 20:01:01,109 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.5694, dev_err=29.36%, es_counter1=3, es_counter2=3
2026-02-28 20:01:03,613 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.5708, dev_err=29.61%, es_counter1=4, es_counter2=4
2026-02-28 20:01:03,613 - lg_cotrain - INFO - Early stopping at epoch 6
2026-02-28 20:01:03,622 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-28 20:01:10,454 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpuu0pb2tl\kerala_floods_2018\5_set3\metrics.json
2026-02-28 20:01:10,454 - lg_cotrain - INFO - Test error rate: 29.01%, Test macro-F1: 0.5606, Test ECE: 0.2041
2026-02-28 20:01:10,465 - lg_cotrain - INFO - --- Trial 6/10 done: dev_macro_f1=0.5750 ---
2026-02-28 20:01:10,466 - lg_cotrain - INFO - --- Trial 7/10 ---
2026-02-28 20:01:10,971 - lg_cotrain - INFO - Starting LG-CoTrain: event=kerala_floods_2018, budget=5, seed_set=3
2026-02-28 20:01:11,013 - lg_cotrain - INFO - Detected 9 classes for event kerala_floods_2018: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-28 20:01:11,021 - lg_cotrain - INFO - D_l1: 27, D_l2: 18, D_LG: 5543
2026-02-28 20:01:11,022 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-28 20:01:29,073 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1115, mean_prob2=0.1253
2026-02-28 20:01:46,134 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1121, mean_prob2=0.1235
2026-02-28 20:02:03,186 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1114, mean_prob2=0.1256
2026-02-28 20:02:20,302 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1138, mean_prob2=0.1259
2026-02-28 20:02:37,351 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1144, mean_prob2=0.1284
2026-02-28 20:02:54,395 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1139, mean_prob2=0.1306
2026-02-28 20:03:11,487 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1152, mean_prob2=0.1296
2026-02-28 20:03:11,487 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-28 20:03:12,505 - lg_cotrain - INFO - LR scheduler: total_steps_1=709, warmup=15; total_steps_2=709, warmup=15
2026-02-28 20:03:12,505 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1152, range=[0.0508, 0.2147]
2026-02-28 20:03:12,506 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1296, range=[0.0290, 0.2728]
2026-02-28 20:04:17,040 - lg_cotrain - INFO - Phase 2 epoch 1/7: loss1=0.1514, loss2=0.1506, dev_macro_f1=0.4345, dev_err=30.34%
2026-02-28 20:05:21,476 - lg_cotrain - INFO - Phase 2 epoch 2/7: loss1=0.0579, loss2=0.1705, dev_macro_f1=0.4967, dev_err=27.15%
2026-02-28 20:06:25,813 - lg_cotrain - INFO - Phase 2 epoch 3/7: loss1=0.0327, loss2=0.1180, dev_macro_f1=0.5768, dev_err=26.78%
2026-02-28 20:07:30,112 - lg_cotrain - INFO - Phase 2 epoch 4/7: loss1=0.0240, loss2=0.0906, dev_macro_f1=0.5725, dev_err=26.66%
2026-02-28 20:08:34,368 - lg_cotrain - INFO - Phase 2 epoch 5/7: loss1=0.0156, loss2=0.0552, dev_macro_f1=0.5862, dev_err=27.27%
2026-02-28 20:09:38,582 - lg_cotrain - INFO - Phase 2 epoch 6/7: loss1=0.0110, loss2=0.0356, dev_macro_f1=0.5935, dev_err=26.66%
2026-02-28 20:10:42,776 - lg_cotrain - INFO - Phase 2 epoch 7/7: loss1=0.0085, loss2=0.0251, dev_macro_f1=0.5918, dev_err=26.78%
2026-02-28 20:10:42,777 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-28 20:10:45,273 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.6059, dev_err=26.54%, es_counter1=0, es_counter2=0
2026-02-28 20:10:47,801 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.6100, dev_err=26.29%, es_counter1=0, es_counter2=0
2026-02-28 20:10:50,296 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.6095, dev_err=27.03%, es_counter1=1, es_counter2=1
2026-02-28 20:10:52,796 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.6040, dev_err=27.64%, es_counter1=2, es_counter2=2
2026-02-28 20:10:55,295 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.5953, dev_err=28.75%, es_counter1=3, es_counter2=3
2026-02-28 20:10:57,795 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.5914, dev_err=29.48%, es_counter1=4, es_counter2=4
2026-02-28 20:11:00,297 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.5934, dev_err=29.73%, es_counter1=5, es_counter2=5
2026-02-28 20:11:02,801 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.5913, dev_err=30.34%, es_counter1=6, es_counter2=6
2026-02-28 20:11:05,288 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.5694, dev_err=32.43%, es_counter1=7, es_counter2=7
2026-02-28 20:11:07,787 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.5637, dev_err=32.92%, es_counter1=8, es_counter2=8
2026-02-28 20:11:10,279 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.5585, dev_err=33.29%, es_counter1=9, es_counter2=9
2026-02-28 20:11:12,768 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.5513, dev_err=34.40%, es_counter1=10, es_counter2=10
2026-02-28 20:11:12,768 - lg_cotrain - INFO - Early stopping at epoch 12
2026-02-28 20:11:12,777 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-28 20:11:19,522 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpn773nklw\kerala_floods_2018\5_set3\metrics.json
2026-02-28 20:11:19,522 - lg_cotrain - INFO - Test error rate: 28.45%, Test macro-F1: 0.5658, Test ECE: 0.1931
2026-02-28 20:11:19,532 - lg_cotrain - INFO - --- Trial 7/10 done: dev_macro_f1=0.6100 ---
2026-02-28 20:11:19,533 - lg_cotrain - INFO - --- Trial 8/10 ---
2026-02-28 20:11:20,042 - lg_cotrain - INFO - Starting LG-CoTrain: event=kerala_floods_2018, budget=5, seed_set=3
2026-02-28 20:11:20,084 - lg_cotrain - INFO - Detected 9 classes for event kerala_floods_2018: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-28 20:11:20,091 - lg_cotrain - INFO - D_l1: 27, D_l2: 18, D_LG: 5543
2026-02-28 20:11:20,092 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-28 20:11:38,443 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1123, mean_prob2=0.1034
2026-02-28 20:11:55,903 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.0833, mean_prob2=0.1128
2026-02-28 20:12:13,343 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.0921, mean_prob2=0.0753
2026-02-28 20:12:30,733 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1440, mean_prob2=0.1294
2026-02-28 20:12:48,088 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1289, mean_prob2=0.1092
2026-02-28 20:13:05,424 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1009, mean_prob2=0.1223
2026-02-28 20:13:22,790 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.0954, mean_prob2=0.1168
2026-02-28 20:13:22,790 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-28 20:13:23,864 - lg_cotrain - INFO - LR scheduler: total_steps_1=1666, warmup=493; total_steps_2=1666, warmup=493
2026-02-28 20:13:23,864 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.0954, range=[0.0823, 0.1481]
2026-02-28 20:13:23,864 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1168, range=[0.0838, 0.1710]
2026-02-28 20:14:32,736 - lg_cotrain - INFO - Phase 2 epoch 1/9: loss1=0.1273, loss2=0.1224, dev_macro_f1=0.4352, dev_err=29.73%
2026-02-28 20:15:41,309 - lg_cotrain - INFO - Phase 2 epoch 2/9: loss1=0.1219, loss2=0.7354, dev_macro_f1=0.0777, dev_err=46.19%
2026-02-28 20:16:49,754 - lg_cotrain - INFO - Phase 2 epoch 3/9: loss1=0.0538, loss2=0.6266, dev_macro_f1=0.0777, dev_err=46.19%
2026-02-28 20:17:58,334 - lg_cotrain - INFO - Phase 2 epoch 4/9: loss1=0.0328, loss2=0.5637, dev_macro_f1=0.0777, dev_err=46.19%
2026-02-28 20:19:06,869 - lg_cotrain - INFO - Phase 2 epoch 5/9: loss1=0.0257, loss2=0.5193, dev_macro_f1=0.0777, dev_err=46.19%
2026-02-28 20:20:15,373 - lg_cotrain - INFO - Phase 2 epoch 6/9: loss1=0.0196, loss2=0.4792, dev_macro_f1=0.0777, dev_err=46.19%
2026-02-28 20:21:23,839 - lg_cotrain - INFO - Phase 2 epoch 7/9: loss1=0.0159, loss2=0.4503, dev_macro_f1=0.0777, dev_err=46.19%
2026-02-28 20:22:32,360 - lg_cotrain - INFO - Phase 2 epoch 8/9: loss1=0.0141, loss2=0.4249, dev_macro_f1=0.0777, dev_err=46.19%
2026-02-28 20:23:40,814 - lg_cotrain - INFO - Phase 2 epoch 9/9: loss1=0.0133, loss2=0.3997, dev_macro_f1=0.0777, dev_err=46.19%
2026-02-28 20:23:40,814 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-28 20:23:43,378 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.0777, dev_err=46.19%, es_counter1=0, es_counter2=0
2026-02-28 20:23:45,916 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.0777, dev_err=46.19%, es_counter1=1, es_counter2=1
2026-02-28 20:23:48,456 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.0777, dev_err=46.19%, es_counter1=2, es_counter2=2
2026-02-28 20:23:51,012 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.0777, dev_err=46.19%, es_counter1=3, es_counter2=3
2026-02-28 20:23:53,571 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.0777, dev_err=46.19%, es_counter1=4, es_counter2=4
2026-02-28 20:23:56,134 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.0777, dev_err=46.19%, es_counter1=5, es_counter2=5
2026-02-28 20:23:58,677 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.0777, dev_err=46.19%, es_counter1=6, es_counter2=6
2026-02-28 20:24:01,226 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.0777, dev_err=46.19%, es_counter1=7, es_counter2=7
2026-02-28 20:24:03,786 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.0777, dev_err=46.19%, es_counter1=8, es_counter2=8
2026-02-28 20:24:06,343 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.0777, dev_err=46.19%, es_counter1=9, es_counter2=9
2026-02-28 20:24:08,887 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.0777, dev_err=46.19%, es_counter1=10, es_counter2=10
2026-02-28 20:24:08,887 - lg_cotrain - INFO - Early stopping at epoch 11
2026-02-28 20:24:08,898 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-28 20:24:15,796 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmp488fwnjh\kerala_floods_2018\5_set3\metrics.json
2026-02-28 20:24:15,796 - lg_cotrain - INFO - Test error rate: 46.21%, Test macro-F1: 0.0777, Test ECE: 0.4013
2026-02-28 20:24:15,807 - lg_cotrain - INFO - --- Trial 8/10 done: dev_macro_f1=0.0777 ---
2026-02-28 20:24:15,807 - lg_cotrain - INFO - --- Trial 9/10 ---
2026-02-28 20:24:16,374 - lg_cotrain - INFO - Starting LG-CoTrain: event=kerala_floods_2018, budget=5, seed_set=3
2026-02-28 20:24:16,445 - lg_cotrain - INFO - Detected 9 classes for event kerala_floods_2018: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-28 20:24:16,456 - lg_cotrain - INFO - D_l1: 27, D_l2: 18, D_LG: 5543
2026-02-28 20:24:16,457 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-28 20:24:37,981 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.0997, mean_prob2=0.0976
2026-02-28 20:24:58,532 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1071, mean_prob2=0.1110
2026-02-28 20:25:19,157 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1074, mean_prob2=0.1219
2026-02-28 20:25:39,766 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1221, mean_prob2=0.1098
2026-02-28 20:26:00,290 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1258, mean_prob2=0.1148
2026-02-28 20:26:20,882 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1236, mean_prob2=0.1366
2026-02-28 20:26:41,435 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1476, mean_prob2=0.1478
2026-02-28 20:26:41,436 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-28 20:26:42,430 - lg_cotrain - INFO - LR scheduler: total_steps_1=8716, warmup=878; total_steps_2=8616, warmup=868
2026-02-28 20:26:42,431 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1476, range=[0.0192, 0.4576]
2026-02-28 20:26:42,431 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1478, range=[0.0180, 0.2684]
2026-02-28 20:28:12,922 - lg_cotrain - INFO - Phase 2 epoch 1/12: loss1=0.1357, loss2=0.1484, dev_macro_f1=0.5247, dev_err=29.48%
2026-02-28 20:29:44,066 - lg_cotrain - INFO - Phase 2 epoch 2/12: loss1=0.0563, loss2=0.3818, dev_macro_f1=0.5008, dev_err=30.59%
2026-02-28 20:31:14,751 - lg_cotrain - INFO - Phase 2 epoch 3/12: loss1=0.0379, loss2=0.2703, dev_macro_f1=0.5966, dev_err=28.38%
2026-02-28 20:32:45,604 - lg_cotrain - INFO - Phase 2 epoch 4/12: loss1=0.0329, loss2=0.1996, dev_macro_f1=0.5329, dev_err=29.48%
2026-02-28 20:34:16,268 - lg_cotrain - INFO - Phase 2 epoch 5/12: loss1=0.0299, loss2=0.1272, dev_macro_f1=0.5599, dev_err=28.13%
2026-02-28 20:35:46,949 - lg_cotrain - INFO - Phase 2 epoch 6/12: loss1=0.0240, loss2=0.0771, dev_macro_f1=0.5699, dev_err=28.13%
2026-02-28 20:37:17,597 - lg_cotrain - INFO - Phase 2 epoch 7/12: loss1=0.0223, loss2=0.0561, dev_macro_f1=0.5578, dev_err=29.98%
2026-02-28 20:38:48,810 - lg_cotrain - INFO - Phase 2 epoch 8/12: loss1=0.0150, loss2=0.0291, dev_macro_f1=0.5702, dev_err=28.87%
2026-02-28 20:40:20,161 - lg_cotrain - INFO - Phase 2 epoch 9/12: loss1=0.0089, loss2=0.0209, dev_macro_f1=0.5539, dev_err=28.62%
2026-02-28 20:41:50,829 - lg_cotrain - INFO - Phase 2 epoch 10/12: loss1=0.0053, loss2=0.0096, dev_macro_f1=0.5743, dev_err=27.89%
2026-02-28 20:43:21,664 - lg_cotrain - INFO - Phase 2 epoch 11/12: loss1=0.0049, loss2=0.0102, dev_macro_f1=0.5569, dev_err=29.24%
2026-02-28 20:44:52,273 - lg_cotrain - INFO - Phase 2 epoch 12/12: loss1=0.0031, loss2=0.0043, dev_macro_f1=0.5523, dev_err=29.48%
2026-02-28 20:44:52,273 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-28 20:44:55,412 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.5536, dev_err=29.61%, es_counter1=0, es_counter2=0
2026-02-28 20:44:58,522 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.5515, dev_err=29.85%, es_counter1=1, es_counter2=1
2026-02-28 20:45:01,664 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.5623, dev_err=29.61%, es_counter1=0, es_counter2=0
2026-02-28 20:45:04,807 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.5659, dev_err=29.73%, es_counter1=0, es_counter2=0
2026-02-28 20:45:07,908 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.5608, dev_err=30.10%, es_counter1=1, es_counter2=1
2026-02-28 20:45:11,022 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.5554, dev_err=30.34%, es_counter1=2, es_counter2=2
2026-02-28 20:45:14,133 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.5490, dev_err=30.71%, es_counter1=3, es_counter2=3
2026-02-28 20:45:17,221 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.5433, dev_err=31.08%, es_counter1=4, es_counter2=4
2026-02-28 20:45:20,321 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.5460, dev_err=30.96%, es_counter1=5, es_counter2=5
2026-02-28 20:45:23,458 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.5403, dev_err=31.33%, es_counter1=6, es_counter2=6
2026-02-28 20:45:26,587 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.5310, dev_err=31.45%, es_counter1=7, es_counter2=7
2026-02-28 20:45:29,702 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.5345, dev_err=31.33%, es_counter1=8, es_counter2=8
2026-02-28 20:45:32,830 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.5331, dev_err=31.45%, es_counter1=9, es_counter2=9
2026-02-28 20:45:35,940 - lg_cotrain - INFO - Phase 3 epoch 14: dev_macro_f1=0.5356, dev_err=31.08%, es_counter1=10, es_counter2=10
2026-02-28 20:45:35,940 - lg_cotrain - INFO - Early stopping at epoch 14
2026-02-28 20:45:35,950 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-28 20:45:44,211 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmp9sid7708\kerala_floods_2018\5_set3\metrics.json
2026-02-28 20:45:44,212 - lg_cotrain - INFO - Test error rate: 30.28%, Test macro-F1: 0.5496, Test ECE: 0.2003
2026-02-28 20:45:44,225 - lg_cotrain - INFO - --- Trial 9/10 done: dev_macro_f1=0.5659 ---
2026-02-28 20:45:44,225 - lg_cotrain - INFO - --- Trial 10/10 ---
2026-02-28 20:45:44,719 - lg_cotrain - INFO - Starting LG-CoTrain: event=kerala_floods_2018, budget=5, seed_set=3
2026-02-28 20:45:44,754 - lg_cotrain - INFO - Detected 9 classes for event kerala_floods_2018: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-28 20:45:44,761 - lg_cotrain - INFO - D_l1: 27, D_l2: 18, D_LG: 5543
2026-02-28 20:45:44,762 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-28 20:46:03,426 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1109, mean_prob2=0.1280
2026-02-28 20:46:20,944 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1118, mean_prob2=0.1266
2026-02-28 20:46:38,422 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1121, mean_prob2=0.1254
2026-02-28 20:46:55,977 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1130, mean_prob2=0.1260
2026-02-28 20:47:13,446 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1139, mean_prob2=0.1264
2026-02-28 20:47:31,037 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1145, mean_prob2=0.1266
2026-02-28 20:47:48,753 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1153, mean_prob2=0.1274
2026-02-28 20:47:48,753 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-28 20:47:49,798 - lg_cotrain - INFO - LR scheduler: total_steps_1=2536, warmup=336; total_steps_2=2536, warmup=336
2026-02-28 20:47:49,798 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1153, range=[0.0524, 0.2326]
2026-02-28 20:47:49,798 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1274, range=[0.0386, 0.2626]
2026-02-28 20:48:58,829 - lg_cotrain - INFO - Phase 2 epoch 1/14: loss1=0.1917, loss2=0.1954, dev_macro_f1=0.1336, dev_err=42.51%
2026-02-28 20:50:07,907 - lg_cotrain - INFO - Phase 2 epoch 2/14: loss1=0.0884, loss2=0.1809, dev_macro_f1=0.4046, dev_err=30.34%
2026-02-28 20:51:17,061 - lg_cotrain - INFO - Phase 2 epoch 3/14: loss1=0.0411, loss2=0.1469, dev_macro_f1=0.4663, dev_err=28.01%
2026-02-28 20:52:26,025 - lg_cotrain - INFO - Phase 2 epoch 4/14: loss1=0.0243, loss2=0.0998, dev_macro_f1=0.5060, dev_err=28.01%
2026-02-28 20:53:35,038 - lg_cotrain - INFO - Phase 2 epoch 5/14: loss1=0.0216, loss2=0.0790, dev_macro_f1=0.5436, dev_err=26.66%
2026-02-28 20:54:44,097 - lg_cotrain - INFO - Phase 2 epoch 6/14: loss1=0.0145, loss2=0.0567, dev_macro_f1=0.5574, dev_err=26.41%
2026-02-28 20:55:53,163 - lg_cotrain - INFO - Phase 2 epoch 7/14: loss1=0.0127, loss2=0.0340, dev_macro_f1=0.5476, dev_err=27.03%
2026-02-28 20:57:02,290 - lg_cotrain - INFO - Phase 2 epoch 8/14: loss1=0.0109, loss2=0.0254, dev_macro_f1=0.5559, dev_err=27.27%
2026-02-28 20:58:11,376 - lg_cotrain - INFO - Phase 2 epoch 9/14: loss1=0.0112, loss2=0.0194, dev_macro_f1=0.5587, dev_err=27.52%
2026-02-28 20:59:20,434 - lg_cotrain - INFO - Phase 2 epoch 10/14: loss1=0.0090, loss2=0.0161, dev_macro_f1=0.5879, dev_err=26.66%
2026-02-28 21:00:29,705 - lg_cotrain - INFO - Phase 2 epoch 11/14: loss1=0.0074, loss2=0.0128, dev_macro_f1=0.5710, dev_err=27.27%
2026-02-28 21:01:38,661 - lg_cotrain - INFO - Phase 2 epoch 12/14: loss1=0.0083, loss2=0.0111, dev_macro_f1=0.5736, dev_err=27.40%
2026-02-28 21:02:47,639 - lg_cotrain - INFO - Phase 2 epoch 13/14: loss1=0.0080, loss2=0.0100, dev_macro_f1=0.6006, dev_err=26.78%
2026-02-28 21:03:56,616 - lg_cotrain - INFO - Phase 2 epoch 14/14: loss1=0.0075, loss2=0.0094, dev_macro_f1=0.6053, dev_err=26.66%
2026-02-28 21:03:56,616 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-28 21:03:59,224 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.6051, dev_err=26.66%, es_counter1=0, es_counter2=0
2026-02-28 21:04:01,802 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.6051, dev_err=26.54%, es_counter1=1, es_counter2=1
2026-02-28 21:04:04,372 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.6035, dev_err=26.54%, es_counter1=2, es_counter2=2
2026-02-28 21:04:06,951 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.6047, dev_err=26.66%, es_counter1=3, es_counter2=3
2026-02-28 21:04:09,525 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.6027, dev_err=26.90%, es_counter1=4, es_counter2=4
2026-02-28 21:04:12,094 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.6050, dev_err=26.78%, es_counter1=5, es_counter2=5
2026-02-28 21:04:14,681 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.6044, dev_err=26.78%, es_counter1=6, es_counter2=6
2026-02-28 21:04:17,265 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.5960, dev_err=27.27%, es_counter1=7, es_counter2=7
2026-02-28 21:04:17,265 - lg_cotrain - INFO - Early stopping at epoch 8
2026-02-28 21:04:17,275 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-28 21:04:24,259 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmp9dhhj7_n\kerala_floods_2018\5_set3\metrics.json
2026-02-28 21:04:24,261 - lg_cotrain - INFO - Test error rate: 28.63%, Test macro-F1: 0.5530, Test ECE: 0.2172
2026-02-28 21:04:24,271 - lg_cotrain - INFO - --- Trial 10/10 done: dev_macro_f1=0.6051 ---
