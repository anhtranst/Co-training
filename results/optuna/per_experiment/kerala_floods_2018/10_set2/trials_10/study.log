2026-02-28 21:04:24,359 - lg_cotrain - INFO - === Optuna study: kerala_floods_2018 budget=10 seed=2 | target=10 trials, 0 replayed, 10 new ===
2026-02-28 21:04:24,359 - lg_cotrain - INFO - --- Trial 1/10 ---
2026-02-28 21:04:24,867 - lg_cotrain - INFO - Starting LG-CoTrain: event=kerala_floods_2018, budget=10, seed_set=2
2026-02-28 21:04:24,928 - lg_cotrain - INFO - Detected 9 classes for event kerala_floods_2018: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-28 21:04:24,935 - lg_cotrain - INFO - D_l1: 45, D_l2: 45, D_LG: 5498
2026-02-28 21:04:24,938 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-28 21:04:42,851 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.1081, mean_prob2=0.1296
2026-02-28 21:04:59,790 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1075, mean_prob2=0.1273
2026-02-28 21:05:16,761 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.1071, mean_prob2=0.1249
2026-02-28 21:05:33,687 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1075, mean_prob2=0.1230
2026-02-28 21:05:50,597 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1066, mean_prob2=0.1207
2026-02-28 21:06:07,362 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1066, mean_prob2=0.1176
2026-02-28 21:06:24,139 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1086, mean_prob2=0.1135
2026-02-28 21:06:24,140 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-28 21:06:25,106 - lg_cotrain - INFO - LR scheduler: total_steps_1=874, warmup=78; total_steps_2=874, warmup=78
2026-02-28 21:06:25,106 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1086, range=[0.0422, 0.2403]
2026-02-28 21:06:25,107 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1135, range=[0.0441, 0.2453]
2026-02-28 21:07:28,492 - lg_cotrain - INFO - Phase 2 epoch 1/9: loss1=0.1836, loss2=0.1980, dev_macro_f1=0.2623, dev_err=35.87%
2026-02-28 21:08:31,887 - lg_cotrain - INFO - Phase 2 epoch 2/9: loss1=0.0770, loss2=0.1788, dev_macro_f1=0.4699, dev_err=27.27%
2026-02-28 21:09:35,329 - lg_cotrain - INFO - Phase 2 epoch 3/9: loss1=0.0384, loss2=0.1473, dev_macro_f1=0.5266, dev_err=25.18%
2026-02-28 21:10:38,856 - lg_cotrain - INFO - Phase 2 epoch 4/9: loss1=0.0266, loss2=0.1009, dev_macro_f1=0.5316, dev_err=25.43%
2026-02-28 21:11:42,448 - lg_cotrain - INFO - Phase 2 epoch 5/9: loss1=0.0198, loss2=0.0733, dev_macro_f1=0.5530, dev_err=24.82%
2026-02-28 21:12:46,636 - lg_cotrain - INFO - Phase 2 epoch 6/9: loss1=0.0148, loss2=0.0501, dev_macro_f1=0.5344, dev_err=26.04%
2026-02-28 21:13:50,890 - lg_cotrain - INFO - Phase 2 epoch 7/9: loss1=0.0098, loss2=0.0375, dev_macro_f1=0.5370, dev_err=25.92%
2026-02-28 21:14:54,783 - lg_cotrain - INFO - Phase 2 epoch 8/9: loss1=0.0083, loss2=0.0302, dev_macro_f1=0.5546, dev_err=25.55%
2026-02-28 21:16:00,415 - lg_cotrain - INFO - Phase 2 epoch 9/9: loss1=0.0088, loss2=0.0240, dev_macro_f1=0.5571, dev_err=26.04%
2026-02-28 21:16:00,415 - lg_cotrain - INFO - === Phase 3: Fine-Tuning ===
2026-02-28 21:16:03,102 - lg_cotrain - INFO - Phase 3 epoch 1: dev_macro_f1=0.5554, dev_err=26.78%, es_counter1=0, es_counter2=0
2026-02-28 21:16:05,794 - lg_cotrain - INFO - Phase 3 epoch 2: dev_macro_f1=0.5642, dev_err=27.03%, es_counter1=0, es_counter2=0
2026-02-28 21:16:08,492 - lg_cotrain - INFO - Phase 3 epoch 3: dev_macro_f1=0.6004, dev_err=27.64%, es_counter1=0, es_counter2=0
2026-02-28 21:16:11,186 - lg_cotrain - INFO - Phase 3 epoch 4: dev_macro_f1=0.6127, dev_err=28.26%, es_counter1=0, es_counter2=0
2026-02-28 21:16:13,885 - lg_cotrain - INFO - Phase 3 epoch 5: dev_macro_f1=0.6140, dev_err=28.62%, es_counter1=0, es_counter2=0
2026-02-28 21:16:16,585 - lg_cotrain - INFO - Phase 3 epoch 6: dev_macro_f1=0.6212, dev_err=29.24%, es_counter1=0, es_counter2=0
2026-02-28 21:16:19,267 - lg_cotrain - INFO - Phase 3 epoch 7: dev_macro_f1=0.6108, dev_err=30.22%, es_counter1=1, es_counter2=1
2026-02-28 21:16:21,945 - lg_cotrain - INFO - Phase 3 epoch 8: dev_macro_f1=0.5929, dev_err=31.33%, es_counter1=2, es_counter2=2
2026-02-28 21:16:24,622 - lg_cotrain - INFO - Phase 3 epoch 9: dev_macro_f1=0.5889, dev_err=31.70%, es_counter1=3, es_counter2=3
2026-02-28 21:16:27,303 - lg_cotrain - INFO - Phase 3 epoch 10: dev_macro_f1=0.5851, dev_err=32.56%, es_counter1=4, es_counter2=4
2026-02-28 21:16:29,990 - lg_cotrain - INFO - Phase 3 epoch 11: dev_macro_f1=0.5950, dev_err=32.92%, es_counter1=5, es_counter2=5
2026-02-28 21:16:32,678 - lg_cotrain - INFO - Phase 3 epoch 12: dev_macro_f1=0.5860, dev_err=33.78%, es_counter1=6, es_counter2=6
2026-02-28 21:16:35,366 - lg_cotrain - INFO - Phase 3 epoch 13: dev_macro_f1=0.5776, dev_err=34.40%, es_counter1=7, es_counter2=7
2026-02-28 21:16:38,053 - lg_cotrain - INFO - Phase 3 epoch 14: dev_macro_f1=0.5751, dev_err=34.89%, es_counter1=8, es_counter2=8
2026-02-28 21:16:40,747 - lg_cotrain - INFO - Phase 3 epoch 15: dev_macro_f1=0.5730, dev_err=35.14%, es_counter1=9, es_counter2=9
2026-02-28 21:16:40,748 - lg_cotrain - INFO - Early stopping at epoch 15
2026-02-28 21:16:40,762 - lg_cotrain - INFO - === Final Evaluation ===
2026-02-28 21:16:47,571 - lg_cotrain - INFO - Results saved to C:\Users\anhtr\AppData\Local\Temp\tmpxrlbrwp5\kerala_floods_2018\10_set2\metrics.json
2026-02-28 21:16:47,573 - lg_cotrain - INFO - Test error rate: 32.24%, Test macro-F1: 0.5487, Test ECE: 0.1955
2026-02-28 21:16:47,580 - lg_cotrain - INFO - --- Trial 1/10 done: dev_macro_f1=0.6212 ---
2026-02-28 21:16:47,580 - lg_cotrain - INFO - --- Trial 2/10 ---
2026-02-28 21:16:48,092 - lg_cotrain - INFO - Starting LG-CoTrain: event=kerala_floods_2018, budget=10, seed_set=2
2026-02-28 21:16:48,132 - lg_cotrain - INFO - Detected 9 classes for event kerala_floods_2018: ['caution_and_advice', 'displaced_people_and_evacuations', 'infrastructure_and_utility_damage', 'injured_or_dead_people', 'not_humanitarian', 'other_relevant_information', 'requests_or_urgent_needs', 'rescue_volunteering_or_donation_effort', 'sympathy_and_support']
2026-02-28 21:16:48,140 - lg_cotrain - INFO - D_l1: 45, D_l2: 45, D_LG: 5498
2026-02-28 21:16:48,141 - lg_cotrain - INFO - === Phase 1: Weight Generation ===
2026-02-28 21:17:07,070 - lg_cotrain - INFO - Phase 1 epoch 1/7: mean_prob1=0.0940, mean_prob2=0.1364
2026-02-28 21:17:25,050 - lg_cotrain - INFO - Phase 1 epoch 2/7: mean_prob1=0.1082, mean_prob2=0.0988
2026-02-28 21:17:42,667 - lg_cotrain - INFO - Phase 1 epoch 3/7: mean_prob1=0.0872, mean_prob2=0.0963
2026-02-28 21:18:00,388 - lg_cotrain - INFO - Phase 1 epoch 4/7: mean_prob1=0.1455, mean_prob2=0.1119
2026-02-28 21:18:18,090 - lg_cotrain - INFO - Phase 1 epoch 5/7: mean_prob1=0.1338, mean_prob2=0.1116
2026-02-28 21:18:35,746 - lg_cotrain - INFO - Phase 1 epoch 6/7: mean_prob1=0.1258, mean_prob2=0.1246
2026-02-28 21:18:53,582 - lg_cotrain - INFO - Phase 1 epoch 7/7: mean_prob1=0.1053, mean_prob2=0.1313
2026-02-28 21:18:53,582 - lg_cotrain - INFO - === Phase 2: Co-Training ===
2026-02-28 21:18:54,638 - lg_cotrain - INFO - LR scheduler: total_steps_1=1748, warmup=216; total_steps_2=1748, warmup=216
2026-02-28 21:18:54,639 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda1: mean=0.1053, range=[0.0496, 0.2331]
2026-02-28 21:18:54,639 - lg_cotrain - INFO - Phase 1 done -> seeded Phase 2 trackers. lambda2: mean=0.1313, range=[0.0184, 0.3041]
2026-02-28 21:20:03,469 - lg_cotrain - INFO - Phase 2 epoch 1/9: loss1=0.1439, loss2=0.1299, dev_macro_f1=0.4130, dev_err=34.52%
2026-02-28 21:21:11,999 - lg_cotrain - INFO - Phase 2 epoch 2/9: loss1=0.1415, loss2=0.5650, dev_macro_f1=0.0777, dev_err=46.19%
2026-02-28 21:22:21,116 - lg_cotrain - INFO - Phase 2 epoch 3/9: loss1=0.0637, loss2=0.5017, dev_macro_f1=0.0777, dev_err=46.19%
2026-02-28 21:23:30,110 - lg_cotrain - INFO - Phase 2 epoch 4/9: loss1=0.0283, loss2=0.4644, dev_macro_f1=0.0777, dev_err=46.19%
